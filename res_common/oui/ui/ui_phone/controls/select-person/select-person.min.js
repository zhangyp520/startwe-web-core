
!function(l1l11lll,I11l1llI){var l11II11l=400,I1lll1l11=null;I11l1llI.ORG_TYPE_ENUM={all:"all",person:"person",department:"department",company:"company",group:"group",level:"level",post:"post",role:"role",relativeRole:"relativeRole",orgTeam:"orgTeam",team:"team",contact:"contact"},I11l1llI.RANGE_TYPE={company:"company",currentDept:"currentDept"},I11l1llI.SP_SEARCH_TYP_EENUM={TEAM_PERSON:"team_person",ORG_PERSON:"org_person"};var I1I1IIIII=function(l1I11IIl){I11l1llI.$.ctrl.ouiformcontrol.call(this,l1I11IIl)};I11l1llI._selectPerson=function(I1I11II1,I11I1III){var l11II11I={includeChildType:1,filterSelf:!0,showType:0,isAll:!0,onlyRange:!1,rangeId:"company",allowCompany:!1,enableSelectNoGroup:!0,defaultTabIndex:1,tabs:"3,4,5,6,7,1,2",chooseType:null,fillback:[],isMulti:!0,maxSize:-1,isFlow:!1,extend:null,afterInit:I11l1llI._noop,beforeSelect:I11l1llI._noop,afterSelect:I11l1llI._noop,callbackOk:I11l1llI._noop,callbackCancel:I11l1llI._noop};l11II11I=l1l11lll.extend(!0,l11II11I,I1I11II1);var I1III1I1l=l11II11I.chooseType,I1l1llll1=[];switch(l11II11I.showType||0){case 0:I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.contact);break;case 1:I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.team);break;case 2:I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.contact),I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.team);break;case 3:I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.person),l11II11I.allowCompany=!1;break;case 4:I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.department),I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.relativeRole),I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.level),I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.post),I1l1llll1.push(I11l1llI.ORG_TYPE_ENUM.role),l11II11I.isAll=!1;break;case 5:break;case 6:I1l1llll1=[];var l1l1l111=[];I1III1I1l&&I1III1I1l.length>0&&(l1l1l111=I1III1I1l.split(","));for(var l1ll111ll=0,l1llllllI=l1l1l111.length;l1llllllI>l1ll111ll;l1ll111ll++){var l1II1I111=l1l1l111[l1ll111ll];"all"!==l1II1I111&&"company"!==l1II1I111&&"group"!==l1II1I111&&"orgTeam"!==l1II1I111&&I11l1llI.ORG_TYPE_ENUM[l1II1I111]&&I1l1llll1.push(l1II1I111)}if(!I1l1llll1||I1l1llll1.length<=0)return void I11l1llI.getTop().oui.alert("请传入选择类型")}if(l11II11I=l1l11lll.extend(!0,l11II11I,{chooseType:I1l1llll1}),l11II11I.showType&&l11II11I.showType>=3&&I11I1III)return I11l1llI.$.ctrl.dialog.SelectPersonDialog=new I1I1IIIII(l11II11I),I11lllll(l11II11I),I11l1llI.$.ctrl.dialog.SelectPersonDialog;l11II11I.isFlow=l11II11I.isFlow+""!="false",I1lll1l11||(I1lll1l11=I11l1llI.loadUrl(oui_url.selectPerson));var l11IIIIl=I11l1llI.showHTMLDialog4Div({content:I1lll1l11,isClose:!1});return l11IIIIl.attr("selectPersonOptions",l11II11I),l11IIIIl.attr(l11II11I),I11l1llI.$.ctrl.dialog.SelectPersonDialog=l11IIIIl,I11l1llI.SelectPerson.init(l11IIIIl.attr("selectPersonOptions")),l11IIIIl},I11l1llI.selectPerson=function(I1l11ll1){return I11l1llI._selectPerson(I1l11ll1,!1)},I11l1llI.selectPerson4Client=function(I1l11llI){return I11l1llI._selectPerson(I1l11llI,!0)},I11l1llI.selectPerson.TypeEnum={COMMON:0,FLOW:1};var I1l1l11l=function(l1l11llI,l11l1llI){I11l1llI.appType.qing||I11l1llI.appType.enterpriseKdweibo?(this.name=l1l11llI.name,this.id=l1l11llI.openId,this.typeFlag=I11l1llI.ORG_TYPE_ENUM.person):I11l1llI.appType.enterpriseWechat?(this.name=l1l11llI.name,this.id=l1l11llI.id,this.typeFlag=l11l1llI):I11l1llI.appType.dingtalk?(this.name=l1l11llI.name,this.id=l11l1llI==I11l1llI.ORG_TYPE_ENUM.person?l1l11llI.emplId:l1l11llI.id,this.typeFlag=l11l1llI):I11l1llI.appType.qyquan?(this.name=l1l11llI.name,this.id=l1l11llI.accNbr,this.typeFlag=I11l1llI.ORG_TYPE_ENUM.person):I11l1llI.appType.m3&&(this.name=l1l11llI.name,this.id=l1l11llI.id,this.typeFlag=I11l1llI.ORG_TYPE_ENUM.person)},I1ll111l1=function(I1l11lll,I11l1ll1){if(!I1l11lll)return[];var I11II11I,I1lll1l11,l1I1IIIII,l1l1l11I=I11l1llI.getCurrentClientContext(),l1II111II=[];if(l1l1l11I&&l1l1l11I.selectPersonConfig){var I1lllllll=l1l1l11I.selectPersonConfig;if(I1lllllll&&I1lllllll.selectPersonVo){for(I11II11I=0,I1lll1l11=I1l11lll.length;I1lll1l11>I11II11I;I11II11I++)l1I1IIIII=I1lllllll.selectPersonVo(I1l11lll[I11II11I],I11l1ll1),l1II111II.push(l1I1IIIII);return l1II111II}}for(I11II11I=0,I1lll1l11=I1l11lll.length;I1lll1l11>I11II11I;I11II11I++)l1I1IIIII=new I1l1l11l(I1l11lll[I11II11I],I11l1ll1),l1II111II.push(l1I1IIIII);return l1II111II};I11l1llI.appSpData2OuiVo=I1ll111l1;var I1IIIIII1=function(I1I11II1,l11l1lll,l11ll11l){if(I1I11II1&&I1I11II1.length>0){var l1lll1l1l={filterSelf:!!l11l1lll};I11l1llI.appType.qing?"云表单":"云积木";l1lll1l1l.users=I1I11II1,I11l1llI.postData(oui_url.selectPerson_userId2AccountId,l1lll1l1l,function(I1I11III){if(I1I11III=I11l1llI.parseJson(I1I11III),I1I11III.success){var I11I1II1=I1I11III.msg;I11I1II1=I11l1llI.parseJson(I11I1II1);var l11II11I=I11I1II1.notInsidePersonList;if(l11II11I.length>0){for(var l1lll1l1I=[],l1l1llllI=[],I1I1I111=null,l1ll111ll=0,l1IIIIIIl=l11II11I.length;l1IIIIIIl>l1ll111ll;l1ll111ll++)I1I1I111=l11II11I[l1ll111ll],I1I1I111.typeFlag===I11l1llI.ORG_TYPE_ENUM.person?l1lll1l1I.push(I1I1I111.name):l1l1llllI.push(I1I1I111.name);var I1ll1l111="";l1lll1l1I.length>0&&l1l1llllI.length>0?I1ll1l111="选择部门或人员未授权同步到当前应用的组织架构内，无法选择。":(l1lll1l1I.length>0&&(I1ll1l111=l1lll1l1I.join(",")+"未授权同步到当前应用的组织架构内，无法选择。"),l1l1llllI.length>0&&(I1ll1l111=l1l1llllI.join(",")+"部门未授权同步到当前应用的组织架构内，无法选择。")),I11l1llI.alert(I1ll1l111,function(){l11ll11l&&l11ll11l({data:I11I1II1.checkedVoList})})}else l11ll11l&&l11ll11l({data:I11I1II1.checkedVoList})}else I11l1llI.alert(I1I11III.msg)},function(l1l11lll){I11l1llI.alert(I11l1llI.parseString(l1l11lll))})}else l11ll11l&&l11ll11l({data:I1I11II1})},I1ll1l111=function(l1I11II1,I11I1IIl){if(l1I11II1&&l1I11II1.length>0){var l11II11l={};l11II11l.users=l1I11II1,I11l1llI.postData(oui_url.selectPerson_accountId2UserId,l11II11l,function(l1l11ll1){if(l1l11ll1=I11l1llI.parseJson(l1l11ll1),l1l11ll1.success){var I11l1ll1=l1l11ll1.msg;I11l1ll1=I11l1llI.parseJson(I11l1ll1),I11I1IIl&&I11I1IIl(I11l1ll1.checkedVoList)}else I11l1llI.alert(l1l11ll1.msg)},function(l1I11IIl){I11l1llI.alert(I11l1llI.parseString(l1I11IIl))})}else I11I1IIl&&I11I1IIl(l1I11II1)},I11lllll=function(I1I11IIl){var I11l1lll=I1I11IIl.maxSize,I11II111=I1I11IIl.filterSelf+""!="false",l1lll1l11=I1I11IIl.isMulti+""!="false";(l1lll1l11&&1>=I11l1lll||I11l1lll>l11II11l)&&(I11l1lll=l11II11l),l1lll1l11||(I11l1lll=1);var l1I1IIIIl=I1I11IIl.isAll+""=="true",l1l1l11l=I1I11IIl.allowCompany+""=="true",l1ll111l1=I1I11IIl.callbackOk;I1I11IIl.callbackOk=function(I1I11II1){I1I11II1=I1I11II1||{data:[]},I1I11IIl.isFlow&&(I1I11II1.flowType=1),l1ll111l1&&l1ll111l1(I1I11II1)};var l1lllllll=I1I11IIl.chooseType,I1ll1l11I=!0,I11lllll=!0;l1lllllll&&l1lllllll.length>0&&(l1lllllll.indexOf(I11l1llI.ORG_TYPE_ENUM.person)<0&&(I1ll1l11I=!1),l1lllllll.indexOf(I11l1llI.ORG_TYPE_ENUM.department)<0&&(I11lllll=!1));var I1II11III="";I1II11III=I1ll1l11I&&!I11lllll?"选择人员不能超过"+I11l1lll+"人":I11lllll&&!I1ll1l11I?"选择部门不能超过"+I11l1lll+"个":"选择部门和人员不能超过"+I11l1lll+"项";var I1IIII1I=I1I11IIl.fillback;I1ll1l111(I1IIII1I,function(l1I11III){var I11l1ll1=[],l11ll11I=[];try{if(l1I11III&&l1I11III.length>0)for(var l1III1I11=null,I1l1lllll=0,I1I1I111=l1I11III.length;I1I1I111>I1l1lllll;I1l1lllll++){l1III1I11=l1I11III[I1l1lllll];var I1ll111lI=l1III1I11.id.split("_"),l1lllllll=I1ll111lI[I1ll111lI.length-1];l1III1I11.typeFlag==I11l1llI.ORG_TYPE_ENUM.person?l11ll11I.push(l1lllllll):l1III1I11.typeFlag==I11l1llI.ORG_TYPE_ENUM.department?I11l1ll1.push(l1lllllll):(l1III1I11.typeFlag==I11l1llI.ORG_TYPE_ENUM.company||l1III1I11.typeFlag==I11l1llI.ORG_TYPE_ENUM.all)&&I11l1ll1.push(l1lllllll)}}catch(l1ll1l11I){I11l1llI.alert("回调数据出错"+I11l1llI.parseString(l1ll1l11I))}var I11llll1=I11l1llI.getCurrentClientContext();if(I11llll1&&I11llll1.selectPersonConfig){var I1II11IIl=I11llll1.selectPersonConfig;I1II11IIl&&I1II11IIl.callSelectFunc(I1I11IIl,{canSelectUser:I1ll1l11I,canSelectDep:I11lllll,isMulti:l1lll1l11,maxSize:I11l1lll,maxSizeErrorTip:I1II11III,selectedDepIds:I11l1ll1,selectedUserIds:l11ll11I,isAll:l1I1IIIIl,allowCompany:l1l1l11l},function(l1I11IIl){I1IIIIII1(l1I11IIl,I11II111,I1I11IIl.callbackOk)})}})}}(jQuery,oui),function(I1I11III){var I11l1ll1=oui.$.ctrl,l11ll11l=I11l1ll1.ouiformcontrol,I1lll1l1l="includeChildType,enableSelectNoGroup,tabs,chooseType,defaultTabIndex,maxSize,isMulti,isAll,allowCompany",I1l1llll1=function(l1l11ll1){l11ll11l.call(this,l1l11ll1),this.attrs=this.attrs+",otherAttrs,fillback,filterSelf,tabs,chooseType,isMulti,extend,isAll,allowCompany",this.init=l1I1I11I,this.showSelectPerson=l1ll111ll,this.getData4DB=l11IIIII,this.getDisplay4readOnly=I1ll1l11I,this.setValue=I1llllllI};I11l1ll1.selectperson=I1l1llll1,I1l1llll1.FullName="oui.$.ctrl.selectperson",I1l1llll1.templateHtml=[],I1l1llll1.templateHtml[0]='<input type="hidden" validate="{{validate}}" targetHighBorderEl="oui.getNS().$(\'#oui_selectperson_{{id}}\')" id="{{id}}" name="{{name}}" value="{{value}}" />        <div id="oui_selectperson_{{id}}" class="{{isMulti ? \'multi-\':\'\'}}personarea" onclick="oui.getByOuiId({{ouiId}}).showSelectPerson(this);">{{oui.getByOuiId(ouiId).getDisplay4readOnly();}}</div>        <i class="right-arrow"></i>        ',I1l1llll1.templateHtml[1]=I1l1llll1.templateHtml[0],I1l1llll1.templateHtml[2]=I1l1llll1.templateHtml[0],I1l1llll1.templateHtml[3]=I1l1llll1.templateHtml[0],I1l1llll1.templateHtml[4]=I1l1llll1.templateHtml[0],I1l1llll1.templateHtml[5]=I1l1llll1.templateHtml[0],I1l1llll1.templateHtml[6]=I1l1llll1.templateHtml[0],I1l1llll1.templateHtml4readOnly=[],I1l1llll1.templateHtml4readOnly[0]="{{oui.getByOuiId(ouiId).getDisplay4readOnly();}}",I1l1llll1.templateHtml4readOnly[1]=I1l1llll1.templateHtml4readOnly[0],I1l1llll1.templateHtml4readOnly[2]=I1l1llll1.templateHtml4readOnly[0],I1l1llll1.templateHtml4readOnly[3]=I1l1llll1.templateHtml4readOnly[0],I1l1llll1.templateHtml4readOnly[4]=I1l1llll1.templateHtml4readOnly[0],I1l1llll1.templateHtml4readOnly[5]=I1l1llll1.templateHtml4readOnly[0],I1l1llll1.templateHtml4readOnly[6]=I1l1llll1.templateHtml4readOnly[0],l11ll11l.buildTemplate(I1l1llll1,"edit4ReadOnly,edit4View","0,1,2,3,4,5,6",I1l1llll1.templateHtml4readOnly[0]);var l1I1I11I=function(){var I1l11ll1=this.attr("data");I1l11ll1||(I1l11ll1="[]"),I1l11ll1=oui.parseJson(I1l11ll1),this.attr("data",I1l11ll1);var I11I1II1=this.attr("value");if(I11I1II1){var I11ll111=this.attr("data4DB");I11ll111=oui.parseJson(I11ll111||"{}"),"object"==typeof I11ll111&&(I11ll111=I11ll111.items),I11ll111||(I11ll111=[]),I11ll111&&I11ll111.length>0&&this.attr("data",I11ll111)}var I1III1I1I=this.attr("fillback");(void 0===I1III1I1I||"undefined"===I1III1I1I||""===I1III1I1I)&&this.attr("fillback",!0);var l1l1lllll=oui.parseJson(this.attr("otherAttrs")||"{}"),l1I1I11l=this.attr("isMulti");"undefined"!=typeof l1I1I11l&&(l1I1I11l+"").length>0?this.attr("isMulti",l1I1I11l+""=="true"):this.attr("isMulti",l1l1lllll.isMulti+""=="true"),this.attr("isAll",l1l1lllll.isAll+""=="true"),this.attr("allowCompany",l1l1lllll.allowCompany+""=="true")},l1ll111ll=function(l1I11IIl){var I11l1llI=this,I11II11l=parseInt(this.attr("showType")||0),I1III1I1l=(this.attr("value"),oui.parseJson(this.attr("data")||"[]")),I1l1llllI=this.attr("fillback"),I1I1I11l=this.attr("filterSelf"),I1II111I1=this.attr("tabs")||"",l1IIIIII1=this.attr("extend")||"{}",l1II1I111=this.attr("otherAttrs")||"{}",I11llll1=(this.attr("chooseType"),I11l1llI.attr("right"));if("preview"===I11llll1)return!1;I1l1llllI=("true"===I1l1llllI||"fillback"===I1l1llllI||I1l1llllI===!0)&&I1III1I1l.length>0?I1III1I1l:[];for(var l1ll11llI=I1lll1l1l.split(","),l1llll11={},I1ll1l1l1=0,l1l1111ll=l1ll11llI.length;l1l1111ll>I1ll1l1l1;I1ll1l1l1++)"undefined"!=typeof this.attr(l1ll11llI[I1ll1l1l1])&&(this.attr(l1ll11llI[I1ll1l1l1])+"").length>0&&(l1llll11[l1ll11llI[I1ll1l1l1]]=this.attr(l1ll11llI[I1ll1l1l1]));l1II1I111=oui.parseJson(l1II1I111);for(var l1I1I11II in l1II1I111)"undefined"!=typeof l1II1I111[l1I1I11II]&&(l1II1I111[l1I1I11II]+"").length>0&&(l1llll11[l1I1I11II]=l1II1I111[l1I1I11II]);var l1llll1l1={};I1II111I1.length>0&&(l1llll1l1.tabs=I1II111I1),l1IIIIII1&&(l1llll1l1.extend=oui.parseJson(l1IIIIII1)),I1I1I11l.length>0&&(l1llll1l1.filterSelf=I1I1I11l),I11II11l+""=="3"?l1llll11.isAll=!1:I11II11l+""=="4"&&(l1llll11.allowCompany=!1);var I1I11II1I=l1II1I111.rangeType;if("company"===I1I11II1I)l1llll11.onlyRange=!1,l1llll11.rangeId=oui.RANGE_TYPE.currentDept;else if("currentDept"===I1I11II1I)l1llll11.onlyRange=!0,l1llll11.rangeId=oui.RANGE_TYPE.currentDept;else if("formControl"===I1I11II1I){l1llll11.onlyRange=!0;var I1lll1lI="",l11ll1ll=!1,l1l1lll1l=null,l1II1II11=null,l1III1111=oui.getById(l1II1I111.rangeId);if(l1III1111){if(I1lll1lI=l1III1111.getValue()){l1l1lll1l=l1III1111.getData4DB();try{l1II1II11=l1l1lll1l.items[0]}catch(l1III11I1){}l1II1II11&&l1II1II11.typeFlag!==oui.ORG_TYPE_ENUM.company&&(l11ll1ll=!0,l1llll11.rangeId=l1III1111.getValue())}}else{var l1lll1lll=I11l1llI.attr("tableOuiId"),I11I1I1I=oui.getByOuiId(l1lll1lll),I1I11I11l=$(I11l1llI.getEl()).closest(".oui-table-grid-row");if(I11I1I1I&&I1I11I11l.length>0){var I1l1111I=I1I11I11l.index(),l11lll11=I1l1111I-1,l1lllll1=I11I1I1I.attr("data"),I1l11llll=l1lllll1[l11lll11];if(I1l11llll[l1II1I111.rangeId]&&(l1III1111=oui.getByOuiId(I1l11llll[l1II1I111.rangeId].controlOuiId),l1III1111&&(I1lll1lI=l1III1111.getValue()))){l1l1lll1l=l1III1111.getData4DB();try{l1II1II11=l1l1lll1l.items[0]}catch(l1III11I1){}l1II1II11&&l1II1II11.typeFlag!==oui.ORG_TYPE_ENUM.company&&(l11ll1ll=!0,l1llll11.rangeId=l1III1111.getValue())}}}l11ll1ll||(l1llll11.onlyRange=!1,l1llll11.rangeId=oui.RANGE_TYPE.currentDept)}else"fixedDept"===I1I11II1I?(l1llll11.onlyRange=!0,l1llll11.rangeId=l1II1I111.rangeId):(l1llll11.onlyRange=!1,l1llll11.rangeId=oui.RANGE_TYPE.currentDept);return this.attr("isMulti")+""=="true"&&(l1llll11.maxSize=50),oui.selectPerson($.extend(!0,{showType:I11II11l,fillback:I1l1llllI,callbackOk:function(l1I11IIl){var l11I1IIl=l1I11IIl.data,l11ll111=[];if(l11I1IIl&&l11I1IIl.length>0)for(var l1lll1l1l=0,l1I1IIIIl=l11I1IIl.length;l1I1IIIIl>l1lll1l1l;l1lll1l1l++)l11ll111.push(l11I1IIl[l1lll1l1l].id);I11l1llI.attr("value",l11ll111.join(",")),I11l1llI.attr("data",l11I1IIl),I11l1llI.render(),I11l1llI.triggerUpdate(),I11l1llI.triggerAfterUpdate(),oui.validate($(I11l1llI.getEl()).find("#"+I11l1llI.attr("id"))[0])}},l1llll1l1,l1llll11)),!1},I1llllllI=function(I1I11II1){this.attr("value",I1I11II1),I1I11II1||this.attr("data","[]"),this.render(),this.triggerAfterUpdate()},I1ll1l11I=function(){var l1l11llI=this.attr("data");l1l11llI=oui.parseJson(l1l11llI);for(var l11l1llI=[],l11II11I=this.attr("value"),I1lll1l1I=0,l1I1IIII1=l1l11llI.length;l1I1IIII1>I1lll1l1I;I1lll1l1I++)l11II11I.indexOf(l1l11llI[I1lll1l1I].id)>-1&&l11l1llI.push(oui.escapeStringToHTML(l1l11llI[I1lll1l1I].name));return l11l1llI.join(",")},l11IIIII=function(){var I1I11III=l11ll11l.getProtoType().getData4DB.call(this),l11I1II1=this.attr("data"),I11II111=this.attr("value");l11I1II1=oui.parseJson(l11I1II1||"[]");for(var I1III1I11=[],I1l1lllll=0,I1I1I111=l11I1II1.length;I1I1I111>I1l1lllll;I1l1lllll++)I11II111.indexOf(l11I1II1[I1l1lllll].id)>-1&&I1III1I11.push(l11I1II1[I1l1lllll]);return I1I11III.items=I1III1I11,I1I11III}}(window),function(I1l11ll1,l11I1III,l11II11I){var I1lll1l1l={relRole_sender:"发起人",relRole_sender4Dep:"发起人部门成员",relRole_sender4DepMgr:"发起人部门主管",relRole_sender4DepMgr4Pre:"发起人上级部门部门主管",relRole_preNode4Dep:"上节点部门成员",relRole_preNode4DepMgr:"上节点部门主管",relRole_preNode4DepMgr4Pre:"上节点上级部门部门主管"},l1I1IIIII={getPerson:oui_url.selectPerson_getPerson,searchByName:oui_url.selectPerson_searchByName,getOrg:oui_url.selectPerson_getOrg,getCustomRole:oui_url.selectPerson_getCustomRole,userId2AccountId:oui_url.selectPerson_userId2AccountId,accountId2UserId:oui_url.selectPerson_accountId2UserId},l1l1l111=function(l11I1III,l11II11l){var l1lll1l11=l1I1IIIII[l11I1III];return l11II11l&&(l11II11l=I1l11ll1.param(l11II11l),l1lll1l11+="&"+l11II11l),l1lll1l11},l1ll111ll={};l1ll111ll.userId2AccountId=function(I1I11IIl,l11I1IIl,I11ll111){if(I1I11IIl&&I1I11IIl.length>0){var l1III1I1l={filterSelf:l11I1IIl+""!="false"};"all"===I1I11IIl?l1III1I1l.type="all":l1III1I1l.users=I1I11IIl;var l1I1IIIIl=l11II11I.appType.qing?"云表单":"云积木";l11II11I.postData(l1l1l111("userId2AccountId"),l1III1I1l,function(l1l11lll){if(l1l11lll=l11II11I.parseJson(l1l11lll),l1l11lll.success){var l11l1ll1=l1l11lll.msg;l11l1ll1=l11II11I.parseJson(l11l1ll1);var l11ll111=l11l1ll1.notInsidePersonList;if(l11ll111.length>0){for(var I1III1I1I="",I1I1IIIIl=0,l1l1l111=l11ll111.length;l1l1l111>I1I1IIIIl;I1I1IIIIl++)I1III1I1I+=l11ll111[I1I1IIIIl].name+",";I1III1I1I=I1III1I1I.substring(0,I1III1I1I.length-1),l11II11I.alert(I1III1I1I+"还没有注册"+l1I1IIIIl+"哦！",function(){I11ll111&&I11ll111({data:l11l1ll1.checkedVoList})})}else I11ll111&&I11ll111({data:l11l1ll1.checkedVoList})}else l11II11I.alert(l1l11lll.msg)},function(I1l11llI){l11II11I.alert(l11II11I.parseString(I1l11llI))})}else I11ll111&&I11ll111({data:I1I11IIl})},l1ll111ll.accountId2userId=function(l1I11IIl,l11l1llI){if(l1I11IIl&&l1I11IIl.length>0){var I11ll11l={};I11ll11l.users=l1I11IIl,l11II11I.postData(l1l1l111("accountId2UserId"),I11ll11l,function(l1I11II1){if(l1I11II1=l11II11I.parseJson(l1I11II1),l1I11II1.success){var I11l1llI=l1I11II1.msg;I11l1llI=l11II11I.parseJson(I11l1llI),l11l1llI&&l11l1llI(I11l1llI.checkedVoList)}else l11II11I.alert(l1I11II1.msg)},function(l1I11II1){l11II11I.alert(l11II11I.parseString(l1I11II1))})}else l11l1llI&&l11l1llI(l1I11IIl)},l1ll111ll.getPersonByOrgObj=function(I1I11IIl,l11l1llI,l11ll111){var I1III1I1l=window.isFromCache||!1;I1I11IIl=l11II11I.parseJson(I1I11IIl);var l1l1llllI={};I1I11IIl&&(l1l1llllI={type:I1I11IIl.typeFlag,id:I1I11IIl.id,otherParam:I1I11IIl.typeFlag+I1I11IIl.id}),I1l11ll1.extend(!0,l1l1llllI,l11ll111),I1III1I1l&&l1ll111ll.personMap&&l1ll111ll.personMap[I1I11IIl.id+"_"+I1I11IIl.typeFlag]?l11l1llI&&l11l1llI(l1ll111ll.personMap[I1I11IIl.id+"_"+I1I11IIl.typeFlag]):l11II11I.getData(l1l1l111("getPerson",l1l1llllI),{},function(I1l11llI){if(I1l11llI.success){var I11l1llI=I1l11llI.msg;I11l1llI=l11II11I.parseJson(I11l1llI);for(var I11ll11I=null,I1III1I11=null,I1I1IIIIl=null,l1l1l11l=0,l1llllllI=I11l1llI.length;l1llllllI>l1l1l11l;l1l1l11l++)I1I1IIIIl=I11l1llI[l1l1l11l].post,I11ll11I=I11l1llI[l1l1l11l].name,I1III1I11=I11l1llI[l1l1l11l].name,I1I1IIIIl&&I1I1IIIIl.length>0&&(I1III1I11=I11ll11I+"（"+I1I1IIIIl+"）"),I11l1llI[l1l1l11l]._name=I11ll11I,I11l1llI[l1l1l11l].name=I1III1I11;I1III1I1l&&(l1ll111ll.personMap||(l1ll111ll.personMap={}),l1ll111ll.personMap[I1I11IIl.id+"_"+I1I11IIl.typeFlag]=I11l1llI),l11l1llI&&l11l1llI(I11l1llI)}else l11II11I.alert("获取联系人数据失败")})},l1ll111ll.clearCache=function(){l1ll111ll.firstDepartMent=null,l1ll111ll.allDepartments=null,l1ll111ll.departmentMap=null,l1ll111ll.personMap=null},l1ll111ll.getOrg=function(l1I11IIl,I11I1III,l11II11l,l1III1I1l,l1I1IIIII){if(l1I11IIl){var l1l1l11l={type:l1I11IIl};l1l1l11l.otherParam=l1I11IIl,I11I1III&&(l1l1l11l.id=I11I1III,l1l1l11l.otherParam=l1I11IIl+I11I1III),I1l11ll1.extend(!0,l1l1l11l,l1III1I1l),l1I11IIl===l11II11I.ORG_TYPE_ENUM.company||l1I11IIl===l11II11I.ORG_TYPE_ENUM.department?l1ll111ll.departmentMap?l1I11IIl===l11II11I.ORG_TYPE_ENUM.company||l1I1IIIII?l11II11l&&l11II11l(l1ll111ll.firstDepartMent):l1I11IIl===l11II11I.ORG_TYPE_ENUM.department&&(l1ll111ll.departmentMap[l1l1l11l.id].children?l11II11l&&l11II11l(l1ll111ll.departmentMap[l1l1l11l.id].children):l11II11l&&l11II11l([])):l11II11I.getData(l1l1l111("getOrg",l1l1l11l),{},function(I1l11llI){if(I1l11llI.success){var I11I1II1=I1l11llI.msg;I11I1II1=l11II11I.parseJson(I11I1II1);var I1lll1l1l,l1I1IIIIl,I1l1l111=[],I1II111Il={};for(I1lll1l1l=0,l1I1IIIIl=I11I1II1.length;l1I1IIIIl>I1lll1l1l;I1lll1l1l++)I1II111Il[I11I1II1[I1lll1l1l].id]=I11I1II1[I1lll1l1l];for(I1lll1l1l=0,l1I1IIIIl=I11I1II1.length;l1I1IIIIl>I1lll1l1l;I1lll1l1l++)I1II111Il[I11I1II1[I1lll1l1l].parentId]&&I11I1II1[I1lll1l1l].id!==I11I1II1[I1lll1l1l].parentId?(I1II111Il[I11I1II1[I1lll1l1l].parentId].children||(I1II111Il[I11I1II1[I1lll1l1l].parentId].children=[]),I1II111Il[I11I1II1[I1lll1l1l].parentId].children.push(I11I1II1[I1lll1l1l])):I1l1l111.push(I11I1II1[I1lll1l1l]);var I1llllll1=[];for(I1lll1l1l=0,l1I1IIIIl=I1l1l111.length;l1I1IIIIl>I1lll1l1l;I1lll1l1l++)I1llllll1.push(I1l11ll1.extend(!0,{},I1l1l111[I1lll1l1l],{children:I1l1l111[I1lll1l1l].children&&I1l1l111[I1lll1l1l].children.length}));l1ll111ll.firstDepartMent=I1llllll1,l1ll111ll.allDepartments=I11I1II1,l1ll111ll.departmentMap=I1II111Il,l11II11l&&l11II11l(I1llllll1)}else l11II11l&&l11II11l([]),console.log(I1l11llI)}):l1ll111ll[l1I11IIl+"Map"]?l1I1IIIII?l11II11l&&l11II11l(l1ll111ll["first"+l1I11IIl]):l1ll111ll[l1I11IIl+"Map"][l1l1l11l.id].children?l11II11l&&l11II11l(l1ll111ll[l1I11IIl+"Map"][l1l1l11l.id].children):l11II11l&&l11II11l([]):l11II11I.getData(l1l1l111("getOrg",l1l1l11l),{},function(I1I11II1){if(I1I11II1.success){var I11I1III=I1I11II1.msg;I11I1III=l11II11I.parseJson(I11I1III);var l1III1I1I,l1l1llll1,I1l1l11I=[],I1IIIIIII={};for(l1III1I1I=0,l1l1llll1=I11I1III.length;l1l1llll1>l1III1I1I;l1III1I1I++)I1IIIIIII[I11I1III[l1III1I1I].id]=I11I1III[l1III1I1I];for(l1III1I1I=0,l1l1llll1=I11I1III.length;l1l1llll1>l1III1I1I;l1III1I1I++)I1IIIIIII[I11I1III[l1III1I1I].parentId]&&I11I1III[l1III1I1I].id!==I11I1III[l1III1I1I].parentId?(I1IIIIIII[I11I1III[l1III1I1I].parentId].children||(I1IIIIIII[I11I1III[l1III1I1I].parentId].children=[]),I1IIIIIII[I11I1III[l1III1I1I].parentId].children.push(I11I1III[l1III1I1I])):I1l1l11I.push(I11I1III[l1III1I1I]);var l1ll1l11l=[];for(l1III1I1I=0,l1l1llll1=I1l1l11I.length;l1l1llll1>l1III1I1I;l1III1I1I++)l1ll1l11l.push(I1l11ll1.extend(!0,{},I1l1l11I[l1III1I1I],{children:I1l1l11I[l1III1I1I].children&&I1l1l11I[l1III1I1I].children.length}));l1ll111ll["first"+l1I11IIl]=l1ll1l11l,l1ll111ll["all"+l1I11IIl]=I11I1III,l1ll111ll[l1I11IIl+"Map"]=I1IIIIIII,l11II11l&&l11II11l(l1ll1l11l)}else l11II11l&&l11II11l([]),console.log(I1I11II1)})}},l1ll111ll.getChildDepartmentByOrg=function(l1l11llI){return l1l11llI.typeFlag===l11II11I.ORG_TYPE_ENUM.department&&l1ll111ll.departmentMap&&l1ll111ll.departmentMap[l1l11llI.id].children?l1ll111ll.departmentMap[l1l11llI.id].children:[]},l1ll111ll.getChildByOrg=function(l1l11llI){return l1ll111ll[l1l11llI.typeFlag+"Map"]&&l1ll111ll[l1l11llI.typeFlag+"Map"][l1l11llI.id].children?l1ll111ll[l1l11llI.typeFlag+"Map"][l1l11llI.id].children:[]},l1ll111ll.getChildOrgByOrg=function(I1l11llI,l11l1llI,I11ll111){(I1l11llI.typeFlag===l11II11I.ORG_TYPE_ENUM.department||I1l11llI.typeFlag===l11II11I.ORG_TYPE_ENUM.company)&&l1ll111ll.getOrg(l11II11I.ORG_TYPE_ENUM.department,I1l11llI.id,function(I1l11lll){for(var I11ll11l=[],I1lll1l1l=0,I1l1llllI=I1l11lll.length;I1l1llllI>I1lll1l1l;I1lll1l1l++)I11ll11l.push(I1l11ll1.extend(!0,{},I1l11lll[I1lll1l1l],{children:I1l11lll[I1lll1l1l].children&&I1l11lll[I1lll1l1l].children.length}));I11ll111?l11l1llI&&l11l1llI(I11ll11l):l1ll111ll.getPersonByOrgObj(I1l11llI,function(l1l11llI){var l11I1IIl=[].concat(I11ll11l);l11I1IIl=l11I1IIl.concat(l1l11llI),l11l1llI&&l11l1llI(l11I1IIl)})})},l1ll111ll.getParentsById=function(l1l11lll,I11l1ll1){var l11ll111=l1ll111ll.departmentMap;if(l11ll111){var l1lll1l11=l11ll111[l1l11lll];l1lll1l11&&(I11l1ll1.push(l1lll1l11),l1lll1l11.parentId!==l1lll1l11.id&&l1ll111ll.getParentsById(l1lll1l11.parentId,I11l1ll1))}return I11l1ll1},l1ll111ll.getRelativeRoles=function(I1I11II1){var l11l1ll1=[];for(var l11ll111 in I1lll1l1l)I1lll1l1l.hasOwnProperty(l11ll111)&&l11l1ll1.push({id:l11ll111,name:I1lll1l1l[l11ll111],typeFlag:l11II11I.ORG_TYPE_ENUM.relativeRole});I1I11II1&&I1I11II1(l11l1ll1)},l1ll111ll.searchByName4Org=function(I1I11III,I11l1lll,I11ll11l,I1III1I1I){if(I11l1lll.length<=0)return void l11II11I.alert("请输入搜索内容");if(I1I11III){var l1l1llll1={type:I1I11III?I1I11III:"",name:I11l1lll,deptId:I11ll11l||""};l1l1llll1.otherParam=l1l1llll1.type+l1l1llll1.name+l1l1llll1.deptId,l11II11I.getData(l1l1l111("searchByName",l1l1llll1),{},function(l1I11IIl){if(l1I11IIl.success){var I11I1III=l1I11IIl.msg;I11I1III=l11II11I.parseJson(I11I1III),I1III1I1I&&I1III1I1I(I11I1III)}else console.log(l1I11IIl)})}},l1ll111ll.search4Extend=function(I1I11II1,I11I1III,l1III1I1l){if(I11I1III.length<=0)return void l11II11I.alert("请输入搜索内容");if(I1I11II1){var l1l1llllI,l1I1I11l,l1ll111lI=[],I1IIIIII1=null;if(l1ll111ll[I1I11II1]){var I1ll1l11l=l1ll111ll[I1I11II1];if(I11I1III&&I11I1III.length>0)for(l1l1llllI=0,l1I1I11l=I1ll1l11l.length;l1I1I11l>l1l1llllI;l1l1llllI++)I1IIIIII1=I1ll1l11l[l1l1llllI],I1IIIIII1.name.indexOf(I11I1III)>-1&&l1ll111lI.push(I1IIIIII1);else l1ll111lI=I1ll1l11l;l1III1I1l&&l1III1I1l(l1ll111lI)}}},l1ll111ll.getDataByExtendTab=function(I1l11llI,l11l1lll){I1l11llI.url&&"string"==typeof I1l11llI.url?l11II11I.getData(I1l11llI.url,{},function(I1I11IIl){if(I1I11IIl.success){var I11I1II1=I1I11IIl.msg;I11I1II1=l11II11I.parseJson(I11I1II1),l1ll111ll[I1l11llI.type]=I11I1II1,l11l1lll&&l11l1lll(I11I1II1)}else l11l1lll&&l11l1lll([])}):I1l11llI.data?(l1ll111ll[I1l11llI.type]=I1l11llI.data,l11l1lll&&l11l1lll(I1l11llI.data)):l11l1lll&&l11l1lll([])},l11II11I.SelectPersonBiz=l1ll111ll}(jQuery,document,oui),function(l1I11III,I11I1II1,l11II11l){var I1lll1l11={renders:{}},I1l1lllll=[];I1l1lllll.spTabsTpl='{{each data as tab index}}            <div>                <label class="selectcheckbox">                    {{if tab.enableCheck }}                            <div class="selectperson-checkbox">                                <input type="checkbox">                                <i class="selected-icon"></i>                            </div>                    {{/if}}                </label>                <div class="selectInfo" link="#/{{=tab.key}}/" key="{{=tab.key}}">                    <span class="selectportrait {{=tab.icon}}-icon">&nbsp;</span>                    <span class="selectFlex">{{tab.name }}</span>                    <i class="select-user-info"></i>                </div>            </div>        {{/each}}',I1l1lllll.spSelectTpl='{{if data.length > 0}}            {{each data as item index}}                {{if item.typeFlag != "person" && item.typeFlag != "contact" && item.typeFlag != "relativeRole" && oui.ORG_TYPE_ENUM[item.typeFlag]}}                    <div>                        <label class="selectcheckbox" for="sp_{{item.id}}">                            {{if selectPerson.checkSelectType(item)}}                                {{if item.level == 0 }}                                <div class="selectperson-checkbox" itemId="{{item.id}}" id="allSelectedCheckbox">                                    <input id="sp_{{item.id}}" onchange="oui.SelectPerson.checkChange(this,{{oui.parseString(item)}})" type="checkbox" {{if selectPerson.isSelected(item)}}checked="checked"{{/if}} >                                    <i class="selected-icon"></i>                                </div>                                {{else}}                                <div class="selectperson-checkbox">                                    <input id="sp_{{item.id}}" onchange="oui.SelectPerson.checkChange(this,{{oui.parseString(item)}})" type="checkbox" {{if selectPerson.isSelected(item)}}checked="checked"{{/if}} >                                    <i class="selected-icon"></i>                                </div>                                {{/if}}                            {{/if}}                        </label>                        {{if item.typeFlag == "department" || item.typeFlag == "company"}}                            <div toView="spR" class="selectInfo" spData=\'{{oui.parseString(item)}}\' link="#/department/spData/" >                                <span class="selectportrait depart-icon">&nbsp;</span>                                <span class="selectFlex">{{item.name}}</span>                                <i class="select-user-info"></i>                            </div>                        {{else}}                            <div toView="spR" class="selectInfo" spData=\'{{oui.parseString(item)}}\' link="{{if item.typeFlag=="team"}}#/team/spData/{{else}}#/child/spData{{/if}}" >                                {{if item.typeFlag=="team"}}                                <span class="selectportrait team-icon">&nbsp;</span>                                {{else}}                                <span class="selectportrait userIcon-bgColor-{{oui.SelectPerson.getIconBgNum(item)}}">{{item.name.substring(0,1)}}</span>                                {{/if}}                                <span class="selectFlex">{{item.name}}</span>                                <i class="select-user-info"></i>                            </div>                        {{/if}}                    </div>                {{else}}                    <div>                        <label class="selectcheckbox" for="sp_{{item.id}}">                            {{if selectPerson.checkSelectType(item)}}                                <div class="selectperson-checkbox">                                    <input id="sp_{{item.id}}" onchange="oui.SelectPerson.checkChange(this,{{oui.parseString(item)}})" type="checkbox" {{if selectPerson.isSelected(item)}}checked="checked"{{/if}} >                                    <i class="selected-icon"></i>                                </div>                            {{/if}}                        </label>                        <div toView="spR" class="selectInfo" spData=\'{{oui.parseString(item)}}\' {{if selectPerson.checkSelectType(item)}}onclick="oui.SelectPerson.optionChange(this,\'{{item.typeFlag}}\')"{{/if}}>                            {{if item.typeFlag == "relativeRole"}}                            <span class="selectportrait userIcon-bgColor-{{oui.SelectPerson.getIconBgNum(item)}}">{{item.name.substring(0,1)}}</span>                            {{else}}                            <span class="selectportrait userIcon-bgColor-{{oui.SelectPerson.getIconBgNum(item)}}">{{item.name.substring(0,1)}}</span>                            {{/if}}                            <span class="selectFlex">{{item.name}}</span>                        </div>                    </div>                {{/if}}            {{/each}}        {{else}}            <span class="no_sp_data"><i>暂无信息</i></span>        {{/if}}',I1l1lllll.spLFTpl=I1l1lllll.spLT4ContactTpl=I1l1lllll.spSelectTpl,I1l1lllll.spSelectedTpl='{{each data as item index}}            <li id="sp_selected_{{item.id}}" onclick="oui.SelectPerson.removeItem({{oui.parseString(item)}})">                {{if item.typeFlag=="team"}}                    <span class="userimg team-icon">&nbsp;</span>                {{else if item.typeFlag=="department"}}                    <span class="userimg depart-icon">&nbsp;</span>                {{else if item.typeFlag=="relativeRole"}}                    <span class="userimg userIcon-bgColor-{{oui.SelectPerson.getIconBgNum(item)}}">{{item.name.substring(0,1)}}</span>                {{else}}                    <span class="userimg userIcon-bgColor-{{oui.SelectPerson.getIconBgNum(item)}}">{{item.name.substring(0,1)}}</span>                {{/if}}                <span class="username">{{item.name}}</span>            </li>        {{/each}}',I1l1lllll.spNavigationTpl='{{each data as item index}}        {{if index != (data.length-1) || data.length == 1}}        <span link="{{item.linkTo}}" spData="{{oui.parseString(item.spData)}}"><i>{{item.name}}</i></span>{{if data.length != 1}}&gt;{{/if}}        {{else}}        <span>{{item.name}}</span>        {{/if}}        {{/each}}        ',I1l1lllll.spOptionTpl='{{if data.isFlow || data.isFlow=="true" || data.isFlow == true}}            <div>                <button onclick="oui.SelectPerson.click2Ok(0);">并发</button>            </div>            <div>                <button onclick="oui.SelectPerson.click2Ok(1);">串发</button>            </div>        {{else}}            <div>                <button onclick="oui.SelectPerson.click2Ok();">确认</button>            </div>        {{/if}}',I1l1lllll.spSearchSelectTpl='{{if data && data.length > 0}}{{each data as item index}}             <div>                <label class="selectcheckbox" for="sp_s_{{item.id}}">                    <div class="selectperson-checkbox">                        <input id="sp_s_{{item.id}}" sp_search="true" onchange="oui.SelectPerson.checkChange(this,{{oui.parseString(item)}})" type="checkbox" {{if selectPerson.isSelected(item)}}checked="checked"{{/if}} >                        <i class="selected-icon"></i>                    </div>                </label>                <div toView="spR" class="selectInfo" spData=\'{{oui.parseString(item)}}\' onclick="oui.SelectPerson.optionChange(this,\'{{item.typeFlag}}\')" >                    <span class="selectportrait userIcon-bgColor-{{oui.SelectPerson.getIconBgNum(item)}}">{{item.name.substring(0,1)}}</span>                    <span class="selectFlex">{{item.name}}</span>                </div>            </div>        {{/each}}        {{else}}        <span class="no_sp_data"><i>暂无信息</i></span>        {{/if}}        ',
I1l1lllll.spSearchHistoryTpl='<div class="search-history">搜索记录</div>'+I1l1lllll.spSearchSelectTpl+'<button onclick="oui.SelectPerson.clearSearchHistory()" class="clear-history">清除历史记录</button>        ',I1lll1l11.init=function(I1l11llI){template.helper("console",console),template.helper("oui",l11II11l),template.helper("Math",Math),template.helper("selectPerson",I1l11llI),template.helper("encodeURIComponent",encodeURIComponent),this.SelectPerson=I1l11llI,this.initDom(),this.initUI(),this.initEvents()},I1lll1l11.initUI=function(){this.render("spOption",{isFlow:this.SelectPerson.options.isFlow})},I1lll1l11.render=function(l1I11II1,I11l1ll1,l11II111){var l1lll1l1I=this.renders[l1I11II1];l1lll1l1I||(l1lll1l1I=template.compile(I1l1lllll[l1I11II1+"Tpl"]),this.renders[l1I11II1]=l1lll1l1I),l1I11II1.indexOf("4")>0&&(l1I11II1=l1I11II1.substring(0,l1I11II1.indexOf("4")));var I1I1I111=l1lll1l1I({data:I11l1ll1});return l11II111||this[l1I11II1+"View"].html(l1lll1l1I({data:I11l1ll1})),I1I1I111},I1lll1l11.initDom=function(){this.spContentView=l1I11III(".selectwrap"),this.spMainView=this.spContentView.find("#spMainView"),this.spSearchLayerView=this.spContentView.find("#spSearchView"),this.spNavigationView=this.spContentView.find(".selectOrganize-name .organize"),this.spTabsView=this.spMainView.find("#sp_tabContent"),this.spSelectView=this.spMainView.find("#sp_tabContent"),this.spLFView=this.spSelectView,this.spSearchBtnView=this.spMainView.find(".selectSearch"),this.spSearchBtn=this.spSearchBtnView.find(".search-btn"),this.spSearchView=this.spSearchLayerView.find(".selectSearch"),this.spSearchInput=this.spSearchView.find("input"),this.spSearchConfirmBtn=this.spSearchView.find(".search-submit"),this.spSearchCancleBtn=this.spSearchView.find(".search-cancle"),this.spSearchSelectView=this.spSearchLayerView.find(".searchmain"),this.spSearchHistoryView=this.spSearchSelectView,this.spFView=this.spContentView.find(".selectFooter"),this.spDeleteTips=this.spFView.find(".delete-tips"),this.spSelectedView=this.spFView.find(".selectActive-user ul"),this.spOptionView=this.spFView.find(".selectOption")},I1lll1l11.initEvents=function(){var I1I11IIl=this,I11I1II1=null;I1I11IIl.spContentView.on("click","[link]",function(){I11I1II1=l1I11III(this);var I11II111=I11I1II1.attr("link");return I1I11IIl.SelectPerson.linkTo(I11II111,I11I1II1),!1}),I1I11IIl.spSearchBtn.on("click",function(){return I1I11IIl.SelectPerson.linkTo("#/search/"),!1}),I1I11IIl.spSearchConfirmBtn.on("click",function(){return I1I11IIl.SelectPerson.search(),!1}),I1I11IIl.spSearchCancleBtn.on("click",function(){return I1I11IIl.SelectPerson.linkTo("#/closeSearch/"),!1})},l11II11l.SelectPersonUI=I1lll1l11}(jQuery,document,oui),function(I1l11lll,I11l1ll1,I11II111,l1lll1l1l,I1I1IIIIl){var I1l1l11I=[{key:"team",name:"组",icon:"team",enableCheck:!1},{key:"contact",name:"联系人",icon:"contact",enableCheck:!1},{key:"department",name:"部门",icon:"depart",enableCheck:!1},{key:"relativeRole",name:"相对角色",icon:"relative",enableCheck:!1},{key:"role",name:"角色",icon:"role",enableCheck:!1}],I1II111II={TEAM_PERSON:"team_person",ORG_PERSON:"org_person"},I1IIIIIII={};I1IIIIIII.TypeEnum={COMMON:0,FLOW:1},I1IIIIIII.init=function(l11I1IIl){I1l11lll.extend(this,{selectMap:{},selectedItems:[],isSearch:!1,navigationData:[{name:"组织机构",linkTo:"#/home/"}]}),l1lll1l1l.clearCache(),this.options=I1l11lll.extend({},l11I1IIl),I1I1IIIIl.init(this);var I11II111=this.options.showType;I11II111+""=="4"&&I1I1IIIIl.spSearchBtnView.hide(),window.location.hash="#/selectPerson",this.initHashChange(),this.linkTo("#/home/"),this.initFillBack(),this.options.afterInit(I1I1IIIIl),this.isFristClick2department=!0};var l1II1I11I=function(){window.location.href.indexOf("#/selectPerson")<0&&I1IIIIIII.close()};I1IIIIIII.initHashChange=function(){window.addEventListener("hashchange",l1II1I11I,!1)},I1IIIIIII.click2department=function(){var I1l11llI=this;I1l11llI.setCurrentSelectType(I1II111II.ORG_PERSON);var I11l1ll1=I1l11llI.options.rangeId+"",l11ll11l=I11II111.ORG_TYPE_ENUM.company,l1III1I1l=I1l11llI.options.showType,I1I1IIIII=null,l1l1l11l=I1l11llI.options.onlyRange+""=="true";l1l1l11l?I11l1ll1&&I11l1ll1!==I11II111.RANGE_TYPE.company&&I11l1ll1!==I11II111.RANGE_TYPE.currentDept?(l11ll11l=I11II111.ORG_TYPE_ENUM.department,I1I1IIIII=I11l1ll1):I11l1ll1===I11II111.RANGE_TYPE.currentDept&&(l11ll11l=I11II111.ORG_TYPE_ENUM.department,I1I1IIIII=currentDepartmentID):I11l1ll1&&I11l1ll1!==I11II111.RANGE_TYPE.company&&I11l1ll1!==I11II111.RANGE_TYPE.currentDept?I1I1IIIII=I11l1ll1:I11l1ll1===I11II111.RANGE_TYPE.currentDept&&(I1I1IIIII=currentDepartmentID),l1lll1l1l.getOrg(l11ll11l,I1I1IIIII,function(I11I1IIl){if(I11I1IIl&&I11I1IIl.length>0&&l11ll11l===I11II111.ORG_TYPE_ENUM.company&&(I11I1IIl[0].level=0),!l1l1l11l&&null!==I1I1IIIII&&I1I1IIIII.length>0&&I1l11llI.isFristClick2department){for(var l11ll111=l1lll1l1l.getParentsById(I1I1IIIII,[]),I1l1llllI=null,I1l1l11l=l11ll111.length-1;I1l1l11l>=0;I1l1l11l--){I1l1llllI=l11ll111[I1l1l11l];var I1ll111lI=I1l11lll.extend(!0,{},I1l1llllI,{children:I1l1llllI.children&&I1l1llllI.children.length});I1l11llI.navigation.add({name:I1ll111lI.name,linkTo:"#/department/spData/",spData:I1ll111lI})}I1l11llI.isFristClick2department=!1,l1lll1l1l.getChildOrgByOrg({id:I1I1IIIII,typeFlag:I11II111.ORG_TYPE_ENUM.department},function(l1I11IIl){I1I1IIIIl.render("spLF",l1I11IIl)},l1III1I1l+""=="4")}else I1I1IIIIl.render("spLF",I11I1IIl)},null,!0)},I1IIIIIII.click2relativeRole=function(){this.setCurrentSelectType(I1II111II.ORG_PERSON),l1lll1l1l.getRelativeRoles(function(I1l11lll){I1I1IIIIl.render("spLF",I1l11lll)})},I1IIIIIII.click2role=function(){this.setCurrentSelectType(I1II111II.ORG_PERSON),l1lll1l1l.getOrg(I11II111.ORG_TYPE_ENUM.role,null,function(l1l11llI){I1I1IIIIl.render("spLF",l1l11llI)},null,!0)},I1IIIIIII.userId2AccountId=function(l1l11lll,l11I1III){var l11II11I=this.options.filterSelf+""!="false",I1lll1l1l=this.options.showType;I1lll1l1l>=3?l1lll1l1l.userId2AccountId(l1l11lll,l11II11I,function(I1I11II1){l11I1III&&l11I1III(I1I11II1.data)}):l11I1III&&l11I1III(l1l11lll)},I1IIIIIII.accountId2UserId=function(l1l11ll1,l11l1llI){var l11ll11l=this.options.showType;l11ll11l>=3&&l1l11ll1[0].typeFlag!==I11II111.ORG_TYPE_ENUM.all?l11l1llI&&l11l1llI(l1l11ll1):(l1l11ll1[0].typeFlag===I11II111.ORG_TYPE_ENUM.all&&(I1IIIIIII.orgId=l1l11ll1[0].id),l11l1llI&&l11l1llI(l1l11ll1))},I1IIIIIII.initFillBack=function(){var I1l11llI=this,I11l1lll=this.options.fillback;I11l1lll&&I11l1lll.length>0&&I1l11llI.accountId2UserId(I11l1lll,function(I1I11IIl){I11l1lll=I1I11IIl;var l11I1III,I11II11I,I1lll1l11=I11l1lll.length;for(l11I1III=0;I1lll1l11>l11I1III;l11I1III++)I11II11I=I11l1lll[l11I1III],I1IIIIIII.selectMap[I11II11I.id]=I11II11I;I1l11llI.renderSelectedView(I11l1lll)})},I1IIIIIII.linkTo=function(I1I11II1,I11I1II1){var l11ll111=this;if(l11ll111.isSearch)return l11ll111.hideSearchLayer(),void(l11ll111.isSearch=!1);var l1lll1l1I=null;switch(I1I11II1){case"#/":if(l11ll111.isSearch)return l11ll111.hideSearchLayer(),void(l11ll111.isSearch=!1);l11ll111.click2Cancel();break;case"#/team/spData/":l1lll1l1I=I11I1II1.attr("spData"),l1lll1l1I=I11II111.parseJson(l1lll1l1I),l11ll111.navigation.add({name:l1lll1l1I.name}),l1lll1l1l.getPersonByOrgObj(l1lll1l1I,function(l1l11ll1){I1I1IIIIl.render("spLF",l1l11ll1)});break;case"#/child/spData":l1lll1l1I=I11I1II1.attr("spData"),l1lll1l1I=I11II111.parseJson(l1lll1l1I),l11ll111.navigation.add({name:l1lll1l1I.name}),l1lll1l1l.getPersonByOrgObj(l1lll1l1I,function(I1l11lll){I1I1IIIIl.render("spLF",I1l11lll)});break;case"#/contact/":l11ll111.navigation.clear().add({name:"联系人",linkTo:"#/contact/"}),l11ll111.click2contact();break;case"#/search/":l11ll111.showSearchLayer(),l11ll111.isSearch=!0;break;case"#/closeSearch/":l11ll111.hideSearchLayer(),l11ll111.isSearch=!1;break;case"#/department/":l11ll111.navigation.clear().add({name:"部门",linkTo:"#/department/"}),l11ll111.click2department();break;case"#/department/spData/":l1lll1l1I=I11I1II1.attr("spData"),l1lll1l1I=I11II111.parseJson(l1lll1l1I);var I1I1I111=I1l11lll.extend(!0,{},l1lll1l1I,{children:l1lll1l1I.children&&l1lll1l1I.children.length});I11I1II1.parent().hasClass("organize")&&l11ll111.navigation.removeByIndex(I11I1II1.index()),l11ll111.navigation.add({name:I1I1I111.name,linkTo:"#/department/spData/",spData:I1I1I111});var I1II111I1=l11ll111.options.showType;l1lll1l1l.getChildOrgByOrg(I1I1I111,function(l1l11lll){I1I1IIIIl.render("spLF",l1l11lll)},I1II111I1+""=="4");break;case"#/relativeRole/":l11ll111.navigation.clear().add({name:"相对角色",linkTo:"#/relativeRole/"}),l11ll111.click2relativeRole();break;case"#/role/":l11ll111.navigation.clear().add({name:"自定义角色",linkTo:"#/role/"}),l11ll111.click2role();break;case"#/home/":default:var I1llllll1=I1I11II1.replace("#/","").replace("/","");I1llllll1="click2"+I1llllll1,I1IIIIIII[I1llllll1]?I1IIIIIII[I1llllll1]():(l11ll111.initTabs(),l11ll111.initExtendTabClick(),l11ll111.currentByType="",l11ll111.navigation.clear())}},I1IIIIIII.initTabs=function(){var l1l11ll1,l11I1II1,I11II11I=this,I1lll1l11=[],I1I1IIII1=this.options.showType,l1II111Il=this.options.tabs,l1llllllI=l1II111Il.split(","),I1ll1l11I=l1llllllI.length;for(l1l11ll1=0;I1ll1l11I>l1l11ll1;l1l11ll1++)if(l11I1II1=l1llllllI[l1l11ll1],l11I1II1=parseInt(l11I1II1)){var l11IIII1=I1l1l11I[l11I1II1-1];l11IIII1&&(3>I1I1IIII1||I1I1IIII1>=3&&1!==l11I1II1&&2!==l11I1II1&&I1lll1l11.push(l11IIII1))}if(I11II11I.options.extend&&I11II11I.options.extend.tabs&&I11II11I.options.extend.tabs.length>0){var I1II11III=I11II11I.options.extend.tabs,l1llll1I=null,l1ll1l1l1=null;for(l1l11ll1=0,I1ll1l11I=I1II11III.length;I1ll1l11I>l1l11ll1;l1l11ll1++)l1ll1l1l1=I1II11III[l1l11ll1],l1llll1I={key:l1ll1l1l1.type,name:l1ll1l1l1.title,icon:l1ll1l1l1.icon},I1lll1l11.push(l1llll1I)}I1I1IIIIl.render("spTabs",I1lll1l11)},I1IIIIIII.initExtendTabClick=function(){var l1l11llI=this;if(l1l11llI.options.extend&&l1l11llI.options.extend.tabs&&l1l11llI.options.extend.tabs.length>0){var l11I1IIl,l11II111,l1lll1l11=l1l11llI.options.extend.tabs,l1l1llll1=null;for(l11I1IIl=0,l11II111=l1lll1l11.length;l11II111>l11I1IIl;l11I1IIl++)l1l1llll1=l1lll1l11[l11I1IIl],I1IIIIIII["click2"+l1l1llll1.type]=function(l1I11IIl){return function(){return l1l11llI.navigation.clear().add({name:l1I11IIl.title,linkTo:"#/"+l1I11IIl.type+"/"}),this.setCurrentSelectType(l1I11IIl.type,l1I11IIl.type),l1lll1l1l.getDataByExtendTab(l1I11IIl,function(l1I11III){I1I1IIIIl.render("spLF",l1I11III)}),!1}}(l1l1llll1)}},I1IIIIIII.setCurrentSelectType=function(I1I11IIl,l11l1lll){this.currentSelectType=I1I11IIl,l11l1lll&&(this.currentByType=l11l1lll),I1I1IIIIl.spSearchInput.val("")},I1IIIIIII.navigation={add:function(l1I11II1){return I1IIIIIII.navigationData.push(l1I11II1),this.render(),this},removeByIndex:function(I1l11ll1){return I1IIIIIII.navigationData.splice(I1l11ll1,I1IIIIIII.navigationData.length-I1l11ll1),this},remove:function(){return I1IIIIIII.navigationData.splice(I1IIIIIII.navigationData.length-1,1),this.render(),this},clear:function(){return I1IIIIIII.navigationData=[{name:"组织机构",linkTo:"#/home/"}],this.render(),this},render:function(){return I1I1IIIIl.render("spNavigation",I1IIIIIII.navigationData),this}},I1IIIIIII.searchHistory={add:function(l1I11III){},clear:function(){},get:function(){return[]}},I1IIIIIII.clearSearchHistory=function(){I1IIIIIII.searchHistory.clear(),I1I1IIIIl.render("spSearchSelect",[])},I1IIIIIII.showSearchLayer=function(){var l1l11llI=this.options.showType,l11l1ll1=this.currentByType;(!l11l1ll1||I11II111.ORG_TYPE_ENUM[l11l1ll1])&&l1l11llI>=3&&this.setCurrentSelectType(I1II111II.ORG_PERSON),I1I1IIIIl.spMainView.hide();var I1lll1l1l=I1IIIIIII.searchHistory.get();I1lll1l1l&&I1lll1l1l.length>0?I1I1IIIIl.render("spSearchHistory",I1IIIIIII.searchHistory.get()):I1IIIIIII.clearSearchHistory(),I1I1IIIIl.spSearchLayerView.show()},I1IIIIIII.hideSearchLayer=function(){I1I1IIIIl.spMainView.show(),I1I1IIIIl.spSearchLayerView.hide(),I1I1IIIIl.spSearchInput.blur()},I1IIIIIII.checkSelectType=function(l1I11III){var I11l1ll1=this.options.chooseType,I11II11I=this.options.isAll+""=="true";if(I11II111.ORG_TYPE_ENUM[l1I11III.typeFlag])if(I11II111.ORG_TYPE_ENUM.company===l1I11III.typeFlag){var I1III1I1I=this.options.allowCompany;if(!I11II11I&&!I1III1I1I)return!1}else if(I11l1ll1&&I11l1ll1.length>0&&I11l1ll1.indexOf(l1I11III.typeFlag)<0)return!1;return!0},I1IIIIIII.checkSelected=function(I1l11llI){var I11I1IIl=I1l11llI.id,l11II11I=I1I1IIIIl.spSelectedView.find("li").length,I1III1I1I=this.options.isMulti;I1III1I1I=I1III1I1I+""!="false";var I1l1lllll=this.options.maxSize;if(I1l1lllll=parseInt(I1l1lllll||"-1"),(I1III1I1I&&1>=I1l1lllll||I1l1lllll>200)&&(I1l1lllll=200),I1III1I1I||(I1l1lllll=1),I1IIIIIII.selectMap[I11I1IIl])return!1;if(I1IIIIIII.orgId&&I1IIIIIII.selectMap[I1IIIIIII.orgId])return!1;if(!I1IIIIIII.checkSelectType(I1l11llI))return!1;var I1I1I111=this.options.showType;if(I1III1I1I){if(I1l1lllll>1&&l11II11I>=I1l1lllll)return I1I1I111>=3&&(I1I1I111+""=="4"?I11II111.alert("您只能选择"+I1l1lllll+"个部门"):I11II111.alert("您只能选择"+I1l1lllll+"个")),!1}else if(l11II11I>=1)return I1I1I111>=3&&(I1I1I111+""=="4"?I11II111.alert("您只能选择一个部门"):I11II111.alert("您只能选择一个！")),!1;return!0},I1IIIIIII.renderSelectedView=function(l1l11lll,l11l1lll){if(l11l1lll+""=="true"){var l11ll111=l1l11lll.id;I1I1IIIIl.spSelectedView.find("li#sp_selected_"+l11ll111).remove(),I1I1IIIIl.spSelectView.find("input#sp_"+l11ll111).length>0&&(I1I1IIIIl.spSelectView.find("input#sp_"+l11ll111)[0].checked=!1),I1I1IIIIl.spSearchSelectView.find("input#sp_s_"+l11ll111).length>0&&(I1I1IIIIl.spSearchSelectView.find("input#sp_s_"+l11ll111)[0].checked=!1),delete I1IIIIIII.selectMap[l11ll111],I1IIIIIII.selectMap[l11ll111]=null}else{l1l11lll instanceof Array||(l1l11lll=[l1l11lll]);for(var I1III1I1I=0,l1l1llll1=l1l11lll.length;l1l1llll1>I1III1I1I;I1III1I1I++)I1IIIIIII.selectMap[l1l11lll[I1III1I1I].id]=l1l11lll[I1III1I1I],l1l11lll[I1III1I1I].typeFlag===I11II111.ORG_TYPE_ENUM.person&&(l1l11lll[I1III1I1I].name=l1l11lll[I1III1I1I]._name||l1l11lll[I1III1I1I].name);var l1I1I111=I1I1IIIIl.render("spSelected",l1l11lll,!0);I1I1IIIIl.spSelectedView.append(l1I1I111)}I11II111.getObjectLength(I1IIIIIII.selectMap)>0?I1I1IIIIl.spDeleteTips.show():I1I1IIIIl.spDeleteTips.hide(),I1I1IIIIl.spSelectedView.parent().scrollLeft(9999)},I1IIIIIII.removeItem=function(l1l11llI){this.renderSelectedView(l1l11llI,!0)},I1IIIIIII.findChild=function(I1I11IIl,I11l1ll1){var l11ll111=l1lll1l1l.getChildDepartmentByOrg(I11l1ll1);if(I11l1ll1.children||I11l1ll1.children.length>0){I1IIIIIII.checkSelected(I11l1ll1)&&I1I11IIl.push(I11l1ll1);for(var I1l1llll1=0,I1l1l11l=l11ll111.length;I1l1l11l>I1l1llll1;I1l1llll1++)I1IIIIIII.findChild(I1I11IIl,l11ll111[I1l1llll1])}else I1IIIIIII.checkSelected(I11l1ll1)&&I1I11IIl.push(I11l1ll1)},I1IIIIIII.checkChange=function(l1I11III,I11I1II1){var l11ll11l=this,l1III1I1I=this.options.isAll+""=="true",I1I1IIIII=parseInt(l11ll11l.options.includeChildType||"1"),I1l1l111=I11I1II1.id;if(l1I11III.checked){var l1II111II=I1l11lll(l1I11III).attr("sp_search");if(l11ll11l.checkSelected(I11I1II1))if(I11I1II1.typeFlag===I11II111.ORG_TYPE_ENUM.department||I11I1II1.typeFlag===I11II111.ORG_TYPE_ENUM.company)if(I11I1II1.children||I11I1II1.typeFlag===I11II111.ORG_TYPE_ENUM.company){if(l1III1I1I&&I11I1II1.level+""=="0")return I11I1II1={id:I11I1II1.id,name:"全体人员",typeFlag:I11II111.ORG_TYPE_ENUM.all},I1IIIIIII.orgId=I11I1II1.id,l1II111II&&I1IIIIIII.searchHistory.add(I11I1II1),l11ll11l.renderSelectedView(I11I1II1),!1;if(I1I1IIIII+""=="0"){var l1IIIIIIl=[];I11II111.getTop().oui.confirmDialog("此部门下包含子部门，是否选中子部门",function(){I1IIIIIII.findChild(l1IIIIIIl,I11I1II1),l1IIIIIIl.length>0&&(l1II111II&&I1IIIIIII.searchHistory.add(l1IIIIIIl),l11ll11l.renderSelectedView(l1IIIIIIl))},function(){l1II111II&&I1IIIIIII.searchHistory.add(I11I1II1),l11ll11l.renderSelectedView(I11I1II1)})}else l1II111II&&I1IIIIIII.searchHistory.add(I11I1II1),l11ll11l.renderSelectedView(I11I1II1)}else l1II111II&&I1IIIIIII.searchHistory.add(I11I1II1),l11ll11l.renderSelectedView(I11I1II1);else l1II111II&&I1IIIIIII.searchHistory.add(I11I1II1),l11ll11l.renderSelectedView(I11I1II1);else{var l1II1I11I=I1I1IIIIl.spSelectView.find("input#sp_"+I1l1l111);l1II1I11I.length>0&&(l1II1I11I[0].checked=!1);var I11IIIII=I1I1IIIIl.spSearchSelectView.find("input#sp_s_"+I1l1l111);I11IIIII.length>0&&(I11IIIII[0].checked=!1)}}else this.renderSelectedView(I11I1II1,!0);return!1},I1IIIIIII.optionChange=function(I1l11ll1,I11I1II1){var l1lll1l11=null;switch(I11I1II1){case I11II111.ORG_TYPE_ENUM.role:case I11II111.ORG_TYPE_ENUM.level:l1lll1l11=I1l11lll(I1l11ll1).attr("spData"),l1lll1l11=I11II111.parseJson(l1lll1l11),I1IIIIIII.navigation.add({name:l1lll1l11.name,linkTo:"#/team/spData/",spData:l1lll1l11}),l1lll1l1l.getPersonByOrgObj(l1lll1l11,function(l1I11IIl){I1I1IIIIl.render("spLF",l1I11IIl)});break;default:l1lll1l11=I1l11lll(I1l11ll1).attr("spData"),l1lll1l11=I11II111.parseJson(l1lll1l11);var I1l1lllll=l1lll1l11.id,I1l1l11I=I1I1IIIIl.spSelectView.find("input#sp_"+I1l1lllll),I1II111Il=null;I1l1l11I.length>0&&(I1II111Il=I1l1l11I[0],I1II111Il.checked=!I1II111Il.checked);var l1llllllI=I1I1IIIIl.spSearchSelectView.find("input#sp_s_"+I1l1lllll),l1II1I11I=null;l1llllllI.length>0&&(l1II1I11I=l1llllllI[0],l1II1I11I.checked=!l1II1I11I.checked,I1l1l11I=l1llllllI),I1l1l11I.trigger("change")}return!1},I1IIIIIII.isSelected=function(I1I11IIl){if(!I1I11IIl)return!1;var I11l1llI=I1I11IIl.id;return!!I1IIIIIII.selectMap[I11l1llI]},I1IIIIIII.getSelectedData=function(){var l1I11III,l11l1lll,l11ll11I=[];for(l11l1lll in this.selectMap)if(l1I11III=this.selectMap[l11l1lll]){if(l1I11III.typeFlag===I11II111.ORG_TYPE_ENUM.all)return[l1I11III];l11ll11I.push(l1I11III)}return l11ll11I},I1IIIIIII.search=function(){var l1I11IIl=this,l11l1ll1=l1I11IIl.options.showType,I11ll11I=I1I1IIIIl.spSearchInput.val();switch(l1I11IIl.currentSelectType){case I1II111II.ORG_PERSON:if(l11l1ll1+""=="4")I1I1IIIIl.render("spSearchSelect",[]);else{var l1III1I1I=l1I11IIl.options.rangeId+"",I1l1llllI=null,l1I1I111=l1I11IIl.options.onlyRange+""=="true";l1I1I111&&(l1III1I1I&&l1III1I1I!==I11II111.RANGE_TYPE.company&&l1III1I1I!==I11II111.RANGE_TYPE.currentDept?I1l1llllI=l1III1I1I:l1III1I1I===I11II111.RANGE_TYPE.currentDept&&(I1l1llllI=currentDepartmentID)),l1lll1l1l.searchByName4Org(I11II111.ORG_TYPE_ENUM.department,I11ll11I,I1l1llllI,function(I1I11III){I1I1IIIIl.render("spSearchSelect",I1I11III)})}break;default:I11II111.ORG_TYPE_ENUM[l1I11IIl.currentSelectType]||l1lll1l1l.search4Extend(l1I11IIl.currentSelectType,I11ll11I,function(I1l11llI){I1I1IIIIl.render("spSearchSelect",I1l11llI)})}},I1IIIIIII.click2Ok=function(I1I11II1){var l11I1II1=this,l11II111=this.getSelectedData(),l1lll1l11=!0;return l11II111&&1===l11II111.length&&l11II111[0].typeFlag===I11II111.ORG_TYPE_ENUM.all?(l1lll1l11=l11I1II1.options.callbackOk({data:l11II111,flowType:I1I11II1}),l1lll1l11!==!1&&(I11II111.back(),l11I1II1.close())):l11I1II1.userId2AccountId(l11II111,function(l1I11III){var I11l1llI=l11I1II1.options.callbackOk({data:l1I11III,flowType:I1I11II1});I11l1llI!==!1&&(I11II111.back(),l11I1II1.close())}),!1},I1IIIIIII.click2Cancel=function(){return this.options.callbackCancel(),I11II111.back(),this.close(),!1},I1IIIIIII.close=function(){return I11II111.$.ctrl.dialog.SelectPersonDialog.close(),window.removeEventListener("hashchange",l1II1I11I,!1),!1},I1IIIIIII.getIconBgNum=function(I1l11lll){var l11l1ll1=I1l11lll.id.substring(I1l11lll.id.length-1,I1l11lll.id.length);return l11l1ll1=parseInt(l11l1ll1),isNaN(l11l1ll1)&&(l11l1ll1=I1l11lll.id.length),l11l1ll1%10},I11II111.SelectPerson=I1IIIIIII}(jQuery,document,oui,oui.SelectPersonBiz,oui.SelectPersonUI);





