
!function(I1l111l1){I1l111l1.shapeTplCfg={"tpl-line-next":'{{if data.html }}<div id="line-text-{{data.id}}" from-shape-id="{{data.fromShapeId}}" to-shape-id="{{data.toShapeId}}" line-id="{{data.lineId || data.id}}"  class="oui-line-text line-next {{data.cls}}" style="position: absolute;left:{{data.centerPoint.x}}px;top:{{data.centerPoint.y}}px;z-index:{{data.zIndex?data.zIndex+1:1}}"><div class="text {{data.textCls}}" from-shape-id="{{data.fromShapeId}}" to-shape-id="{{data.toShapeId}}"  line-text-id="{{data.lineId || data.id}}"  oui-e-click="{{data.click4text}}" oui-e-mouseenter="{{data.mouseenter4text}}" oui-e-mouseleave="{{data.mouseleave4text}}"  >{{data.html}}</div></div>{{/if}}',"tpl-line":'<div id="line-{{data.id}}" from-shape-id="{{data.fromShapeId}}" to-shape-id="{{data.toShapeId}}" line-id="{{data.lineId||data.id}}" oui-e-click="{{data.click}}" oui-e-mouseenter="{{data.mouseenter}}" oui-e-mouseleave="{{data.mouseleave}}"class="oui-shape-line app-form-line {{data.hasRelation?"app-form-relation-line":""}} {{data.cls}}" style="left:{{data.left}}px;top:{{data.top}}px;width:{{data.width}}px;"><style type="text/css" >#line-{{data.id}}{position:absolute;border-bottom: {{data.lineHeight}}px {{data.lineStyle}} {{data.color}};-webkit-transform:rotate({{data.rotate}}deg);-moz-transform:rotate({{data.rotate}}deg);-ms-transform:rotate({{data.rotate}}deg);-o-transform:rotate({{data.rotate}}deg);transform:rotate({{data.rotate}}deg);z-index:{{data.zIndex}};}</style>{{if data.hasArrow}}<div class="right-triangle {{if !data.hasArrow}}display_none{{/if}}"style="border-top: {{(data.lineHeight+14)/2}}px {{data.lineStyle}} transparent;border-left: {{data.lineHeight+14}}px {{data.lineStyle}} {{data.color}}; border-bottom: {{(data.lineHeight+14)/2}}px {{data.lineStyle}} transparent; position: absolute; right: -{{(data.lineHeight+14)}}px; top: 50%;margin-top: -{{((data.lineHeight+14)-data.lineHeight)/2}}px;"></div>{{/if}}{{if data.hasFromArrow}}<div class="left-triangle {{if !data.hasFromArrow}}display_none{{/if}}"style="border-bottom: {{(data.lineHeight+14)/2}}px {{data.lineStyle}} transparent;border-right: {{data.lineHeight+14}}px {{data.lineStyle}} {{data.color||"blue"}}; border-top: {{(data.lineHeight+14)/2}}px {{data.lineStyle}} transparent; position: absolute; left: -{{(data.lineHeight+14)}}px; top: 50%;margin-top: -{{((data.lineHeight+14)-data.lineHeight)/2}}px;"></div>{{/if}}{{if data.isSmoothingPoints}}<div class="right-circle" style="position: absolute;right:-{{data.lineHeight/2}}px;top:0px;width:{{data.lineHeight}}px;height:{{data.lineHeight}}px; -moz-border-radius:{{data.lineHeight/2}}px;-webkit-border-radius:{{data.lineHeight/2}}px;border-radius:{{data.lineHeight/2}}px;background: {{data.color}};z-index:{{data.zIndex}};"></div>{{/if}}</div>',"tpl-circle":'<div id="circle-{{data.id}}"   targets-json="{{data.targetsJson}}" to-ids="{{data.toIds.join(",")}}"  oui-e-click="{{data.click}}" oui-e-mouseenter="{{data.mouseenter}}" oui-e-mouseleave="{{data.mouseleave}}"class="oui-shape app-form-circle  {{data.cls}}" style="left:{{data.left}}px;top:{{data.top}}px;width:{{data.r*2}}px;height:{{data.r*2}}px; -moz-border-radius:{{data.r+data.borderWidth}}px;-webkit-border-radius:{{data.r+data.borderWidth}}px;border-radius:{{data.r+data.borderWidth}}px;background: {{data.background}};border:{{data.borderWidth}}px {{data.borderStyle}} {{data.borderColor}};z-index:{{data.zIndex}};">{{if data.html}}<div id="circle-text-{{data.id}}" class="oui-shape-text"><div class="text" style="max-height: {{data.r*2*70/100}}px">{{data.html}}</div> </div>{{/if}}</div>',"tpl-shape":'<div id="shape-{{data.id}}"  targets-json="{{data.targetsJson}}" to-ids="{{data.toIds.join(",")}}"  oui-e-click="{{data.click}}" oui-e-mouseenter="{{data.mouseenter}}" oui-e-mouseleave="{{data.mouseleave}}"class="oui-shape {{data.cls}}" style="left:{{data.left}}px;top:{{data.top}}px;width:{{data.width}}px;height:{{data.height}}px; -moz-border-radius:{{data.borderRadius}}px;-webkit-border-radius:{{data.borderRadius}}px;border-radius:{{data.borderRadius}}px;background: {{data.background}};border:{{data.borderWidth}}px {{data.borderStyle}} {{data.borderColor}};z-index:{{data.zIndex}}">{{if data.html}}{{=data.html}}{{/if}}</div>',"tpl-rect":'<div id="rect-{{data.id}}"  targets-json="{{data.targetsJson}}" to-ids="{{data.toIds.join(",")}}"  oui-e-click="{{data.click}}" oui-e-mouseenter="{{data.mouseenter}}" oui-e-mouseleave="{{data.mouseleave}}"class="oui-shape app-form-rect {{data.cls}}" style="left:{{data.left}}px;top:{{data.top}}px;width:{{data.width}}px;height:{{data.height}}px; -moz-border-radius:{{data.borderRadius}}px;-webkit-border-radius:{{data.borderRadius}}px;border-radius:{{data.borderRadius}}px;background: {{data.background}};border:{{data.borderWidth}}px {{data.borderStyle}} {{data.borderColor}};z-index:{{data.zIndex}}">{{if data.html}}<div id="rect-text-{{data.id}}" class="oui-shape-text"><div class="text" style="max-height: {{data.height*70/100}}px">{{data.html}}</div> </div>{{/if}}</div>',"tpl-oval":'<div id="oval-{{data.id}}"  targets-json="{{data.targetsJson}}" to-ids="{{data.toIds.join(",")}}"  oui-e-click="{{data.click}}" oui-e-mouseenter="{{data.mouseenter}}" oui-e-mouseleave="{{data.mouseleave}}"class="oui-shape app-form-oval {{data.cls}}" style="left:{{data.left}}px;top:{{data.top}}px;width:{{data.width}}px;height:{{data.height}}px; -moz-border-radius:50%;-webkit-border-radius:50%;border-radius:50%;background: {{data.background}};border:{{data.borderWidth}}px {{data.borderStyle}} {{data.borderColor}};z-index:{{data.zIndex}}">{{if data.html}}<div id="oval-text-{{data.id}}" class="oui-shape-text"><div class="text" style="max-height: {{data.height*70/100}}px">{{data.html}}</div> </div>{{/if}}</div>',"tpl-star5":'<div id="star5-{{data.id}}"  targets-json="{{data.targetsJson}}"to-ids="{{data.toIds.join(",")}}"  oui-e-click="{{data.click}}" oui-e-mouseenter="{{data.mouseenter}}" oui-e-mouseleave="{{data.mouseleave}}"class="oui-shape app-form-star5  {{data.cls}}"  ><div class="star-five-{{data.id}}"></div><style type="text/css" >#star5-{{data.id}}{position:absolute;left:{{data.left}}px;top:{{data.top}}px;width:{{data.width}}px;height:{{1.8*data.width/2}}px;/*background:transparent;*/}.star-five-{{data.id}} {margin: {{0.3*data.width}}px 0;position: relative;display: block;color: {{data.color}};width: 0px;height: 0px;border-right:  {{data.width/2}}px {{data.borderStyle}} transparent;border-bottom: {{0.7*data.width/2}}px  {{data.borderStyle}} {{data.color}};border-left:   {{data.width/2}}px {{data.borderStyle}} transparent;-moz-transform:    rotate(35deg);-webkit-transform: rotate(35deg);-ms-transform:     rotate(35deg);-o-transform:      rotate(35deg);}.star-five-{{data.id}}:before {border-bottom: {{0.8*data.width/2}}px {{data.borderStyle}} {{data.color}};border-left: {{0.3*data.width/2}}px {{data.borderStyle}} transparent;border-right: {{0.3*data.width/2}}px {{data.borderStyle}} transparent;position: absolute;height: 0;width: 0;top: -{{0.45*data.width/2}}px;left: -{{0.65*data.width/2}}px;display: block;content: "";-webkit-transform: rotate(-35deg);-moz-transform:    rotate(-35deg);-ms-transform:     rotate(-35deg);-o-transform:      rotate(-35deg);}.star-five-{{data.id}}:after {position: absolute;display: block;color: {{data.color}};top: {{0.03*data.width/2}}px;left: -{{1.05*data.width/2}}px;width: 0px;height: 0px;border-right: {{data.width/2}}px {{data.borderStyle}} transparent;border-bottom: {{0.7*data.width/2}}px {{data.borderStyle}} {{data.color}};border-left: {{data.width/2}}px {{data.borderStyle}} transparent;-webkit-transform: rotate(-70deg);-moz-transform:    rotate(-70deg);-ms-transform:     rotate(-70deg);-o-transform:      rotate(-70deg);content: "";}#star5-text-{{data.id}}{position:absolute;left:50%;top:50%;-webkite-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);/*height:{{0.7*data.width}}px;*/z-index:{{data.zIndex}};}</style>{{if data.html}}<div id="star5-text-{{data.id}}" class="oui-shape-text"><div class="text" style="max-height: {{data.width*70/100}}px">{{data.html}}</div> </div>{{/if}}</div>',_:""}}(window),function(win){function getPoints4circle(l1I111II,l1l1l111,l1l11ll1I,l1lllllI){for(var l1l1ll11I=[],l1l1111ll=Math.PI/180*Math.round(360/l1lllllI),l1III1III=0;l1lllllI>l1III1III;l1III1III++){var l1I1I1I1=l1l1l111+l1I111II*Math.sin(l1l1111ll*l1III1III),I1111l1l=l1l11ll1I+l1I111II*Math.cos(l1l1111ll*l1III1III);l1l1ll11I.unshift({x:l1I1I1I1,y:I1111l1l})}return l1l1ll11I}var oui=win.oui=win.oui||{},GraphBiz={},defaultConfig={lineColor:"#5990cf",lineStyle:"solid",lineHeight:3},funCfg={},templateCfg={},loadTpl=function(I1I111II){if(win.shapeTplCfg)templateCfg=win.shapeTplCfg||{};else{var l1l1l11l=oui.loadUrl(oui.getContextPath()+"res_common/third/shape/shape.tpl.html");$(document.body).append('<div id="shape-runtime-tpl">'+l1l1l11l+"</div>");var l1I11II1I={};$("#shape-runtime-tpl").children().each(function(){l1I11II1I[this.id]=this.innerHTML}),templateCfg=l1I11II1I}};loadTpl();var funNameCfg={renderLine:"tpl-line",renderCircle:"tpl-circle",renderRect:"tpl-rect"},getRenderByTpl=function(l1I111I1){if(!funCfg[l1I111I1]){if(!templateCfg[l1I111I1])throw new Error("图形模板["+l1I111I1+"] 不存在!");funCfg[l1I111I1]=template.compile(templateCfg[l1I111I1])}return funCfg[l1I111I1]};for(var i in funNameCfg)funNameCfg.hasOwnProperty(i)&&funNameCfg[i]&&(GraphBiz[i]=getRenderByTpl(funNameCfg[i]));GraphBiz.renderBy=function(l1l111l1,l1I1I111){if(!l1l111l1)throw new Error("渲染图形配置不能为空");if(!l1l111l1.type)throw new Error("渲染图形类型不能为空");l1l111l1.id||(l1l111l1.id=oui.getUUIDLong()),l1l111l1.fromIds||(l1l111l1.fromIds=[]),l1l111l1.targetsJson||(l1l111l1.targetsJson=oui.parseString([])),l1l111l1.toIds||(l1l111l1.toIds=[]),"undefined"==typeof l1l111l1.left&&"number"==typeof l1l111l1.x&&(l1l111l1.left=l1l111l1.x),"undefined"==typeof l1l111l1.top&&"number"==typeof l1l111l1.y&&(l1l111l1.top=l1l111l1.y);var I1I11II1I="tpl-"+l1l111l1.type,l1IIIIIl=getRenderByTpl(I1I11II1I),l1I1II11l=null;templateCfg[I1I11II1I+"-next"]&&(l1I1II11l=getRenderByTpl(I1I11II1I+"-next"));var I1I1111II=l1IIIIIl({data:l1l111l1}),l1III1IIl=l1l111l1.type+"-"+l1l111l1.id,I1l1l1l1=$(".app-layout-center").find("#"+l1III1IIl);if(l1l111l1.outerHTML=I1I1111II,l1I1I111){if(I1l1l1l1&&I1l1l1l1.length>0&&(I1l1l1l1.remove(),l1I1II11l)){var I1111I1l=I1l1l1l1.next();I1111I1l&&I1111I1l.length&&I1111I1l.hasClass(l1l111l1.type+"-next")&&I1111I1l.remove()}}else if(I1l1l1l1&&I1l1l1l1.length>0){if(I1l1l1l1[0].outerHTML=I1I1111II,l1I1II11l){var I1111I1l=I1l1l1l1.next();I1111I1l&&I1111I1l.length&&I1111I1l.hasClass(l1l111l1.type+"-next")&&(I1111I1l[0].outerHTML=l1I1II11l({data:l1l111l1}))}}else{var I1l1111I=$(I1I1111II),l1II111Il=l1l111l1.container||".app-layout-center";if($(l1II111Il).append(I1l1111I),l1I1II11l){var l1ll1llll=l1I1II11l({data:l1l111l1});$(l1II111Il).append($(l1ll1llll))}}return l1l111l1};var buildLineWithPoints=function(l1I111Il,I1I1I11I,l1l11ll1I){"undefined"==typeof l1I111Il.left&&"number"==typeof l1I111Il.x&&(l1I111Il.left=l1I111Il.x),"undefined"==typeof l1I111Il.top&&"number"==typeof l1I111Il.y&&(l1I111Il.top=l1I111Il.y),"undefined"==typeof I1I1I11I.left&&"number"==typeof I1I1I11I.x&&(I1I1I11I.left=I1I1I11I.x),"undefined"==typeof I1I1I11I.top&&"number"==typeof I1I1I11I.y&&(I1I1I11I.top=I1I1I11I.y);var I1lllllI=l1l11ll1I.points||[],l1I1II11I={};l1l11ll1I.html&&(l1I1II11I=getCenterPointInfo(l1I111Il,I1I1I11I,I1lllllI));var I1I1111II=[],l1III1IIl=[],I1I1I1II={id:l1l11ll1I.id||oui.getUUIDLong(),lines:l1III1IIl,lineIds:I1I1111II,config:l1l11ll1I};if(I1lllllI.length){var l1111l11=$.extend(!0,{},l1l11ll1I);l1111l11.hasArrow=!1,l1111l11.id=null,l1111l11.isSmoothingPoints=!0,l1111l11.lineId=I1I1I1II.id,l1I1II11I.from==l1I111Il&&l1I1II11I.to==I1lllllI[0]?(l1111l11.centerDistance=l1I1II11I.centerDistance,l1111l11.centerPoint=l1I1II11I):l1111l11.html="";var I1l1111l=buildLine(l1I111Il,I1lllllI[0],l1111l11);I1I1111II.push(I1l1111l.id),l1III1IIl.push(I1l1111l);for(var l1ll111lI=0,l1II1III1=I1lllllI.length-1;l1II1III1>l1ll111lI;l1ll111lI++){var l11l1lll=$.extend(!0,{},l1l11ll1I);l11l1lll.hasArrow=!1,l11l1lll.hasFromArrow=!1,l11l1lll.id=null,l11l1lll.isSmoothingPoints=!0,l11l1lll.lineId=I1I1I1II.id,l1I1II11I.from==I1lllllI[l1ll111lI]&&l1I1II11I.to==I1lllllI[l1ll111lI+1]?(l11l1lll.centerDistance=l1I1II11I.centerDistance,l11l1lll.centerPoint=l1I1II11I):l11l1lll.html="",l11l1lll=buildLine(I1lllllI[l1ll111lI],I1lllllI[l1ll111lI+1],l11l1lll),I1I1111II.push(l11l1lll.id),l1III1IIl.push(l11l1lll)}var l111l11I=$.extend(!0,{},l1l11ll1I);l111l11I.hasFromArrow=!1,l111l11I.lineId=I1I1I1II.id,l1I1II11I.from==I1lllllI[I1lllllI.length-1]&&l1I1II11I.to==I1I1I11I?(l111l11I.centerDistance=l1I1II11I.centerDistance,l111l11I.centerPoint=l1I1II11I):l111l11I.html="";var l1llll1I=buildLine(I1lllllI[I1lllllI.length-1],I1I1I11I,l111l11I);return I1I1111II.push(l1llll1I.id),l1III1IIl.push(l1llll1I),I1I1I1II}return l1l11ll1I.centerDistance=l1I1II11I.centerDistance,l1l11ll1I.centerPoint=l1I1II11I,buildLine(l1I111Il,I1I1I11I,l1l11ll1I)},buildLine=function(I1I111Il,I1I1I11l,I1I11II1I){"undefined"==typeof I1I111Il.left&&"number"==typeof I1I111Il.x&&(I1I111Il.left=I1I111Il.x),"undefined"==typeof I1I111Il.top&&"number"==typeof I1I111Il.y&&(I1I111Il.top=I1I111Il.y),"undefined"==typeof I1I1I11l.left&&"number"==typeof I1I1I11l.x&&(I1I1I11l.left=I1I1I11l.x),"undefined"==typeof I1I1I11l.top&&"number"==typeof I1I1I11l.y&&(I1I1I11l.top=I1I1I11l.y),I1I111Il.left=parseFloat(I1I111Il.left.toFixed(2)),I1I111Il.top=parseFloat(I1I111Il.top.toFixed(2)),I1I1I11l.left=parseFloat(I1I1I11l.left.toFixed(2)),I1I1I11l.top=parseFloat(I1I1I11l.top.toFixed(2));var I1IIIII1=I1I111Il.top-I1I1I11l.top,I1I1II11l=I1I111Il.left-I1I1I11l.left,I1l1111l1=Math.sqrt(I1I1II11l*I1I1II11l+I1IIIII1*I1IIIII1),l1lll1lll=0;I1I111Il.top==I1I1I11l.top?l1lll1lll=I1I1I11l.left>I1I111Il.left?0:180:I1I111Il.left==I1I1I11l.left?l1lll1lll=I1I1I11l.top>I1I111Il.top?90:270:(l1lll1lll=180*Math.atan(I1IIIII1/I1I1II11l)/Math.PI,I1I1I11l.left<I1I111Il.left&&(l1lll1lll+=180));var I1I1I1Il={type:"line",hasRelation:!0,left:I1I111Il.left,top:I1I111Il.top,width:I1l1111l1,lineStyle:defaultConfig.lineStyle,lineHeight:defaultConfig.lineHeight,color:defaultConfig.lineColor,rotate:l1lll1lll};if(I1I1I1Il=$.extend(!0,{},I1I1I1Il,I1I11II1I),I1I1I1Il.hasArrow){var I1111l1I=I1I1I1Il.lineHeight+14;I1I1I1Il.width-=I1111l1I,I1I1I1Il.width<0&&(I1I1I1Il.width=1)}if(I1I1I1Il.top=I1I1I1Il.top-I1I1I1Il.lineHeight/2,I1I1I1Il.hasFromArrow){var I1111l1I=I1I1I1Il.lineHeight+14;I1I1I1Il.width-=I1111l1I,I1I1I1Il.width<0&&(I1I1I1Il.width=1);var l1I1111I={};try{l1I1111I=getPosOnline(I1I111Il,I1I1I11l,I1111l1I)}catch(l1II111I1){l1I1111I={left:I1I1I1Il.left,top:I1I1I1Il.top}}I1I1I1Il.left=l1I1111I.left,I1I1I1Il.top=l1I1111I.top-I1I1I1Il.lineHeight/2}return GraphBiz.renderBy(I1I1I1Il,I1I11II1I.isNotRender)},buildLine4rect=function(I1l111l1,l1l1l11I,I1l11ll1I,l1lllll1){},getPosOnline=function(fromPos,toPos,fromLen){toPos.top=toPos.top||toPos.y,toPos.left=toPos.left||toPos.x,fromPos.top=fromPos.top||fromPos.y,fromPos.left=fromPos.left||fromPos.x;var lineExp="("+(toPos.top-fromPos.top).toFixed(2)+")*(x-"+fromPos.left+") = ("+(toPos.left-fromPos.left).toFixed(2)+")*(y-"+fromPos.top+")",circleExp="(x-"+fromPos.left+")*(x-"+fromPos.left+")+(y-"+fromPos.top+")*(y-"+fromPos.top+")="+fromLen*fromLen,lineEq=algebra.parse(lineExp),xValue,yValue,left,top;if(lineEq.toString().indexOf("y")<0&&lineEq.toString().indexOf("x")<0)return{};if(lineEq.toString().indexOf("y")<0)left=fromPos.left,top=fromPos.top<toPos.top?fromPos.top+fromLen:fromPos.top-fromLen;else if(lineEq.toString().indexOf("x")<0)top=fromPos.top,left=fromPos.left<toPos.left?fromPos.left+fromLen:fromPos.left-fromLen;else{var yExp=lineEq.solveFor("y"),ellipseExp4x=circleExp.replace(/y/gi,"("+yExp.toString()+")"),xEq=algebra.parse(ellipseExp4x),xEqStr=xEq.toString(),values=xEq.solveFor("x");if(xValue=values&&1==values.length?values[0]:values&&2==values.length?values:[],yValue=[],2==xValue.length||1==xValue.length){var yExpStr=yExp.toString(),xFirstParam=yExpStr.substring(0,yExpStr.indexOf("x")),xSecondParam=yExpStr.substring(yExpStr.indexOf("x")+1,yExpStr.length);xFirstParam=xFirstParam.replace(/ /gi,"")||"1",xSecondParam=xSecondParam.replace(/ /gi,"")||"1","+"==xFirstParam&&(xFirstParam="1"),"+"==xSecondParam&&(xSecondParam="1");var paramA4x=eval("-"==xFirstParam?"-1":xFirstParam),paramB4x=eval("-"==xSecondParam?"-1":xSecondParam),left1=parseFloat(xValue[0]),left2=parseFloat(xValue[1]);yValue[0]=paramA4x*left1+paramB4x,yValue[1]=paramA4x*left2+paramB4x;var top1=eval(yValue[0]),top2=eval(yValue[1]),minLeft=Math.min(fromPos.left,toPos.left),maxLeft=Math.max(fromPos.left,toPos.left);1==xValue.length||left1>=minLeft&&maxLeft>=left1?(left=left1,top=top1):(left=left2,top=top2)}}return{x:left,y:top,left:left,top:top}};oui._shapeMap={},oui.clearShapeMap=function(){oui._shapeMap={}};var getCoordinate=function(I1l111l1){return"nw"==I1l111l1.toLowerCase()?{x:this.x,y:this.y}:"nc"==I1l111l1.toLowerCase()?{x:this.x+this.w/2,y:this.y}:"ne"==I1l111l1.toLowerCase()?{x:this.x+this.w,y:this.y}:"em"==I1l111l1.toLowerCase()?{x:this.x+this.w,y:this.y+this.h/2}:"se"==I1l111l1.toLowerCase()?{x:this.x+this.w,y:this.y+this.h}:"sc"==I1l111l1.toLowerCase()?{x:this.x+this.w/2,y:this.y+this.h}:"sw"==I1l111l1.toLowerCase()?{x:this.x,y:this.y+this.h}:"wm"==I1l111l1.toLowerCase()?{x:this.x,y:this.y+this.h/2}:null},inRect=function(l1I111Il){var I1l1l11l=l1I111Il.x-this.x,l1I11II1I=l1I111Il.y-this.y;return 0>=I1l1l11l||I1l1l11l>=this.w?!1:0>=l1I11II1I||l1I11II1I>=this.h?!1:!0},standardWidth=20,getConnectionDirection=function(l1l111lI,l1l1l11I){var I1I11II11=l1l111lI.getCoordinate("EM"),I1lllllI=l1l1l11I.getCoordinate("WM");if(I1lllllI.x-I1I11II11.x>standardWidth)return["E","W"];if(I1I11II11=l1l111lI.getCoordinate("WM"),I1lllllI=l1l1l11I.getCoordinate("EM"),I1I11II11.x-I1lllllI.x>standardWidth)return["W","E"];if(I1I11II11=l1l111lI.getCoordinate("NC"),I1lllllI=l1l1l11I.getCoordinate("SC"),I1I11II11.y-I1lllllI.y>standardWidth)return["N","S"];if(I1I11II11=l1l111lI.getCoordinate("SC"),I1lllllI=l1l1l11I.getCoordinate("NC"),I1lllllI.y-I1I11II11.y>standardWidth)return["S","N"];if(I1I11II11=l1l111lI.getCoordinate("EM"),I1lllllI=l1l1l11I.getCoordinate("NC"),I1lllllI.x-I1I11II11.x>.5*standardWidth&&I1lllllI.y-I1I11II11.y>standardWidth)return["E","N"];if(I1lllllI=l1l1l11I.getCoordinate("SC"),I1lllllI.x-I1I11II11.x>.5*standardWidth&&I1I11II11.y-I1lllllI.y>standardWidth)return["E","S"];if(I1I11II11=l1l111lI.getCoordinate("WM"),I1lllllI=l1l1l11I.getCoordinate("SC"),I1I11II11.x-I1lllllI.x>.5*standardWidth&&I1I11II11.y-I1lllllI.y>standardWidth)return["W","S"];if(I1lllllI=l1l1l11I.getCoordinate("NC"),I1I11II11.x-I1lllllI.x>.5*standardWidth&&I1lllllI.y-I1I11II11.y>standardWidth)return["W","N"];if(I1I11II11=l1l111lI.getCoordinate("NC"),I1lllllI=l1l1l11I.getCoordinate("EM"),I1I11II11.y-I1lllllI.y>.5*standardWidth&&I1I11II11.x-I1lllllI.x>standardWidth)return["N","E"];if(I1lllllI=l1l1l11I.getCoordinate("WM"),I1I11II11.y-I1lllllI.y>.5*standardWidth&&I1lllllI.x-I1I11II11.x>standardWidth)return["N","W"];if(I1I11II11=l1l111lI.getCoordinate("SC"),I1lllllI=l1l1l11I.getCoordinate("EM"),I1lllllI.y-I1I11II11.y>.5*standardWidth&&I1I11II11.x-I1lllllI.x>standardWidth)return["S","E"];if(I1lllllI=l1l1l11I.getCoordinate("WM"),I1lllllI.y-I1I11II11.y>.5*standardWidth&&I1lllllI.x-I1I11II11.x>standardWidth)return["S","W"];if(I1I11II11=l1l111lI.getCoordinate("NC"),I1lllllI=l1l1l11I.getCoordinate("NC"),!l1l1l11I.inRect(I1I11II11)&&!l1l111lI.inRect(I1lllllI))if(I1I11II11.y-I1lllllI.y<0){if(Math.abs(I1I11II11.x-I1lllllI.x)>(l1l111lI.getWidth()+standardWidth)/2)return["N","N"]}else if(Math.abs(I1I11II11.x-I1lllllI.x)>l1l1l11I.getWidth()/2)return["N","N"];if(I1I11II11=l1l111lI.getCoordinate("EM"),I1lllllI=l1l1l11I.getCoordinate("EM"),!l1l1l11I.inRect(I1I11II11)&&!l1l111lI.inRect(I1lllllI))if(I1I11II11.x-I1lllllI.x>0){if(Math.abs(I1I11II11.y-I1lllllI.y)>(l1l111lI.getHeight()+standardWidth)/2)return["E","E"]}else if(Math.abs(I1I11II11.y-I1lllllI.y)>l1l1l11I.getHeight()/2)return["E","E"];return I1I11II11=l1l111lI.getCoordinate("NC"),I1lllllI=l1l1l11I.getCoordinate("EM"),l1l1l11I.inRect(I1I11II11)||l1l111lI.inRect(I1lllllI)?(I1lllllI=l1l1l11I.getCoordinate("WM"),l1l1l11I.inRect(I1I11II11)||l1l111lI.inRect(I1lllllI)?(I1I11II11=l1l111lI.getCoordinate("SC"),I1lllllI=l1l1l11I.getCoordinate("EM"),l1l1l11I.inRect(I1I11II11)||l1l111lI.inRect(I1lllllI)?(I1lllllI=l1l1l11I.getCoordinate("WM"),l1l1l11I.inRect(I1I11II11)||l1l111lI.inRect(I1lllllI)?["E","W"]:["S","W"]):["S","E"]):["N","W"]):["N","E"]},calcBendPoints=function(l1l111lI,l1l1l11I,I1l11ll1I){var l1lllllI,I1l1ll111,l1l1111lI=[];return"E"==I1l11ll1I[0]?(l1lllllI=l1l111lI.getCoordinate("EM"),l1l1111lI.push(l1lllllI),"S"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("SC"),l1l1111lI.push({x:I1l1ll111.x,y:l1lllllI.y}),l1l1111lI.push(I1l1ll111)):"N"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("NC"),l1l1111lI.push({x:I1l1ll111.x,y:l1lllllI.y}),l1l1111lI.push(I1l1ll111)):"E"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("EM"),l1l1111lI.push({x:Math.max(l1lllllI.x,I1l1ll111.x)+1.5*standardWidth,y:l1lllllI.y}),l1l1111lI.push({x:Math.max(l1lllllI.x,I1l1ll111.x)+1.5*standardWidth,y:I1l1ll111.y}),l1l1111lI.push(I1l1ll111)):(I1l1ll111=l1l1l11I.getCoordinate("WM"),I1l1ll111.y!=l1lllllI.y&&(l1l1111lI.push({x:(l1lllllI.x+I1l1ll111.x)/2,y:l1lllllI.y}),l1l1111lI.push({x:(l1lllllI.x+I1l1ll111.x)/2,y:I1l1ll111.y})),l1l1111lI.push(I1l1ll111))):"W"==I1l11ll1I[0]?(l1lllllI=l1l111lI.getCoordinate("WM"),l1l1111lI.push(l1lllllI),"S"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("SC"),l1l1111lI.push({x:I1l1ll111.x,y:l1lllllI.y}),l1l1111lI.push(I1l1ll111)):"N"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("NC"),l1l1111lI.push({x:I1l1ll111.x,y:l1lllllI.y}),l1l1111lI.push(I1l1ll111)):(I1l1ll111=l1l1l11I.getCoordinate("EM"),I1l1ll111.y!=l1lllllI.y&&(l1l1111lI.push({x:(l1lllllI.x+I1l1ll111.x)/2,y:l1lllllI.y}),l1l1111lI.push({x:(l1lllllI.x+I1l1ll111.x)/2,y:I1l1ll111.y})),l1l1111lI.push(I1l1ll111))):"N"==I1l11ll1I[0]?(l1lllllI=l1l111lI.getCoordinate("NC"),l1l1111lI.push(l1lllllI),"E"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("EM"),I1l1ll111.x-l1lllllI.x>0?(l1l1111lI.push({x:l1lllllI.x,y:l1lllllI.y-standardWidth}),l1l1111lI.push({x:I1l1ll111.x+1.5*standardWidth,y:l1lllllI.y-standardWidth}),l1l1111lI.push({x:I1l1ll111.x+1.5*standardWidth,y:I1l1ll111.y})):l1l1111lI.push({x:l1lllllI.x,y:I1l1ll111.y}),l1l1111lI.push(I1l1ll111)):"W"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("WM"),I1l1ll111.x-l1lllllI.x<0?(l1l1111lI.push({x:l1lllllI.x,y:l1lllllI.y-standardWidth}),l1l1111lI.push({x:I1l1ll111.x-1.5*standardWidth,y:l1lllllI.y-standardWidth}),l1l1111lI.push({x:I1l1ll111.x-1.5*standardWidth,y:I1l1ll111.y})):l1l1111lI.push({x:l1lllllI.x,y:I1l1ll111.y}),l1l1111lI.push(I1l1ll111)):"N"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("NC"),l1l1111lI.push({x:l1lllllI.x,y:Math.min(l1lllllI.y,I1l1ll111.y)-1.5*standardWidth}),l1l1111lI.push({x:I1l1ll111.x,y:Math.min(l1lllllI.y,I1l1ll111.y)-1.5*standardWidth}),l1l1111lI.push(I1l1ll111)):(I1l1ll111=l1l1l11I.getCoordinate("SC"),I1l1ll111.x!=l1lllllI.x&&(l1l1111lI.push({x:l1lllllI.x,y:(l1lllllI.y+I1l1ll111.y)/2}),l1l1111lI.push({x:I1l1ll111.x,y:(l1lllllI.y+I1l1ll111.y)/2})),l1l1111lI.push(I1l1ll111))):"S"==I1l11ll1I[0]&&(l1lllllI=l1l111lI.getCoordinate("SC"),l1l1111lI.push(l1lllllI),"E"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("EM"),I1l1ll111.x-l1lllllI.x>0?(l1l1111lI.push({x:l1lllllI.x,y:l1lllllI.y+standardWidth}),l1l1111lI.push({x:I1l1ll111.x+1.5*standardWidth,y:l1lllllI.y+standardWidth}),l1l1111lI.push({x:I1l1ll111.x+1.5*standardWidth,y:I1l1ll111.y})):l1l1111lI.push({x:l1lllllI.x,y:I1l1ll111.y}),l1l1111lI.push(I1l1ll111)):"W"==I1l11ll1I[1]?(I1l1ll111=l1l1l11I.getCoordinate("WM"),I1l1ll111.x-l1lllllI.x<0?(l1l1111lI.push({x:l1lllllI.x,y:l1lllllI.y+standardWidth}),l1l1111lI.push({x:I1l1ll111.x-1.5*standardWidth,y:l1lllllI.y+standardWidth}),l1l1111lI.push({x:I1l1ll111.x-1.5*standardWidth,y:I1l1ll111.y})):l1l1111lI.push({x:l1lllllI.x,y:I1l1ll111.y}),l1l1111lI.push(I1l1ll111)):(I1l1ll111=l1l1l11I.getCoordinate("NC"),I1l1ll111.x!=l1lllllI.x&&(l1l1111lI.push({x:l1lllllI.x,y:(l1lllllI.y+I1l1ll111.y)/2}),l1l1111lI.push({x:I1l1ll111.x,y:(l1lllllI.y+I1l1ll111.y)/2})),l1l1111lI.push(I1l1ll111))),l1l1111lI},isSamePoint=function(l1I111II,I1I1I11I){return Math.abs(l1I111II.x-I1I1I11I.x)<1&&Math.abs(l1I111II.y-I1I1I11I.y)<1?!0:!1},LineTypeEnum={poly:1,curve:2,linear:3},LinePortTypeEnum={multi:1,one:2},LineDrawTypeEnum={auto:1,center:2},calcPoints4drawPolyLine=function(I1l111ll){var I1l1l11l=[];if(0==I1l111ll.bendPoints.length){var I1I11II1l=I1l111ll.connectionDir[0]+""+I1l111ll.connectionDir[1];I1I11II1l=I1I11II1l.toUpperCase();var l1llllll=[];"EW"==I1I11II1l||"WE"==I1I11II1l?Math.abs(I1l111ll.fromPoint.y-I1l111ll.toPoint.y)<=.5?I1l1l11l=[]:(l1llllll.push({x:(I1l111ll.fromPoint.x+I1l111ll.toPoint.x)/2,y:I1l111ll.fromPoint.y}),l1llllll.push({x:(I1l111ll.fromPoint.x+I1l111ll.toPoint.x)/2,y:I1l111ll.toPoint.y}),I1l1l11l=l1llllll):("SN"==I1I11II1l||"NS"==I1I11II1l)&&(Math.abs(I1l111ll.fromPoint.y-I1l111ll.toPoint.y)<1?I1l1l11l=[]:(l1llllll.push({x:I1l111ll.fromPoint.x,y:(I1l111ll.fromPoint.y+I1l111ll.toPoint.y)/2}),l1llllll.push({x:I1l111ll.toPoint.x,y:(I1l111ll.fromPoint.y+I1l111ll.toPoint.y)/2}),I1l1l11l=l1llllll))}else if(1==I1l1l11l.length);else if(2==I1l111ll.bendPoints.length){var I1I11II1l=I1l111ll.connectionDir[0]+""+I1l111ll.connectionDir[1];I1I11II1l=I1I11II1l.toUpperCase();var l1llllll=[];"EW"==I1I11II1l||"WE"==I1I11II1l?Math.abs(I1l111ll.fromPoint.y-I1l111ll.toPoint.y)<1?I1l1l11l=[]:(l1llllll.push({x:(I1l111ll.bendPoints[0].x+I1l111ll.bendPoints[1].x)/2,y:I1l111ll.fromPoint.y}),l1llllll.push({x:(I1l111ll.bendPoints[0].x+I1l111ll.bendPoints[1].x)/2,y:I1l111ll.toPoint.y}),I1l1l11l=l1llllll):("SN"==I1I11II1l||"NS"==I1I11II1l)&&(Math.abs(I1l111ll.fromPoint.y-I1l111ll.toPoint.y)<1?I1l1l11l=[]:(l1llllll.push({x:I1l111ll.fromPoint.x,y:(I1l111ll.fromPoint.y+I1l111ll.toPoint.y)/2}),l1llllll.push({x:I1l111ll.toPoint.x,y:(I1l111ll.fromPoint.y+I1l111ll.toPoint.y)/2}),I1l1l11l=l1llllll))}else if(3==I1l111ll.bendPoints.length){var I1l1ll11I={x:(I1l111ll.fromPoint.x+I1l111ll.toPoint.x)/2,y:(I1l111ll.fromPoint.y+I1l111ll.toPoint.y)/2};if(I1l111ll.connectionDir){var l1llllll=[],I1I11II1l=I1l111ll.connectionDir[0]+""+I1l111ll.connectionDir[1];I1I11II1l=I1I11II1l.toUpperCase(),"EW"==I1I11II1l||"WE"==I1I11II1l?(l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.fromPoint.y}),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.toPoint.y}),I1l1l11l=l1llllll):"SN"==I1I11II1l||"NS"==I1I11II1l?(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l1ll11I.y}),l1llllll.push({x:I1l111ll.toPoint.x,y:I1l1ll11I.y}),I1l1l11l=l1llllll):"ES"==I1I11II1l||"SE"==I1I11II1l?(I1l111ll.fromPoint.x<I1l111ll.toPoint.x&&I1l111ll.fromPoint.y>I1l111ll.toPoint.y?l1llllll.push({x:I1l111ll.toPoint.x,y:I1l111ll.fromPoint.y}):l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l111ll.toPoint.y}),I1l1l11l=l1llllll):"SW"==I1I11II1l||"WS"==I1I11II1l?(I1l111ll.fromPoint.x<I1l111ll.toPoint.x&&I1l111ll.fromPoint.y<I1l111ll.toPoint.y?l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l111ll.toPoint.y}):l1llllll.push({x:I1l111ll.toPoint.x,y:I1l111ll.fromPoint.y}),I1l1l11l=l1llllll):"NW"==I1I11II1l||"WN"==I1I11II1l?(I1l111ll.fromPoint.x<I1l111ll.toPoint.x&&I1l111ll.fromPoint.y>I1l111ll.toPoint.y?l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l111ll.toPoint.y}):l1llllll.push({x:I1l111ll.toPoint.x,y:I1l111ll.fromPoint.y}),I1l1l11l=l1llllll):("EN"==I1I11II1l||"NE"==I1I11II1l)&&(I1l111ll.fromPoint.x<I1l111ll.toPoint.x&&I1l111ll.fromPoint.y<I1l111ll.toPoint.y?l1llllll.push({x:I1l111ll.toPoint.x,y:I1l111ll.fromPoint.y}):l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l111ll.toPoint.y}),I1l1l11l=l1llllll)}}else if(4==I1l111ll.bendPoints.length){var l1llllll=[],I1I11II1l=I1l111ll.connectionDir[0]+""+I1l111ll.connectionDir[1];I1I11II1l=I1I11II1l.toUpperCase(),"EE"==I1I11II1l?(I1l111ll.fromPoint.y>I1l111ll.toPoint.y?(l1llllll.push({x:I1l111ll.bendPoints[1].x,y:I1l111ll.fromPoint.y}),l1llllll.push({x:I1l111ll.bendPoints[1].x,y:I1l111ll.toPoint.y})):(l1llllll.push({x:I1l111ll.bendPoints[1].x,y:I1l111ll.fromPoint.y}),l1llllll.push({x:I1l111ll.bendPoints[1].x,y:I1l111ll.toPoint.y})),I1l1l11l=l1llllll):"NN"==I1I11II1l?(I1l111ll.fromPoint.x>I1l111ll.toPoint.x?(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l111ll.bendPoints[1].y}),l1llllll.push({x:I1l111ll.toPoint.x,y:I1l111ll.bendPoints[1].y})):(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l111ll.bendPoints[1].y}),l1llllll.push({x:I1l111ll.toPoint.x,y:I1l111ll.bendPoints[1].y})),I1l1l11l=l1llllll):"NS"==I1I11II1l||"SN"==I1I11II1l?(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l111ll.bendPoints[1].y}),l1llllll.push({x:I1l111ll.toPoint.x,y:I1l111ll.bendPoints[1].y}),I1l1l11l=l1llllll):("EW"==I1I11II1l||"WE"==I1I11II1l)&&(l1llllll.push({x:I1l111ll.bendPoints[1].x,y:I1l111ll.fromPoint.y}),l1llllll.push({x:I1l111ll.bendPoints[1].x,y:I1l111ll.toPoint.y}),I1l1l11l=l1llllll)}else if(5==I1l1l11l.length||5==I1l111ll.bendPoints.length){var I1l1ll11I=I1l111ll.bendPoints[2];if(I1l111ll.connectionDir){var l1llllll=[],I1I11II1l=I1l111ll.connectionDir[0]+""+I1l111ll.connectionDir[1];I1I11II1l=I1I11II1l.toUpperCase(),"WN"==I1I11II1l||"NW"==I1I11II1l?(I1l111ll.fromPoint.x>I1l111ll.toPoint.x&&I1l111ll.fromPoint.y<I1l111ll.toPoint.y?(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.toPoint.y})):(l1llllll.push({x:I1l111ll.toPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.fromPoint.y})),I1l1l11l=l1llllll):"WS"==I1I11II1l||"SW"==I1I11II1l?(I1l111ll.fromPoint.x>I1l111ll.toPoint.x&&I1l111ll.fromPoint.y>I1l111ll.toPoint.y?(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.toPoint.y})):(l1llllll.push({x:I1l111ll.toPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.fromPoint.y})),I1l1l11l=l1llllll):"ES"==I1I11II1l||"SE"==I1I11II1l?(I1l111ll.fromPoint.x<I1l111ll.toPoint.x&&I1l111ll.fromPoint.y>I1l111ll.toPoint.y?(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.toPoint.y})):(l1llllll.push({x:I1l111ll.toPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.fromPoint.y})),I1l1l11l=l1llllll):("EN"==I1I11II1l||"NE"==I1I11II1l)&&(I1l111ll.fromPoint.x<I1l111ll.toPoint.x&&I1l111ll.fromPoint.y<I1l111ll.toPoint.y?(l1llllll.push({x:I1l111ll.fromPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.toPoint.y})):(l1llllll.push({x:I1l111ll.toPoint.x,y:I1l1ll11I.y}),l1llllll.push(I1l1ll11I),l1llllll.push({x:I1l1ll11I.x,y:I1l111ll.fromPoint.y})),I1l1l11l=l1llllll)}}I1l111ll.points=I1l1l11l},calcPoints4Line=function(l1l111lI,l1l1l11I,I1l11ll1l,l1IIIIII){var l1l1ll11l=(l1l111lI.bendPoints,l1l111lI.connectionDir),l1I1111II=l1l1l11I[l1l1ll11l[0].toUpperCase()],l1III1II1=I1l11ll1l[l1l1ll11l[1].toUpperCase()],l1I1I1Il=l1l111lI.connectionId,I1111l11=l1IIIIII.lineType||1,I1I1111I=l1IIIIII.portType||1,l1II111Il=l1IIIIII.drawType||1;l1IIIIII.lineType=I1111l11,l1IIIIII.portType=I1I1111I,l1IIIIII.drawType=l1II111Il,l1l111lI.fromPoint=calcPointBy(l1I1I1Il,l1I1111II,l1l1ll11l[0].toUpperCase(),l1l1l11I,l1IIIIII),l1l111lI.toPoint=calcPointBy(l1I1I1Il,l1III1II1,l1l1ll11l[1].toUpperCase(),I1l11ll1l,l1IIIIII),l1IIIIII.lineType==LineTypeEnum.poly?calcPoints4drawPolyLine(l1l111lI):l1IIIIII.lineType==LineTypeEnum.curve||l1IIIIII.lineType==LineTypeEnum.linear},buildAllShapesAndConnections=function(I1I111Il,I1I1I111){var I1l11ll11=[];$(I1I111Il).each(function(){var I1l111l1=$(this).attr("id");I1l111l1.indexOf("-")>-1&&(I1l111l1=I1l111l1.split("-"),I1l111l1.splice(0,1),I1l111l1=I1l111l1.join("-"));
var l1l1l111=$(this).position(),l1l11ll11=$(this).attr("to-ids")||"";l1l11ll11=l1l11ll11?l1l11ll11.split(","):[];var l1lllll1=$(this).attr("targets-json")||"";l1lllll1||(l1lllll1="[]");var l1I1II111=[];$.each(l1l11ll11,function(I1I111II){l1I1II111.push({fromId:I1l111l1,toId:this.toString(),connectionId:oui.getUUIDLong(),toIdx:I1I111II})}),I1l11ll11=I1l11ll11.concat(l1I1II111),oui._shapeMap[I1l111l1]={id:I1l111l1,x:l1l1l111.left,y:l1l1l111.top,w:$(this).outerWidth(),h:$(this).outerHeight(),W:[],E:[],N:[],S:[],connections:l1I1II111,toIds:l1l11ll11,targetsJson:l1lllll1,getCoordinate:getCoordinate,inRect:inRect,getWidth:function(){return this.w},getHeight:function(){return this.h}}}),$.each(I1l11ll11,function(){connectShape4flow(this)}),$.each(I1l11ll11,function(I1I111I1){var l1I1I11I=this,I1I11II1l=l1I1I11I.fromId,I1lllllI=l1I1I11I.toId,I1l1ll111=oui._shapeMap[I1I11II1l],l1I1111II=oui._shapeMap[I1lllllI];if(I1l1ll111&&l1I1111II){calcPoints4Line(l1I1I11I,I1l1ll111,l1I1111II,I1I1I111),I1I1I111=I1I1I111||{};var I1lll1lll=$.extend(!0,{},I1I1I111,{fromShapeId:I1l1ll111.id,toShapeId:l1I1111II.id,points:l1I1I11I.points}),l1I1I1II=I1lll1lll.getLineHtml||function(l1l111ll,l1I1I11I,l1I11II1I){var I1IIIIII=(l1l111ll.toIds,l1l111ll.targetsJson);I1IIIIII=oui.parseJson(I1IIIIII);var l1l1ll111=I1IIIIII[l1I11II1I]||{},l1l1111ll=l1l1ll111.lineText||"";return l1l1111ll},I1111l1I=I1lll1lll.findHasFromArrow||function(I1l111l1,I1l1l11l,I1I11II1I){var l1lllll1=(I1l111l1.toIds,I1l111l1.targetsJson);l1lllll1=oui.parseJson(l1lllll1);var l1I1II11l=l1lllll1[I1I11II1I]||{},l1I1111I1=l1I1II11l.hasFromArrow||!1;return l1I1111I1},I1I11111=I1lll1lll.findHasArrow||function(I1l111ll,I1l1l111,l1I11II1l){var l1llllll=(I1l111ll.toIds,I1l111ll.targetsJson);l1llllll=oui.parseJson(l1llllll);var I1l1ll111=l1llllll[l1I11II1l]||{},I1l1111l1=I1l1ll111.hasArrow||!1;return I1l1111l1};I1lll1lll.html=l1I1I1II(I1l1ll111,l1I1111II,l1I1I11I.toIdx),I1lll1lll.hasFromArrow=I1111l1I(I1l1ll111,l1I1111II,l1I1I11I.toIdx)||I1lll1lll.hasFromArrow,I1lll1lll.hasArrow=I1I11111(I1l1ll111,l1I1111II,l1I1I11I.toIdx)||I1lll1lll.hasArrow;var I1ll111l1=I1lll1lll.cls||"";I1ll111l1=I1ll111l1.split(" "),I1lll1lll.hasFromArrow&&I1ll111l1.indexOf("pull")<0&&I1ll111l1.push("pull"),I1lll1lll.hasArrow&&I1ll111l1.indexOf("push")<0&&I1ll111l1.push("push"),I1lll1lll.cls=I1ll111l1.join(" "),oui.buildLineWithPoints(l1I1I11I.fromPoint,l1I1I11I.toPoint,I1lll1lll)}})},calcPointBy=function(l1I111I1,I1I1I11I,I1I11II1I,l1IIIII1,l1I1II11l){for(var l1l1111ll=-1,l1lll1lll=I1I1I11I.length,l1l1l1l1=0;l1lll1lll>l1l1l1l1;l1l1l1l1++)if(I1I1I11I[l1l1l1l1].connectionId==l1I111I1){l1l1111ll=l1l1l1l1;break}if(0>l1l1l1l1)return null;var I1111l1I=0,I1I11111=0;switch(I1111l1I=l1IIIII1.x,I1I11111=l1IIIII1.y,I1I11II1I){case"N":I1111l1I+=l1I1II11l.portType==LinePortTypeEnum.one?l1IIIII1.w/2:l1IIIII1.w>l1lll1lll?l1IIIII1.w*(l1l1111ll+1)/(l1lll1lll+1):(l1l1111ll+1)%(l1lll1lll+1);break;case"W":I1I11111+=l1I1II11l.portType==LinePortTypeEnum.one?l1IIIII1.h/2:l1IIIII1.h>l1lll1lll?l1IIIII1.h*(l1l1111ll+1)/(l1lll1lll+1):(l1l1111ll+1)%(l1lll1lll+1);break;case"E":I1111l1I+=l1IIIII1.w,I1I11111+=l1I1II11l.portType==LinePortTypeEnum.one?l1IIIII1.h/2:l1IIIII1.h>l1lll1lll?l1IIIII1.h*(l1l1111ll+1)/(l1lll1lll+1):(l1l1111ll+1)%(l1lll1lll+1);break;case"S":I1I11111+=l1IIIII1.h,I1111l1I+=l1I1II11l.portType==LinePortTypeEnum.one?l1IIIII1.w/2:l1IIIII1.w>l1lll1lll?l1IIIII1.w*(l1l1111ll+1)/(l1lll1lll+1):(l1l1111ll+1)%(l1lll1lll+1)}return{x:I1111l1I,y:I1I11111}},sortPos=function(I1l111lI,l1l1l11I,I1I11II1I){"E"==I1I11II1I||"W"==I1I11II1I?l1l1l11I.sort(function(l1l111l1,I1l1l11l){var I1I11II11,I1IIIIII;return I1I11II11=I1l111lI==l1l111l1.fromId?oui._shapeMap[l1l111l1.toId]:oui._shapeMap[l1l111l1.fromId],I1IIIIII=I1l111lI==I1l1l11l.fromId?oui._shapeMap[I1l1l11l.toId]:oui._shapeMap[I1l1l11l.fromId],I1I11II11.y-I1IIIIII.y}):l1l1l11I.sort(function(l1I111Il,I1l1l111){var l1l11ll11,I1llllll;return l1l11ll11=I1l111lI==l1I111Il.fromId?oui._shapeMap[l1I111Il.toId]:oui._shapeMap[l1I111Il.fromId],I1llllll=I1l111lI==I1l1l111.fromId?oui._shapeMap[I1l1l111.toId]:oui._shapeMap[I1l1l111.fromId],l1l11ll11.x-I1llllll.x})},connectShape4flow=function(l1l111lI){var I1l1l11l=l1l111lI.fromId,l1I11II1l=l1l111lI.toId,l1lllll1=oui._shapeMap[I1l1l11l],I1l1ll11I=oui._shapeMap[l1I11II1l];if(I1l1ll11I&&l1lllll1){var l1I1111Il=getConnectionDirection(l1lllll1,I1l1ll11I),l1III1II1=calcBendPoints(l1lllll1,I1l1ll11I,l1I1111Il);l1l111lI.bendPoints=l1III1II1,l1l111lI.connectionDir=l1I1111Il,l1lllll1[l1I1111Il[0].toUpperCase()].push(l1l111lI),I1l1ll11I[l1I1111Il[1].toUpperCase()].push(l1l111lI),sortPos(l1lllll1.id,l1lllll1[l1I1111Il[0].toUpperCase()],l1I1111Il[0]),sortPos(I1l1ll11I.id,I1l1ll11I[l1I1111Il[1].toUpperCase()],l1I1111Il[1])}},buildShapeLines=function(I1I111II,l1l1l11I){oui.clearShapeMap(),buildAllShapesAndConnections(I1I111II||".oui-shape",l1l1l11I)},countDistance=function(l1l111l1,I1I1I11I){var l1I11II1I=l1l111l1.x-I1I1I11I.x,I1IIIIII=l1l111l1.y-I1I1I11I.y,I1l1ll11I=Math.sqrt(l1I11II1I*l1I11II1I+I1IIIIII*I1IIIIII);return I1l1ll11I},getCenterPointInfo=function(l1I111Il,l1I1I111,I1I11II1l){if(!I1I11II1l||!I1I11II1l.length){var I1llllll=countDistance(l1I111Il,l1I1I111);return{currDis:I1llllll,from:l1I111Il,to:l1I1I111,x:(l1I111Il.x+l1I1I111.x)/2,y:(l1I111Il.y+l1I1I111.y)/2,centerDistance:I1llllll/2,distance:I1llllll}}var I1l1ll111=[],l1I1111I1=0,I1lll1ll1=countDistance(l1I111Il,I1I11II1l[0]);l1I1111I1+=I1lll1ll1,I1l1ll111.push({currDis:I1lll1ll1,from:l1I111Il,to:I1I11II1l[0],distance:l1I1111I1});for(var l1l1l1ll=1,l1111l1l=I1I11II1l.length;l1111l1l>l1l1l1ll;l1l1l1ll++){var l1l1111l=countDistance(I1I11II1l[l1l1l1ll-1],I1I11II1l[l1l1l1ll]);l1I1111I1+=l1l1111l,I1l1ll111.push({currDis:l1l1111l,from:I1I11II1l[l1l1l1ll-1],to:I1I11II1l[l1l1l1ll],distance:l1I1111I1})}var I1II111Il=countDistance(I1I11II1l[I1I11II1l.length-1],l1I1I111);l1I1111I1+=I1II111Il,I1l1ll111.push({currDis:I1II111Il,from:I1I11II1l[I1I11II1l.length-1],to:l1I1I111,distance:l1I1111I1});for(var l1ll1lll1,l1l1l1ll=0,I11l1lll=l1I1111I1/2,l1111l1l=I1l1ll111.length;l1111l1l>l1l1l1ll;l1l1l1ll++)if(I1l1ll111[l1l1l1ll].distance>=I11l1lll){l1ll1lll1=I1l1ll111[l1l1l1ll],l1ll1lll1.centerDistance=l1ll1lll1.currDis+I11l1lll-l1ll1lll1.distance;var l111l11l={};try{l111l11l=getPosOnline(I1l1ll111[l1l1l1ll].from,I1l1ll111[l1l1l1ll].to,l1ll1lll1.centerDistance)}catch(I1IIII11){l111l11l={x:0,top:0}}l1ll1lll1.x=l111l11l.x,l1ll1lll1.y=l111l11l.y;break}return l1ll1lll1};oui.buildLineWithPoints=buildLineWithPoints,oui.buildLine=buildLine,oui.buildShapeLines=buildShapeLines,oui.buildShape=GraphBiz.renderBy,oui.getPoints4circle=getPoints4circle}(window);








