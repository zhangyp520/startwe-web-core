/*! 2021-04-23 */

!function(l111ll11lI,l1lll111lI){var l1II1I1I1l={button:{name:"button"},container:{name:"container"},table:{name:"tableLine"},customTable:{name:"customTable"},detail:{name:"detail"},selectArea:{name:"selectArea"},image:{name:"image"},qrcode:{name:"qrcode"},barcode:{name:"barcode"},label:{name:"label"},textInput:{name:"textInput"},selectInput:{name:"selectInput"},repeatSelect:{name:"repeatSelect"},read:{name:"read"},other:{name:"other"}},l1l1l111l1={printForm:{name:"printForm"},normalForm:{name:"normalForm"},tableForm:{name:"normalForm"},absoluteForm:{name:"absoluteForm"}};l1l1l111l1.findEnum=function(I111ll11I1){for(var I1lll111l1 in l1l1l111l1)if(l1l1l111l1[I1lll111l1]&&l1l1l111l1[I1lll111l1].name==I111ll11I1)return l1l1l111l1[I1lll111l1];return null};var I11I1111II={style:{backgroundImageName:"",backgroundImage:"",backgroundImageFillType:"center",backgroundColor:"",width:110,height:200,paperType:"A4",theme:"",cellType:"px",fontFamily:"",currControlZIndex:0},innerStyle:{style:{fontFamily:"",width:230,height:42,backgroundColor:"",borderRadius:0,opacity:1,zIndex:0,layoutType:"oneLine",borderLeftWidth:0,borderTopWidth:0,borderBottomWidth:0,borderRightWidth:0,borderLeftColor:"#e6e6e6",borderTopColor:"#e6e6e6",borderBottomColor:"#e6e6e6",borderRightColor:"#e6e6e6",borderLeftStyle:"solid",borderTopStyle:"solid",borderBottomStyle:"solid",borderRightStyle:"solid"},styleTitle:{fontFamily:"",color:"#333333",lineHeight:1.6,backgroundColor:"",fontSize:14,fontWeight:"normal",textAlign:"left",verticalAlign:"middle",whiteSpace:"normal"},styleFieldOuter:{},styleInnerOuter:{verticalAlign:"middle"},styleField:{fontFamily:"",color:"#333333",backgroundColor:"",lineHeight:1.6,fontSize:14,fontWeight:"normal",textAlign:"left",borderLeftWidth:1,borderTopWidth:1,borderBottomWidth:1,borderRightWidth:1,borderLeftColor:"#e6e6e6",borderTopColor:"#e6e6e6",borderBottomColor:"#e6e6e6",borderRightColor:"#e6e6e6",borderLeftStyle:"solid",borderTopStyle:"solid",borderBottomStyle:"solid",borderRightStyle:"solid",whiteSpace:"normal"}}};l1l1l111l1.printForm.PageGlobalStyles={style:{},innerStyle:{style:{},styleTitle:{textAlign:"right"},styleFieldOuter:{},styleInnerOuter:{verticalAlign:"middle"},styleField:{borderLeftWidth:0,borderTopWidth:0,borderBottomWidth:0,borderRightWidth:0}}};"width,height,position,left,top,display,float,background-color,background-image,border-radius,border-left-style,border-top-style,border-right-style,border-bottom-style,border-left-color,border-top-color,border-right-color,border-bottom-color,border-left-width,border-top-width,border-right-width,border-bottom-width,padding-left,padding-top,padding-right,padding-bottom,text-align,vertical-align,color,font-size,font-weight,font-family,font-style,box-shadow".split(",");var l1lll1l1I1={lineAttrToHump:function(I111II11l1){for(var I1III11111=[],l1II1I1III=I111II11l1.split("-"),l1I1I11111=0,I11l111111=l1II1I1III.length;l1I1I11111<I11l111111;l1I1I11111++)0==l1I1I11111?I1III11111.push(l1II1I1III[l1I1I11111].toLowerCase()):(I1III11111.push(l1II1I1III[l1I1I11111].substring(0,1).toUpperCase()),I1III11111.push(l1II1I1III[l1I1I11111].substring(1).toLowerCase()));return I1III11111.join("")},humpTolineAttr:function(l111II11II){for(var l1III111II=[],I1ll1l1lI1=0,l1l1l1111l=l111II11II.length;I1ll1l1lI1<l1l1l1111l;I1ll1l1lI1++){var l11l1111l1=l111II11II.charAt(I1ll1l1lI1);l11l1111l1>="A"&&l11l1111l1<="Z"?l1III111II.push("-"+l11l1111l1.toLowerCase()):l1III111II.push(l11l1111l1)}return l1III111II.join("")},transHumpKeyObject2LineKeyObject:function(l111ll11Il){var I1lll11111={};for(var I1II1I1IIl in l111ll11Il)I1lll11111[l1lll1l1I1.humpTolineAttr(I1II1I1IIl)]=l111ll11Il[I1II1I1IIl];return I1lll11111},transLineKeyObject2HumpKeyObject:function(l111ll11Il){var I1lll111Il={};for(var I1ll1l1lI1 in l111ll11Il)I1lll111Il[l1lll1l1I1.lineAttrToHump(I1ll1l1lI1)]=l111ll11Il[I1ll1l1lI1];return I1lll111Il}},l1lll11llI={package:"com.oui.absolute",class:"AbsoluteDesign",pageCls:"page-pabs",pageDomAttrPrefix:"page-pabs-",controlDomAttrPrefix:"control-pabs-",controlIdPrefix:"ctrl_",runTemplateType:"js",startTemplateTag:"{{",endTemplateTag:"}}",data:{},activeTab:0,currAccordingActiveId:"",tableLinesMap:null,tableLineMaxRect:null,operationAreaOffset:2,states:"init,down2selectPage,down2selectField,drag2newField,draggingField,dragEndField,cloneField".split(","),styleStringKeys:"backgroundImage,backgroundColor,backgroundRepeat,backgroundSize,display,verticalAlign,borderLeftColor,borderTopColor,borderBottomColor,borderRightColor,borderLeftStyle,borderTopStyle,borderBottomStyle,borderRightStyle,color,fontFamily,fontWeight,transform,textAlign,whiteSpace".split(","),defaultColumnSize:3,defaultRowSize:3,hasChange:!1,getUtils:function(){return l1lll1l1I1},findControlUrl:function(I111II11Il){return I111II11Il&&I111II11Il.otherAttrs.useRelation?"res_common/oui/ui/ui_pc/components/association.vue.html":I111II11Il?"res_common/oui/ui/ui_pc/components/"+I111II11Il.controlType+".vue.html":void 0},trimTplMap:{},trimTpl:function(I111II11ll,l1II1I1I1l){this.trimTplMap[I111II11ll]||(this.trimTplMap[I111II11ll]=template.compile(l1lll111lI.trim(document.getElementById(I111II11ll).innerHTML)));var I1I1I1111l=this.trimTplMap[I111II11ll](l1II1I1I1l);return l1lll111lI.trim(I1I1I1111l)},init:function(){var I111ll11Il=this;template.helper("AbsoluteDesign",this),template.helper("oui",oui);var I1III111ll=Element.prototype.getBoundingClientRect;Element.prototype._getBoundingClientRect=I1III111ll,Element.prototype.getBoundingClientRect=function(){var l111II11Il={};try{l111II11Il=this._getBoundingClientRect()}catch(I111ll1111){l111II11Il={}}return l111II11Il},I111ll11Il.clientType4Design=oui.getParam("clientType")||"pc",l1lll111lI(".design-container").addClass("ab-design-clientType-"+I111ll11Il.clientType4Design),I111ll11Il.PageDesignTypeEnum=l1l1l111l1,I111ll11Il.ControlTypeEnum=l1II1I1I1l,oui.loadApiConfig(oui.getContextPath()+"res_engine/ppt_design/pc/js/api-config.json","oui.biz",function(){I111ll11Il.initByUrlParams(function(){var I111II11II=oui.getParam();I111ll11Il.loadPageDesignUrl=oui.pptAjaxConfig.loadPageByPageIdUrl,I111ll11Il.loadPagesList(function(){var I111II11l1=I111ll11Il.pageId,l1III111l1=I111II11II.loadPageDesignUrl||I111ll11Il.loadPageDesignUrl;I111II11l1?oui.ajaxPost(l1III111l1,{PageId:I111II11l1},function(I111II11ll){if("null"==I111II11ll.PageData&&(I111II11ll.PageData={}),I111ll11Il.data=oui.parseJson(I111II11ll.PageData||"{}"),"string"==typeof I111ll11Il.data.controls&&(I111ll11Il.data.controls=oui.parseJson(I111ll11Il.data.controls)),"string"==typeof I111ll11Il.data.style&&(I111ll11Il.data.style=oui.parseJson(I111ll11Il.data.style)),"string"==typeof I111ll11Il.data.innerStyle&&(I111ll11Il.data.innerStyle=oui.parseJson(I111ll11Il.data.innerStyle)),"string"==typeof I111ll11Il.data.otherAttrs&&(I111ll11Il.data.otherAttrs=oui.parseJson(I111ll11Il.data.otherAttrs)),"string"==typeof I111ll11Il.data.events&&(I111ll11Il.data.events=oui.parseJson(I111ll11Il.data.events)),I111ll11Il.data.style||(I111ll11Il.data.style={}),I111ll11Il.data.style.width=I111ll11Il.width||I111ll11Il.data.style.width,I111ll11Il.data.style.height=I111ll11Il.height||I111ll11Il.data.style.height,I111ll11Il.data.style.width>1080){var l1III11111=1080,I1ll1l1lIl=(1080*I111ll11Il.data.style.height/I111ll11Il.data.style.width).toFixed(2);I111ll11Il.data.style.width=l1III11111,I111ll11Il.data.style.height=I1ll1l1lIl}if(I111ll11Il.data.style.height>750){var I1ll1l1lIl=750,l1III11111=(750*I111ll11Il.data.style.width/I111ll11Il.data.style.height).toFixed(2);I111ll11Il.data.style.width=l1III11111,I111ll11Il.data.style.height=I1ll1l1lIl}I111ll11Il.data.style.cellType="px",I111ll11Il.transPage4Front(I111ll11Il.data),I111ll11Il.init4parse()},function(l111ll11lI){},"加载中..."):(I111ll11Il.data={},"string"==typeof I111ll11Il.data.controls&&(I111ll11Il.data.controls=oui.parseJson(I111ll11Il.data.controls)),"string"==typeof I111ll11Il.data.style&&(I111ll11Il.data.style=oui.parseJson(I111ll11Il.data.style)),"string"==typeof I111ll11Il.data.innerStyle&&(I111ll11Il.data.innerStyle=oui.parseJson(I111ll11Il.data.innerStyle)),"string"==typeof I111ll11Il.data.otherAttrs&&(I111ll11Il.data.otherAttrs=oui.parseJson(I111ll11Il.data.otherAttrs)),"string"==typeof I111ll11Il.data.events&&(I111ll11Il.data.events=oui.parseJson(I111ll11Il.data.events)),I111ll11Il.transPage4Front(I111ll11Il.data),I111ll11Il.init4parse())})})})},loadPagesList:function(l111II111I){var I1lll111I1=this,I1II1I1III=oui.pptAjaxConfig.findPagesByPptIdUrl,l1I1I1111I=oui.getParam("pptId"),I11l11111I=oui.getParam("pageId")||"";oui.ajaxPost(I1II1I1III,{TranslateId:l1I1I1111I},function(I111II111l){var l1lll111Il=I111II111l.Pages||[];I11l11111I||(I11l11111I=l1lll111Il.length?l1lll111Il[0].PageId+"":"");var l1II1I1Il1=I111II111l.Width,l1l1l11111=I111II111l.Height;I1lll111I1.sourceWidth=l1II1I1Il1,I1lll111I1.sourceHeight=l1l1l11111,I1lll111I1.width=l1II1I1Il1,I1lll111I1.height=l1l1l11111;var I11I1111ll=oui.getParam("width"),l1lll1l1l1=oui.getParam("height");I11I1111ll&&l1lll1l1l1&&(I11I1111ll=parseFloat(I11I1111ll),l1lll1l1l1=parseFloat(l1lll1l1l1),I1lll111I1.width=I11I1111ll,I1lll111I1.height=l1lll1l1l1),I1lll111I1.pptName=I111II111l.TranslateName,I1lll111I1.pptId=l1I1I1111I,I1lll111I1.pageId=I11l11111I,I1lll111I1.pageList=l1lll111Il,l111II111I&&l111II111I()},function(l111ll11I1){})},transPage4Front:function(l111ll11II){var I1III111lI=l111ll11II.controls||[],l1II1I1II1=l111ll11II.style||{},I1I1I1111I=l111ll11II.innerStyle||{};this.transPropValue("width",l1II1I1II1),this.transPropValue("width4px",l1II1I1II1),this.transPropValue("height",l1II1I1II1),this.transPropValue("height4px",l1II1I1II1),this.transPropValue("style.width",I1I1I1111I),this.transPropValue("style.height",I1I1I1111I),this.transPropValue("style.opacity",I1I1I1111I),this.transPropValue("style.zIndex",I1I1I1111I),this.transPropValue("style.borderBottomWidth",I1I1I1111I),this.transPropValue("style.borderLeftWidth",I1I1I1111I),this.transPropValue("style.borderRightWidth",I1I1I1111I),this.transPropValue("style.borderTopWidth",I1I1I1111I),this.transPropValue("styleField.lineHeight",I1I1I1111I),this.transPropValue("styleField.fontSize",I1I1I1111I),this.transPropValue("styleField.borderBottomWidth",I1I1I1111I),this.transPropValue("styleField.borderLeftWidth",I1I1I1111I),this.transPropValue("styleField.borderRightWidth",I1I1I1111I),this.transPropValue("styleField.borderTopWidth",I1I1I1111I),this.transPropValue("styleTitle.lineHeight",I1I1I1111I),this.transPropValue("styleTitle.fontSize",I1I1I1111I);var l11I1111lI=this;return oui.eachArray(I1III111lI,function(l111ll11I1){"textButton"==l111ll11I1.controlType&&(l111ll11I1.controlType="textbutton"),l11I1111lI.transPropValue("style.width",l111ll11I1),l11I1111lI.transPropValue("style.height",l111ll11I1),l11I1111lI.transPropValue("style.left",l111ll11I1),l11I1111lI.transPropValue("style.top",l111ll11I1),l11I1111lI.transPropValue("style.lineHeight",l111ll11I1),l11I1111lI.transPropValue("style.opacity",l111ll11I1),l11I1111lI.transPropValue("style.columnSize",l111ll11I1),l11I1111lI.transPropValue("style.rowSize",l111ll11I1),l11I1111lI.transPropValue("style.zIndex",l111ll11I1),l11I1111lI.transPropValue("style.borderBottomWidth",l111ll11I1),l11I1111lI.transPropValue("style.borderLeftWidth",l111ll11I1),l11I1111lI.transPropValue("style.borderRightWidth",l111ll11I1),l11I1111lI.transPropValue("style.borderTopWidth",l111ll11I1),l11I1111lI.transPropValue("style.borderRadius",l111ll11I1),l11I1111lI.transPropValue("style.rect.top",l111ll11I1),l11I1111lI.transPropValue("style.rect.bottom",l111ll11I1),l11I1111lI.transPropValue("style.rect.left",l111ll11I1),l11I1111lI.transPropValue("style.rect.right",l111ll11I1),l11I1111lI.transPropValue("style.rect.columnIndex",l111ll11I1),l11I1111lI.transPropValue("style.rect.rowIndex",l111ll11I1);var I1lll1111l=l111ll11I1.style.cellsMap;for(var l1II1I1IlI in I1lll1111l)l11I1111lI.transPropValue("top",I1lll1111l[l1II1I1IlI]),l11I1111lI.transPropValue("bottom",I1lll1111l[l1II1I1IlI]),l11I1111lI.transPropValue("left",I1lll1111l[l1II1I1IlI]),l11I1111lI.transPropValue("right",I1lll1111l[l1II1I1IlI]),l11I1111lI.transPropValue("columnIndex",I1lll1111l[l1II1I1IlI]),l11I1111lI.transPropValue("rowIndex",I1lll1111l[l1II1I1IlI]);oui.eachArray(l111ll11I1.style.columnLines||[],function(I111ll111I){l11I1111lI.transPropValue("config.lineHeight",I111ll111I),l11I1111lI.transPropValue("fromPos.left",I111ll111I),l11I1111lI.transPropValue("fromPos.top",I111ll111I),l11I1111lI.transPropValue("toPos.left",I111ll111I),l11I1111lI.transPropValue("toPos.top",I111ll111I)}),oui.eachArray(l111ll11I1.style.rowLines||[],function(I111ll11lI){l11I1111lI.transPropValue("config.lineHeight",I111ll11lI),l11I1111lI.transPropValue("fromPos.left",I111ll11lI),l11I1111lI.transPropValue("fromPos.top",I111ll11lI),l11I1111lI.transPropValue("toPos.left",I111ll11lI),l11I1111lI.transPropValue("toPos.top",I111ll11lI)}),l11I1111lI.transPropValue("innerStyle.styleField.lineHeight",l111ll11I1),l11I1111lI.transPropValue("innerStyle.styleField.fontSize",l111ll11I1),l11I1111lI.transPropValue("innerStyle.styleField.borderBottomWidth",l111ll11I1),l11I1111lI.transPropValue("innerStyle.styleField.borderLeftWidth",l111ll11I1),l11I1111lI.transPropValue("innerStyle.styleField.borderRightWidth",l111ll11I1),l11I1111lI.transPropValue("innerStyle.styleField.borderTopWidth",l111ll11I1),l11I1111lI.transPropValue("innerStyle.styleTitle.lineHeight",l111ll11I1),l11I1111lI.transPropValue("innerStyle.styleTitle.fontSize",l111ll11I1)}),l111ll11II},transPropValue:function(l111II11II,I1III111l1){if("object"==typeof I1III111l1){var l1ll1l1lll=oui.JsonPathUtil.getJsonByPath(l111II11II,I1III111l1);"string"==typeof l1ll1l1lll&&l1ll1l1lll&&oui.JsonPathUtil.setObjByPath(l111II11II,I1III111l1,parseFloat(l1ll1l1lll),!0)}},getActiveCls:function(I111ll11I1){return this.clientType4Design==I111ll11I1?"active":""},init4parse:function(){var I111II11lI=this;I111II11lI.initBefore(),oui.parse({callback:function(I111II11I1){(oui.browser.ie||oui.browser.isEdge)&&oui.getById("absoluteProps").attr("useVDom",!1),I111II11lI.bindEvents(),I111II11lI.initEnd()}})},getContextPath:function(){return oui.getContextPath()},findControlLayoutType:function(I111ll11lI){var I1III111I1=I111ll11lI.style.layoutType;return I111ll11lI.detailId&&(I1III111I1=this.inDetailEndRow(I111ll11lI)?"hideTitle":"onlyTitle"),I1III111I1},findFieldStyle4Dom:function(I111ll11lI,l1III111lI){var I1II1I1IIl=this.findStyleString(I111ll11lI.innerStyle&&I111ll11lI.innerStyle.styleField,"control-style-tpl",l1III111lI);return I111ll11lI.innerStyle&&I111ll11lI.innerStyle.styleField&&(I111ll11lI.innerStyle.styleFieldString=I1II1I1IIl),I1II1I1IIl},findStyleFieldOuter4Dom:function(l111ll11ll,l1lll1111I){var l1ll1l1lll=this,l1I1I111l1="";return l111ll11ll.innerStyle&&l111ll11ll.innerStyle.styleFieldOuter&&(l1I1I111l1=l1ll1l1lll.findStyleString(l111ll11ll.innerStyle&&l111ll11ll.innerStyle.styleFieldOuter,"control-style-tpl",l1lll1111I),l111ll11ll.innerStyle&&l111ll11ll.innerStyle.styleInnerOuter&&l111ll11ll.innerStyle.styleInnerOuter.verticalAlign&&l111ll11ll.innerStyle.styleInnerOuter.verticalAlign,l111ll11ll.innerStyle&&l111ll11ll.innerStyle.styleFieldOuter&&l111ll11ll.innerStyle.styleFieldOuter.textAlign&&l111ll11ll.innerStyle.styleFieldOuter.textAlign,l111ll11ll.innerStyle.styleFieldOuterString=l1I1I111l1),l1I1I111l1},findControlStyle4Dom:function(l111II11l1,I1lll1111I){var l1II1I1II1=this,I1l1l111I1="";return l111II11l1.style&&(I1l1l111I1=l1II1I1II1.findStyleString(l111II11l1.style,"control-style-tpl",I1lll1111I),l111II11l1.styleString=I1l1l111I1),I1l1l111I1},findControlStyle4DomDesign:function(I111ll111l,I1III111l1){var l1ll1l1l1l=this,l1I1I1111l="";return I111ll111l.style&&(l1I1I1111l=l1ll1l1l1l.findStyleString(I111ll111l.style,"control-style-tpl",I1III111l1),I111ll111l.styleString=l1I1I1111l,l1I1I1111l=l1ll1l1l1l.findStyleString(I111ll111l.style,"control-style-tpl",I1III111l1,!0)),l1I1I1111l},findControlStyleBorder4Dom:function(I111ll11I1,I1lll111I1){var l1ll1l1l11=this,l1l1l111I1="";return I111ll11I1.style&&(l1l1l111I1=l1ll1l1l11.findStyleString(I111ll11I1.style,"border-style-tpl",I1lll111I1),I111ll11I1.styleBorderString=l1l1l111I1),l1l1l111I1},findControlStyleInnerOuter4Dom:function(l111II11ll,I1III111Il){var I1ll1l1ll1="";return l111II11ll.innerStyle&&l111II11ll.innerStyle.styleInnerOuter&&(I1ll1l1ll1=this.findStyleString(l111II11ll.innerStyle.styleInnerOuter,"control-style-tpl",I1III111Il),l111II11ll.innerStyle.styleInnerOuterString=I1ll1l1ll1),I1ll1l1ll1},findControlInnerStyleTitle4Dom:function(I111II1111,I1III11111){var I1II1I1IlI="";return I111II1111.innerStyle&&I111II1111.innerStyle.styleTitle&&(I1II1I1IlI=this.findStyleString(I111II1111.innerStyle&&I111II1111.innerStyle.styleTitle,"control-style-tpl",I1III11111),I111II1111.innerStyle.styleTitleString=I1II1I1IlI),I1II1I1IlI},updateParamCfgSource:function(l111ll11l1){var I1III1111I=oui.getParam();if(I1III1111I.ouiInWindowDialog&&I1III1111I.ouiInWindowDialog+""=="true"){var l1II1I1I1I=I1III1111I.windowId;if(!window.opener||!window.opener._openMap||!window.opener._openMap[l1II1I1I1I])return void oui.getTop().oui.alert("调用页面设计器入口页面已经刷新或者关闭，请尝试关闭当前页面后，重新打开");l111ll11l1.viewType="openWindow",window.opener._openMap[l1II1I1I1I].params=oui.parseString(l111ll11l1)}else if(I1III1111I.ouiInDialog&&I1III1111I.ouiInDialog+""=="true")l111ll11l1.viewType="urlDialog",oui.getCurrUrlDialog().attr("params",oui.parseString(l111ll11l1));else{var l1I1I111lI=oui.getParam("param");l1I1I111lI&&window.parent[l1I1I111lI]&&(window.parent[l1I1I111lI]=oui.parseString(l111ll11l1))}},close:function(){var l111ll1111=oui.getParam();if(l111ll1111.ouiInWindowDialog&&l111ll1111.ouiInWindowDialog+""=="true"){var I1III111Il=l111ll1111.windowId;if(!window.opener||!window.opener._openMap||!window.opener._openMap[I1III111Il])return void window.close();try{window.opener._openMap[I1III111Il].params&&(window.opener._openMap[I1III111Il].params=null,delete window.opener._openMap[I1III111Il].params),window.close()}catch(l111II11I1){}}else if(l111ll1111.ouiInDialog&&l111ll1111.ouiInDialog+""=="true"){var l1II1I1II1=oui.getCurrUrlDialog();l1II1I1II1&&l1II1I1II1.hide()}else try{window.close()}catch(l111ll11l1){}},initByUrlParams:function(I111II111I){var l1lll111ll=this,I1II1I1Il1=oui.getParam(),I1l1l11111={},l11I1111lI=I1II1I1Il1.viewType;if(I1II1I1Il1.ouiInWindowDialog&&I1II1I1Il1.ouiInWindowDialog+""=="true"&&!l11I1111lI){var l1lll1l1I1=I1II1I1Il1.windowId;if(!window.opener||!window.opener._openMap||!window.opener._openMap[l1lll1l1I1])return void oui.getTop().oui.alert("调用页面设计器入口页面已经刷新或者关闭，请尝试关闭当前页面后，重新打开");window.opener._openMap[l1lll1l1I1].params&&(I1l1l11111=oui.parseJson(window.opener._openMap[l1lll1l1I1].params)),I1l1l11111.viewType="openWindow"}else if(I1II1I1Il1.ouiInDialog&&I1II1I1Il1.ouiInDialog+""=="true"&&!l11I1111lI){var I1III11IlI=oui.getCurrUrlDialog();(I1l1l11111=oui.parseJson(I1III11IlI.attr("params"))).viewType="urlDialog"}else{var l111111I1I=oui.getParam("param");l111111I1I&&window.parent[l111111I1I]?I1l1l11111=oui.parseJson(window.parent[l111111I1I]):(I1l1l11111.isDefault=!I1II1I1Il1.isDefault||"false"!=I1II1I1Il1.isDefault,I1l1l11111.buttons=I1II1I1Il1.buttons||"preview,save,selectBoxArea,merge,split,insertColumn4prev,insertRow4prev,removeColumn,removeRow",I1l1l11111.pageBizPropsUrl=I1II1I1Il1.pageBizPropsUrl||"",I1l1l11111.controlBizPropsUrl=I1II1I1Il1.controlBizPropsUrl||"",I1l1l11111.saveCallBack=I1II1I1Il1.saveCallBack||"",I1l1l11111.page={pageDesignType:"absoluteForm"},I1l1l11111.bizJs=I1II1I1Il1.bizJs||""),I1l1l11111.viewType="normal"}I1l1l11111.callbackMethods||(I1l1l11111.callbackMethods={}),I1l1l11111.saveCallBack&&(I1l1l11111.callbackMethods.saveCallbackMethod=I1l1l11111.saveCallBack),l1lll111ll.paramCfg=I1l1l11111,I1l1l11111.scriptPkg=I1l1l11111.scriptPkg||"com.oui.DesignBiz";var l1l1llllII=I1l1l11111.page||{},l11ll1lllI=l1l1llllII.pageDesignType||I1l1l11111.pageDesignType||"printForm",l11l11llII=oui.getContextPath()+"res_engine/ppt_design/common/ppt-design-tpl.html";if("printForm"==l11ll1lllI&&(l11l11llII=oui.getContextPath()+"res_engine/ppt_design/common/ppt-design-tpl-space.html"),l11l11llII=l1l1llllII.designTplUrl||I1l1l11111.designTplUrl||l11l11llII,I1l1l11111.scriptPkg){var I11IIIIII1={designTplUrl:l11l11llII,pkg:I1l1l11111.scriptPkg,getDesigner:function(){return l1lll111ll}};oui.JsonPathUtil.setObjByPath(I1l1l11111.scriptPkg,window,I11IIIIII1,!0),l1lll111ll.plugin=I11IIIIII1}I1l1l11111.bizJs||(I1l1l11111.bizJs=[]);var I11l1lllll=[oui.getContextPath()+"res_engine/ppt_design/common/js/ppt-design.js"];"string"==typeof I1l1l11111.bizJs&&I1l1l11111.bizJs&&(I1l1l11111.bizJs=I1l1l11111.bizJs.split(","),oui.eachArray(I1l1l11111.bizJs,function(I111II11II,I1lll111II){var l1II1I1IIl=oui.getContextPath();0!=I111II11II.indexOf(l1II1I1IIl)&&(I1l1l11111.bizJs[I1lll111II]=l1II1I1IIl+I111II11II)})),I11l1lllll=I11l1lllll.concat(I1l1l11111.bizJs),oui.require(I11l1lllll,function(){I111II111I&&I111II111I()},function(){oui.getTop().oui.alert("加载插件资源 bizJs 中的资源失败,请联系管理员检查")},!1)},isIconUrl:function(I111II11I1){var I1III11111=!1;return I111II11I1.icon&&I111II11I1.icon.indexOf(".")>0&&(I1III11111=!0),I1III11111},isIconCss:function(I111ll11II){var l1lll111l1=!1;return I111ll11II.icon&&I111ll11II.icon.indexOf(".")<0&&I111ll11II.icon.indexOf("?")<0&&(l1lll111l1=!0),l1lll111l1},init4static:function(){var l111II11lI=this;l111II11lI.pageKeys="id,name,bizId,projectId,enName,modelType,version,canCloneControl,backgroundImageId,backgroundImageName,backgroundImage,description,pageDesignType,listContent,content,selectContent,style,innerStyle,controls,otherAttrs,events".split(","),l111II11lI.themeTypes=[{value:"1",display:"主题一"},{value:"2",display:"主题二"},{value:"3",display:"主题三"}],l111II11lI.paperRuleTypes=[{width:420,height:594,value:"A2",cellType:"mm"},{width:297,height:420,value:"A3",cellType:"mm"},{width:210,height:297,value:"A4",cellType:"mm"},{width:148,height:210,value:"A5",cellType:"mm"},{width:105,height:148,value:"A6",cellType:"mm"},{width:500,height:707,value:"B2",cellType:"mm"},{width:353,height:500,value:"B3",cellType:"mm"},{width:250,height:353,value:"B4",cellType:"mm"},{width:176,height:250,value:"B5",cellType:"mm"},{width:125,height:176,value:"B6",cellType:"mm"},{width:210,height:297,value:"self_edit",cellType:"mm"},{width:1080,height:980,value:"self_edit_px",cellType:"px"}];var I1III111I1="id,parentId,bizId,detailId,name,description,configTemplate,htmlType,controlType,icon,fieldType".split(",");l111II11lI.controlProps=[];for(var l1II1I1IIl=0,I1l1l111lI=I1III111I1.length;l1II1I1IIl<I1l1l111lI;l1II1I1IIl++)l111II11lI.controlProps.push({prop:I1III111I1[l1II1I1IIl]});l111II11lI.controlProps.push({prop:"canCloneControl",type:"boolean"}),l111II11lI.controlProps.push({prop:"showType",type:"int"}),l111II11lI.controlProps.push({prop:"formField",type:"boolean"}),l111II11lI.controlProps.push({prop:"style",type:"object"}),l111II11lI.controlProps.push({prop:"innerStyle",type:"object"}),l111II11lI.controlProps.push({prop:"otherAttrs",type:"object"}),l111II11lI.controlProps.push({prop:"events",type:"object"}),l111II11lI.toolbars=[],l111II11lI.toolbars.push({name:"preview",display:"预览"}),l111II11lI.toolbars.push({name:"save",cls:"top-btn-solid",display:"保存"}),l111II11lI.toolbars.push({name:"selectBoxArea",display:"截取页面"}),l111II11lI.toolbars.push({name:"merge",display:"合并"}),l111II11lI.toolbars.push({name:"split",display:"拆分"}),l111II11lI.toolbars.push({name:"insertColumn4prev",display:"插入列到前面"}),l111II11lI.toolbars.push({name:"insertRow4prev",display:"插入行到前面"}),l111II11lI.toolbars.push({name:"removeColumn",display:"删除列"}),l111II11lI.toolbars.push({name:"removeRow",display:"删除行"}),l111II11lI.toolbars.push({name:"new",display:"新建"}),l111II11lI.toolbars.push({name:"import",display:"导入"}),l111II11lI.toolbars.push({name:"export",display:"导出"}),l111II11lI.toolbars.push({name:"print",display:"打印",cls:"top-btn-solid"})},findButtonsByNames:function(l111ll111l){var l1lll111Il=[],l1ll1l1lI1=this;return l111ll111l&&("string"==typeof l111ll111l&&(l111ll111l=l111ll111l.split(",")),l1lll111Il=oui.findManyFromArrayBy(l1ll1l1lI1.toolbars||[],function(I111II11l1){return l111ll111l.indexOf(I111II11l1.name)>-1})),l1lll111Il},checkData:function(l111II11I1){var l1III111I1=this,I1ll1l1lII=[];return l1III111I1.data.currentControl&&l1III111I1.data.controls.indexOf(l1III111I1.data.currentControl)>-1?l1III111I1.checkControl(l1III111I1.data.currentControl,!0,l111II11I1):((I1ll1l1lII=l1III111I1.Validator.check(l1III111I1.data,!0))&&I1ll1l1lII.length&&l1III111I1.setCurrPropsData4page(),I1ll1l1lII&&I1ll1l1lII.length?(l111II11I1||oui.getTop().oui.showAutoTips({content:I1ll1l1lII[0].msg,boxStyle:"background-color:#e07365"}),!1):(l1III111I1.data.tempControl={},!0))},checkControl:function(I111II1111,l1lll1111l,l1ll1l1llI){var I1I1I111II=this,l11l1111I1=I1I1I111II.Validator.check(I1I1I111II.data.tempControl,l1lll1111l,"tempControl");return l11l1111I1&&l11l1111I1.length?(I1I1I111II.setCurrPropsData(I111II1111,"center","down2selectField"),l1ll1l1llI||oui.getTop().oui.showAutoTips({content:l11l1111I1[0].msg,boxStyle:"background-color:#e07365"}),!1):(l11l1111I1=I1I1I111II.Validator.checkControl(I111II1111,l1lll1111l))&&l11l1111I1.length?(I1I1I111II.setCurrPropsData(I111II1111,"center","down2selectField"),l1ll1l1llI||oui.getTop().oui.showAutoTips({content:l11l1111I1[0].msg,boxStyle:"background-color:#e07365"}),!1):(I1I1I111II.data.tempControl={},!0)},findCheckMessage:function(l111ll111I){var l1III111II=this;return l1III111II.Validator.findCheckMessage(l111ll111I,l1III111II.data)},newId:function(){var I111II111l,I1III111II=this,I1II1I1I11=!0;do{I111II111l=I1III111II.controlIdPrefix+oui.getUUIDLong(),I1II1I1I11=!!(I1II1I1I11=oui.findOneFromArrayBy(I1III111II.data.controls,function(l111ll11I1){if(l111ll11I1.id==I111II111l)return!0}))}while(I1II1I1I11);return I111II111l},formField:function(l111ll11l1){var l1III111l1=!0;return"selectArea"!=l111ll11l1.htmlType&&"label"!=l111ll11l1.htmlType||(l1III111l1=!1),l1III111l1},isShowPageProps:function(){var I111ll11Il=this.state,l1lll111ll=!1;return"init,down2selectPage".split(",").indexOf(I111ll11Il)>-1&&(l1lll111ll=!0),l1lll111ll},isShowControlProps:function(){return!this.isShowPageProps()},findStateTypeName:function(){var I111II11l1=this,I1lll1111l=I111II11l1.state;return"init,down2selectPage".split(",").indexOf(I1lll1111l)>-1?"页面属性":I111II11l1.data.currentControl&&I111II11l1.data.currentControl.htmlType==l1II1I1I1l.selectArea.name?"选择区域属性":"控件属性"},findPageAttrsRepeat4Dom:function(){var l111ll11ll=this,l1lll111II=[];return l1lll111II.push({prop:"id"}),l1lll111II.push({prop:"name"}),l1lll111II.push({prop:"description"}),l1lll111II.push({prop:"style",type:"object"}),l1lll111II.push({prop:"innerStyle",type:"object"}),l1lll111II.push({prop:"otherAttrs",type:"object"}),this.findObjectAttrsRepeat4Dom(l1lll111II,l111ll11ll.data,l111ll11ll.pageDomAttrPrefix)},findControlAttrsRepeat4Dom:function(I111II11Il){var I1lll111I1=this;return I1lll111I1.findObjectAttrsRepeat4Dom(I1lll111I1.controlProps,I111II11Il,I1lll111I1.controlDomAttrPrefix)},findStyleString:function(l111II11lI,l1lll111ll,I1II1I1I11,l1l1l1111I){l1lll111ll=l1lll111ll||"control-style-tpl",l111II11lI=l111II11lI||{};var l11I11111l=this;l11I11111l.tpls||(l11I11111l.tpls={}),l11I11111l.tpls[l1lll111ll]||(l11I11111l.tpls[l1lll111ll]=template.compile(document.getElementById(l1lll111ll).innerHTML));var I1lll1l11I=l111II11lI.backgroundImage;l111II11lI.backgroundImage&&(l111II11lI.backgroundImage="");for(var l1lll11ll1=l11I11111l.tpls[l1lll111ll]({data:l11I11111l.data,style:l111II11lI,controlInTd:I1II1I1I11,rect4px:l1l1l1111I}),l111111lll=(l1lll11ll1=(l1lll11ll1=l1lll11ll1.substring(l1lll11ll1.indexOf("{")+1,l1lll11ll1.lastIndexOf("}"))).replace(/data\:image\/jpeg\;/gi,"_imagedata_")).split(";"),I1l1llll11=[],l11II1II1l=0,l11I11IIlI=l111111lll.length;l11II1II1l<l11I11IIlI;l11II1II1l++){var l11IIIIIl1=l111111lll[l11II1II1l].split(":"),I11l1lllII=l1lll111lI.trim(l11IIIIIl1[0]),I1111IIIlI=l1lll111lI.trim(l11IIIIIl1[1]);I11l1lllII&&I1l1llll11.push(I11l1lllII+":"+I1111IIIlI)}return I1lll1l11I&&(l111II11lI.backgroundImage=I1lll1l11I,I1l1llll11.push("background-image:"+I1lll1l11I)),l1lll11ll1=I1l1llll11.join(";"),l1lll11ll1=l1lll11ll1.replace(/_imagedata_/gi,"data:image/jpeg;")},findStyleStringKeys:function(l111ll111I){for(var I1III111l1=this.styleStringKeys,l1II1I1IIl=[],I1l1l11111=0,l11I111111=I1III111l1.length;I1l1l11111<l11I111111;I1l1l11111++){var I1lll1l1I1=I1III111l1[I1l1l11111];l111ll111I[I1lll1l1I1]&&l1II1I1IIl.push(I1lll1l1I1)}return l1II1I1IIl},findDefaultControlByBizControlType:function(l111II11l1,l1III111Il,I1ll1l1llI){var I1l1l1111I,I11l1111Il=this,I1III1I1lI=I11l1111Il.defaultControls||[];if(l111II11l1){if(I1l1l1111I=oui.findOneFromArrayBy(I11l1111Il.defaultControls4Normal,function(l111ll11lI){if(l111ll11lI.controlType==l111II11l1)return!0}))return I1l1l1111I;(I1l1l1111I=oui.findOneFromArrayBy(I1III1I1lI,function(I111II11l1){if(I111II11l1.controlType==l111II11l1)return!0}))||(I1l1l1111I=oui.findOneFromArrayBy(I11l1111Il.defaultControls4Normal,function(l111ll111I){if(l111ll111I.htmlType==l1III111Il)return!0}))}else I1l1l1111I=oui.findOneFromArrayBy(I11l1111Il.defaultControls4Normal,function(l111ll111I){if(l111ll111I.htmlType==l1III111Il)return!0});return I1l1l1111I||(I1l1l1111I=oui.findOneFromArrayBy(I1III1I1lI,function(l111ll11lI){if(l111ll11lI.htmlType==l1II1I1I1l.other.name)return!0})),I1l1l1111I},findObjectAttrsRepeat4Dom:function(I111II11lI,I1lll1111I,I1II1I1Ill){var l1l1l111Il=this,I11I111111=I1II1I1Ill||l1l1l111Il.pageDomAttrPrefix,I1lll1l1Il=[];if(!I111II11lI||!I111II11lI.length||!I1lll1111I)return I1lll1l1Il;for(var l1III11III=I111II11lI||[],I111111Il1=0,l1l1llll1I=l1III11III.length;I111111Il1<l1l1llll1I;I111111Il1++){var I11II1III1=l1III11III[I111111Il1].prop,l11l11llIl=I1lll1111I[I11II1III1];l1III11III[I111111Il1].type&&("object"==l1III11III[I111111Il1].type?((l11l11llIl=oui.parseString(l11l11llIl||{})).indexOf("}}")>-1&&(l11l11llIl=l11l11llIl.replace(/\}\}/gi,"} }")),l11l11llIl.indexOf("{{")>-1&&(l11l11llIl=l11l11llIl.replace(/{{/gi,"{ {"))):"string"!=l1III11III[I111111Il1].type&&(void 0!==l11l11llIl?l11l11llIl+="":l11l11llIl="")),I1lll1l1Il.push({key:I11I111111+I11II1III1,value:l11l11llIl})}return I1lll1l1Il},getElConfigByKeys:function(l111II11II,l1lll111l1,I1ll1l1llI){I1ll1l1llI=I1ll1l1llI||this.pageDomAttrPrefix,"string"==typeof l1lll111l1&&(l1lll111l1=l1lll111l1.split(","));var l1I1I1111l={};if(l1lll111l1&&l1lll111l1.length)for(var l11I1111lI=0,I1III1I11I=l1lll111l1.length;l11I1111lI<I1III1I11I;l11I1111lI++){var I1lll11ll1=l1lll111l1[l11I1111lI];if("string"==typeof I1lll11ll1)l1I1I1111l[I1lll11ll1]=l111II11II.getAttribute(I1ll1l1llI+I1lll11ll1)||"";else{var l111111l11=l111II11II.getAttribute(I1ll1l1llI+I1lll11ll1.prop)||"",l1I1IIIIll=I1lll11ll1.type||"string";"string"==l1I1IIIIll||("boolean"==l1I1IIIIll?l111111l11="true"==l111111l11:"int"==l1I1IIIIll?l111111l11=parseInt(l111111l11||"0"):"float"==l1I1IIIIll?l111111l11=parseFloat(l111111l11||"0"):"object"==l1I1IIIIll&&(l111111l11=oui.parseJson(l111111l11||"{}"))),l1I1I1111l[I1lll11ll1.prop]=l111111l11}}return l1I1I1111l},transStylePropsByBizProps:function(){var I111II11l1=this;if(I111II11l1.data.otherAttrs&&I111II11l1.data.otherAttrs.backgroundImageUrl){var l1lll111ll=I111II11l1.data.otherAttrs.backgroundImageUrl;I111II11l1.data.style.backgroundImage="url("+l1lll111ll+")"}},initBefore:function(){var l111ll111I=this,I1lll111l1=l111ll111I.paramCfg,I1ll1l1l11=I1lll111l1.canCloneControl;void 0===I1ll1l1l11&&(I1ll1l1l11=!0),l111ll111I.oldParams=oui.parseJson(oui.parseString(I1lll111l1)),l111ll111I.init4static();var I1I1I111I1=I1lll111l1.page||{},l11I111111=I1I1I111I1.pageDesignType||I1lll111l1.pageDesignType||"printForm",l1III1I1lI=l1l1l111l1.findEnum(l11I111111),I1III11I1l={};l1III1I1lI&&l1III1I1lI.PageGlobalStyles&&(I1III11I1l=oui.parseJson(oui.parseString(l1III1I1lI.PageGlobalStyles)));var I111111lIl=oui.parseJson(oui.parseString(I11I1111II));if("string"==typeof I1I1I111I1.otherAttrs&&I1I1I111I1.otherAttrs.length&&(I1I1I111I1.otherAttrs=oui.parseJson(I1I1I111I1.otherAttrs)),l111ll111I.data=l1lll111lI.extend(!0,{id:"",bizId:"",canCloneControl:I1ll1l1l11,modelType:1,version:"1.0",pageDesignType:"printForm",enName:"",projectId:"",name:"页面名称",description:"",content:"",selectContent:"",controls:[],otherAttrs:{modelBindType:3},events:{},currentControl:{},tempControl:{},tempData:{}},I111111lIl,I1III11I1l,l111ll111I.data,I1I1I111I1),l111ll111I.transStylePropsByBizProps(),I1lll111l1.pageBizPropsUrl||(I1lll111l1.pageBizPropsUrl="res_engine/page_design/pc/page-biz-tpl.art.html"),I1lll111l1.controlBizPropsUrl||(I1lll111l1.controlBizPropsUrl="res_engine/page_design/pc/components-biz-prop-art-tpl"),l111ll111I.buttons=I1lll111l1.buttons||"",void 0===I1lll111l1.useControls&&I1lll111l1.controls&&I1lll111l1.controls.length&&(I1lll111l1.useControls=!0),l111ll111I.useControls=I1lll111l1.useControls,l111ll111I.useControls){for(var l1I1IIIIl1=I1lll111l1.controls||[],l11II1IIII={},I11l11lll1=[],I11lllll1I=0,I11I1III1l=l1I1IIIIl1.length;I11lllll1I<I11I1III1l;I11lllll1I++)l1I1IIIIl1[I11lllll1I].detailId?(l11II1IIII[l1I1IIIIl1[I11lllll1I].detailId]||(l11II1IIII[l1I1IIIIl1[I11lllll1I].detailId]=[]),l11II1IIII[l1I1IIIIl1[I11lllll1I].detailId].push(l1I1IIIIl1[I11lllll1I])):I11l11lll1.push(l1I1IIIIl1[I11lllll1I]);l111ll111I.ctrlAreaControls=I11l11lll1,l111ll111I.subControlsMap=l11II1IIII}else l111ll111I.ctrlAreaControls=l111ll111I.defaultControls||[],l111ll111I.subControlsMap={};l111ll111I.initTableLinesMap4first()},initTableLinesMap4first:function(){var l111II111I=this;l111II111I.tableLinesMap={},l111II111I.tableLineMaxRect={left:1e5,top:1e5,right:-1e5,bottom:-1e5};var l1III111II=l111II111I.data.controls;oui.findManyFromArrayBy(l1III111II,function(I111ll11Il){if("tableLine"==I111ll11Il.htmlType)return l111II111I.tableLinesMap[I111ll11Il.id]=I111ll11Il,l111II111I.updateTableLineMaxRect(I111ll11Il),!0})},findTableLineControl:function(I111II11l1){return this.tableLinesMap[I111II11l1]},updateTableLineMaxRect:function(I111II11l1){var I1lll1111I=this;I111II11l1&&"tableLine"==I111II11l1.htmlType&&(I111II11l1.style.left<I1lll1111I.tableLineMaxRect.left&&(I1lll1111I.tableLineMaxRect.left=I111II11l1.style.left),I111II11l1.style.top<I1lll1111I.tableLineMaxRect.top&&(I1lll1111I.tableLineMaxRect.top=I111II11l1.style.top),I111II11l1.style.width+I111II11l1.style.left>I1lll1111I.tableLineMaxRect.right&&(I1lll1111I.tableLineMaxRect.right=I111II11l1.style.width+I111II11l1.style.left),I111II11l1.style.height+I111II11l1.style.top>I1lll1111I.tableLineMaxRect.bottom&&(I1lll1111I.tableLineMaxRect.bottom=I111II11l1.style.height+I111II11l1.style.top))},getTableLineControl:function(I111ll11Il){return this.tableLinesMap[I111ll11Il]},addTableLineControl:function(l111ll11II){var I1III111Il=this;"tableLine"==l111ll11II.htmlType&&(I1III111Il.tableLinesMap[l111ll11II.id]=l111ll11II,I1III111Il.updateTableLineMaxRect(l111ll11II))},hasControlInTableLine:function(I111ll11lI){var l1lll111II=I111ll11lI.style.cellsMap||{},I1ll1l1ll1=!1;for(var I1l1l111ll in l1lll111II)if(l1lll111II[I1l1l111ll]&&l1lll111II[I1l1l111ll].controlId&&l1lll111II[I1l1l111ll].tableLineId){I1ll1l1ll1=!0;break}return I1ll1l1ll1},removeTableLineControl:function(I111II11II,l1III1111I){var I1ll1l1lI1=this,I1l1l111II=I1ll1l1lI1.findTableLineControl(I111II11II),l11l11111I=-1;if(I1l1l111II){if(l1III1111I){I111111III=I1l1l111II.style.cellsMap||{};for(var l1lll1l1lI in I111111III)if((l11II1IIIl=I111111III[l1lll1l1lI])&&l11II1IIIl.controlId&&l11II1IIIl.tableLineId){var I1lll11lII=I1ll1l1lI1.getControlById(l11II1IIIl.controlId);I1ll1l1lI1.removeRect4Control(I1lll11lII)}}else{var I111111III=I1l1l111II.style.cellsMap||{},I1l1llll1l=[];for(var l1lll1l1lI in I111111III){var l11II1IIIl=I111111III[l1lll1l1lI];l11II1IIIl&&l11II1IIIl.controlId&&l11II1IIIl.tableLineId&&I1l1llll1l.push(l11II1IIIl.controlId)}I1ll1l1lI1.removeControlsByIds(I1l1llll1l)}I1ll1l1lI1.tableLinesMap[I111II11II]=null,delete I1ll1l1lI1.tableLinesMap[I111II11II];var l11I11II1I=0;for(var l1lll1l1lI in I1ll1l1lI1.tableLinesMap)l11I11II1I++,I1ll1l1lI1.updateTableLineMaxRect(I1ll1l1lI1.tableLinesMap[l1lll1l1lI]);0==l11I11II1I&&(I1ll1l1lI1.tableLineMaxRect.left=1e5,I1ll1l1lI1.tableLineMaxRect.top=1e5,I1ll1l1lI1.tableLineMaxRect.right=-1e5,I1ll1l1lI1.tableLineMaxRect.bottom=-1e5),oui.findOneFromArrayBy(I1ll1l1lI1.data.controls||[],function(l111II11l1,I1lll1111l){if(l111II11l1.id==I111II11II)return l11l11111I=I1lll1111l,!0})}return l11l11111I},inTableLineMaxRect:function(l111II111l){var l1lll1111I=this,I1ll1l1l1I=l111II111l.left,I1l1l111ll=l111II111l.top,l11l1111Il=l111II111l.width||0,I1lll1l1l1=l111II111l.height||0,I1III11III=l111II111l.left+l11l1111Il,l111111III=l111II111l.top+I1lll1l1l1;return!(I1ll1l1l1I<l1lll1111I.tableLineMaxRect.left||I1III11III>l1lll1111I.tableLineMaxRect.right)&&!(I1l1l111ll<l1lll1111I.tableLineMaxRect.top||l111111III>l1lll1111I.tableLineMaxRect.bottom)},isPosAtControlHaffTop:function(I111II11I1,I1III111lI){var l1II1I1Il1=I1III111lI.top,l1l1l11111=I1III111lI.height||0;I1III111lI.top;return l1II1I1Il1<=(I111II11I1.style.top+(I111II11I1.style.top+I111II11I1.style.height))/2},posInControl:function(I111II11l1,l1lll111lI,l1II1I1Il1){if(!I111II11l1||!l1lll111lI)return!1;if(l1II1I1Il1){var l1I1I11111=l1lll111lI.top,I11I11111I=l1lll111lI.height||0,I1III1I1II=l1lll111lI.top+I11I11111I,l1III11III=I111II11l1.style.top,l111111IlI=I111II11l1.style.top+I111II11l1.style.height;if(l1I1I11111<l1III11III||I1III1I1II>l111111IlI)return!1}else{var I1I1IIIIIl=l1lll111lI.left,l1I1I11111=l1lll111lI.top,l11ll1lll1=l1lll111lI.width||0,I11I11111I=l1lll111lI.height||0,l11I11IIl1=l1lll111lI.left+l11ll1lll1,I1III1I1II=l1lll111lI.top+I11I11111I,l11IIIIIl1=I111II11l1.style.left,l1III11III=I111II11l1.style.top,I11I1III1l=I111II11l1.style.left+I111II11l1.style.width,l111111IlI=I111II11l1.style.top+I111II11l1.style.height;if(I1I1IIIIIl<l11IIIIIl1||l11I11IIl1>I11I1III1l)return!1;if(l1I1I11111<l1III11III||I1III1I1II>l111111IlI)return!1}return!0},inTableLineControl:function(I111ll11lI,I1lll111Il){var l1ll1l1ll1=this;return!(!I111ll11lI||"tableLine"!=I111ll11lI.htmlType)&&l1ll1l1ll1.posInControl(I111ll11lI,I1lll111Il)},findTableLineByPosOrRect:function(I111II11ll){var l1lll111II=this;if(l1lll111II.inTableLineMaxRect(I111II11ll)){var l1ll1l1l1l=l1lll111II.tableLinesMap||{};for(var l1l1l111Il in l1ll1l1l1l)if(l1lll111II.inTableLineControl(l1ll1l1l1l[l1l1l111Il],I111II11ll))return l1ll1l1l1l[l1l1l111Il]}return null},findControlByPosOrRect:function(l111II1111,l1III111lI){for(var l1II1I1I1I=this,I1I1I1111I=l1II1I1I1I.data.controls||[],l11l1111Il={},l1III1I11I=1e6,I1III11IlI=0,l111111lIl=I1I1I1111I.length;I1III11IlI<l111111lIl;I1III11IlI++){var I1I1IIII1I=I1I1I1111I[I1III11IlI];if(!(I1I1IIII1I&&I1I1IIII1I.style&&I1I1IIII1I.style.rect&&I1I1IIII1I.style.rect.tableLineId)&&(l1III111lI&&l1III111lI.id!=I1I1IIII1I.id)){if(l1II1I1I1I.posInControl(I1I1IIII1I,l111II1111,!0))return I1I1IIII1I;var I11II1II11=l111II1111.top,l11I11IIll=Math.min(Math.abs(I11II1II11-I1I1IIII1I.style.top),Math.abs(I11II1II11-I1I1IIII1I.style.top-I1I1IIII1I.style.height));l1III1I11I=Math.min(l11I11IIll,l1III1I11I),l11l1111Il[l11I11IIll]=I1III11IlI}}if(void 0!==l11l1111Il[l1III1I11I]){var I11IIIIIll=l11l1111Il[l1III1I11I];if(I1I1I1111I[I11IIIIIll])return I1I1I1111I[I11IIIIIll]}return null},removeRectInTableLineByColumnAndRow:function(I111ll111I,l1lll111Il,l1II1I1III){if(I111ll111I){var l1I1I111I1=I111ll111I.style.cellsMap||{};l1I1I111I1[l1lll111Il+"_"+l1II1I1III]=null,delete l1I1I111I1[l1lll111Il+"_"+l1II1I1III]}},setRectInTableLineByColumnAndRow:function(l111ll1111,l1lll1111I){if(l111ll1111){var I1II1I1IIl=l111ll1111.style.cellsMap||{};I1II1I1IIl[l1lll1111I.columnIndex+"_"+l1lll1111I.rowIndex]=l1lll1111I,l111ll1111.style.cellsMap=I1II1I1IIl}},removeRect4Control:function(l111II11lI){l111II11lI||(l111II11lI.style.rect=null,delete l111II11lI.style.rect)},findRectInTableLineByColumnAndRow:function(l111II11ll,l1lll111Il,I1II1I1III){return(l111II11ll.style.cellsMap||{})[l1lll111Il+"_"+I1II1I1III]},findMergeCellByRect:function(I111ll11lI,l1III111Il){var l1ll1l1lII,I1l1l111ll,l11l11111I=I111ll11lI.style.mergeCellsMap||{},l1III1I1I1=l1III111Il.columnIndex,l1lll11l11=l1III111Il.rowIndex;l1ll1l1lII=l1III111Il.colspan&&l1III111Il.colspan>1?l1III1I1I1+l1III111Il.colspan-1:l1III1I1I1,I1l1l111ll=l1III111Il.rowspan&&l1III111Il.rowspan>1?l1lll11l11+l1III111Il.rowspan-1:l1lll11l11;for(var l111111lI1 in l11l11111I){var l1l1llllIl=l11l11111I[l111111lI1];if(l1l1llllIl&&(l1III1I1I1>=l1l1llllIl.startColumnIndex&&l1ll1l1lII<=l1l1llllIl.endColumnIndex&&l1lll11l11>=l1l1llllIl.startRowIndex&&I1l1l111ll<=l1l1llllIl.endRowIndex))return l1l1llllIl}return null},findRectInTableLine:function(I111II111I,I1lll111I1,I1II1I1I1l){var I1I1I111Il=this,I11l1111II={tableLineId:I111II111I?I111II111I.id:"",columnIndex:-1,rowIndex:-1,left:1e5,top:1e5,right:-1e5,bottom:-1e5},I1lll1l11I=oui.parseJson(oui.parseString(I11l1111II));if(!I111II111I||!I1lll111I1)return I1lll1l11I;for(var l1III11IIl=I1lll111I1.left-I111II111I.style.left,l111111IlI=I1lll111I1.top-I111II111I.style.top,l1l1llll1I=l1III11IIl+(I1lll111I1.width||0),I11II1III1=l111111IlI+(I1lll111I1.height||0),l11I11IIIl=1e5,I11IIIIIlI=-1e5,l11l1lllII=1e5,l1111lllll=-1e5,I1II1I11lI=I111II111I.style.columnLines||[],l111llllIl=I111II111I.style.rowLines||[],l111II1IIl=!1,I1111l1l1I=!1,l1I111I11l=-1,I11I111Ill=-1,l11111l11I=I111II111I.style.borderLeftWidth,l1l11ll111=I111II111I.style.borderTopWidth,l1l1l1l11I=0,I11ll1l11l=I1II1I11lI.length;l1l1l1l11I<I11ll1l11l-1;l1l1l1l11I++)if(l11I11IIIl=I1II1I11lI[l1l1l1l11I].config.lineHeight+I1II1I11lI[l1l1l1l11I].fromPos.left+l11111l11I,I11IIIIIlI=I1II1I11lI[l1l1l1l11I+1].fromPos.left+l11111l11I,l1III11IIl>=I1II1I11lI[l1l1l1l11I].fromPos.left&&l1l1llll1I<=I11IIIIIlI+I1II1I11lI[l1l1l1l11I+1].config.lineHeight){l1I111I11l=l1l1l1l11I,l111II1IIl=!0;break}l111II1IIl&&(I1lll1l11I.left=l11I11IIIl+I111II111I.style.left,I1lll1l11I.right=I11IIIIIlI+I111II111I.style.left,I1lll1l11I.columnIndex=l1I111I11l);for(var l1l1l1l11I=0,I11ll1l11l=l111llllIl.length;l1l1l1l11I<I11ll1l11l-1;l1l1l1l11I++)if(l11l1lllII=l111llllIl[l1l1l1l11I].config.lineHeight+l111llllIl[l1l1l1l11I].fromPos.top+l1l11ll111,l1111lllll=l111llllIl[l1l1l1l11I+1].fromPos.top+l1l11ll111,l111111IlI>=l111llllIl[l1l1l1l11I].fromPos.top&&I11II1III1<=l1111lllll+l111llllIl[l1l1l1l11I+1].config.lineHeight){I11I111Ill=l1l1l1l11I,I1111l1l1I=!0;break}I1111l1l1I&&(I1lll1l11I.top=l11l1lllII+I111II111I.style.top,I1lll1l11I.bottom=l1111lllll+I111II111I.style.top,I1lll1l11I.rowIndex=I11I111Ill);var I1II11I1l1=I1I1I111Il.findMergeCellByRect(I111II111I,I1lll1l11I);if(I1II11I1l1&&(I1lll1l11I.left=I1II11I1l1.left,I1lll1l11I.top=I1II11I1l1.top,I1lll1l11I.right=I1II11I1l1.right,I1lll1l11I.bottom=I1II11I1l1.bottom,I1lll1l11I.columnIndex=I1II11I1l1.startColumnIndex,I1lll1l11I.rowIndex=I1II11I1l1.startRowIndex,I1lll1l11I.rowspan=I1II11I1l1.endRowIndex-I1II11I1l1.startRowIndex+1,I1lll1l11I.colspan=I1II11I1l1.endColumnIndex-I1II11I1l1.startColumnIndex+1),!I1II1I1I1l){var I1l111ll1l=I1I1I111Il.findRectInTableLineByColumnAndRow(I111II111I,I1lll1l11I.columnIndex,I1lll1l11I.rowIndex);if(I1l111ll1l&&I1l111ll1l.controlId){var I1l11l111I=I1I1I111Il.data.currentControl;I1l11l111I&&I1l11l111I.id!=I1l111ll1l.controlId&&(I1lll1l11I=I11l1111II)}}return I1lll1l11I},findMaxArea:function(l111ll111l,l1III111lI,I1II1I1II1){var l1I1I111lI=this,I11I1111II=null,l1III1I1ll=l1III111lI.columnIndex<I1II1I1II1.columnIndex?l1III111lI.columnIndex:I1II1I1II1.columnIndex,l1lll11l1l=l1III111lI.columnIndex+(l1III111lI.colspan&&l1III111lI.colspan>1?l1III111lI.colspan-1:0),I111111IlI=I1II1I1II1.columnIndex+(I1II1I1II1.colspan&&I1II1I1II1.colspan>1?I1II1I1II1.colspan-1:0),l1I1IIIII1=l1lll11l1l>I111111IlI?l1lll11l1l:I111111IlI,l11ll1llIl=l1III111lI.rowIndex<I1II1I1II1.rowIndex?l1III111lI.rowIndex:I1II1I1II1.rowIndex,l11I11II1I=l1III111lI.rowIndex+(l1III111lI.rowspan&&l1III111lI.rowspan>1?l1III111lI.rowspan-1:0),l11lllllI1=I1II1I1II1.rowIndex+(I1II1I1II1.rowspan&&I1II1I1II1.rowspan>1?I1II1I1II1.rowspan-1:0),I11I1IIIlI=l11I11II1I>l11lllllI1?l11I11II1I:l11lllllI1;if(l1III1I1ll<0||l1I1IIIII1<0||l11ll1llIl<0||I11I1IIIlI<0)return I11I1111II;I11I1111II={tableLineId:l111ll111l.id};var I1111IIIl1=l1III111lI.left<I1II1I1II1.left?l1III111lI.left:I1II1I1II1.left,I1ll1l11Il=l1III111lI.top<I1II1I1II1.top?l1III111lI.top:I1II1I1II1.top,l111IIII11=l1III111lI.right>I1II1I1II1.right?l1III111lI.right:I1II1I1II1.right,l111II1I11=l1III111lI.bottom>I1II1I1II1.bottom?l1III111lI.bottom:I1II1I1II1.bottom;if(l1I1I111lI.findMergeCellsMapByTableLine(l111ll111l)){var l1111I1II1=!1;do{l1111I1II1=!1;var I1l111l1II=l1I1I111lI.findMergeCellsByCellIndex4Inner(l111ll111l,l1III1I1ll,l11ll1llIl,l1I1IIIII1,I11I1IIIlI);if(I1l111l1II&&I1l111l1II.length)for(var l11l111lI1=0,I11111I11I=I1l111l1II.length;l11l111lI1<I11111I11I;l11l111lI1++){var l1I11II11I=I1l111l1II[l11l111lI1];if(l1I11II11I){var l1l1l1l1I1=l1I11II11I.startColumnIndex,l11II1I11I=l1I11II11I.startRowIndex,l1II11I11I=l1I11II11I.endColumnIndex,I1I111IIIl=l1I11II11I.endRowIndex;if(l1l1l1l1I1<l1III1I1ll&&(l1III1I1ll=l1l1l1l1I1,I1111IIIl1=l1I11II11I.left,l1111I1II1=!0),l11II1I11I<l11ll1llIl&&(l11ll1llIl=l11II1I11I,I1ll1l11Il=l1I11II11I.top,l1111I1II1=!0),l1II11I11I>l1I1IIIII1&&(l1I1IIIII1=l1II11I11I,l111IIII11=l1I11II11I.right,l1111I1II1=!0),I1I111IIIl>I11I1IIIlI&&(I11I1IIIlI=I1I111IIIl,l111II1I11=l1I11II11I.bottom,l1111I1II1=!0),l1111I1II1)break}}}while(l1111I1II1)}return I11I1111II.left=I1111IIIl1,I11I1111II.top=I1ll1l11Il,I11I1111II.right=l111IIII11,I11I1111II.bottom=l111II1I11,I11I1111II.startColumnIndex=l1III1I1ll,I11I1111II.startRowIndex=l11ll1llIl,I11I1111II.endColumnIndex=l1I1IIIII1,I11I1111II.endRowIndex=I11I1IIIlI,I11I1111II},findRectBySelectRect:function(I111ll111l,I1lll111lI){var l1II1I1III=I111ll111l.style.columnLines||[],I1l1l111l1=I111ll111l.style.rowLines||[],I11I111111=oui.parseJson(oui.parseString(I1lll111lI));I1lll111lI.startColumnIndex>l1II1I1III.length-2?I11I111111.startColumnIndex=l1II1I1III.length-2:I11I111111.startColumnIndex<0&&(I11I111111.startColumnIndex=0),I1lll111lI.endColumnIndex>l1II1I1III.length-2?I11I111111.endColumnIndex=l1II1I1III.length-2:I11I111111.endColumnIndex<0&&(I11I111111.endColumnIndex=0),I1lll111lI.startRowIndex>I1l1l111l1.length-2?I11I111111.startRowIndex=I1l1l111l1.length-2:I11I111111.startRowIndex<0&&(I11I111111.startRowIndex=0),I1lll111lI.endRowIndex>I1l1l111l1.length-2?I11I111111.endRowIndex=I1l1l111l1.length-2:I11I111111.endRowIndex<0&&(I11I111111.endRowIndex=0),I1lll111lI.startSelectColumnIndex>-1?(I11I111111.startRowIndex=0,I11I111111.endRowIndex=I1l1l111l1.length-2,I1lll111lI.startSelectColumnIndex=I11I111111.startColumnIndex):I1lll111lI.startSelectRowIndex>-1&&(I11I111111.startColumnIndex=0,I11I111111.endColumnIndex=l1II1I1III.length-2,I1lll111lI.startSelectRowIndex=I11I111111.startRowIndex);var l1III1I111={columnIndex:I11I111111.startColumnIndex,rowIndex:I11I111111.endRowIndex,left:I111ll111l.style.left+I111ll111l.style.borderLeftWidth+l1II1I1III[I11I111111.startColumnIndex].config.lineHeight+l1II1I1III[I11I111111.startColumnIndex].fromPos.left,right:I111ll111l.style.left+I111ll111l.style.borderLeftWidth+l1II1I1III[I11I111111.startColumnIndex+1].fromPos.left,top:I111ll111l.style.top+I111ll111l.style.borderTopWidth+I1l1l111l1[I11I111111.startRowIndex].config.lineHeight+I1l1l111l1[I11I111111.startRowIndex].fromPos.top,bottom:I111ll111l.style.top+I111ll111l.style.borderTopWidth+I1l1l111l1[I11I111111.startRowIndex+1].fromPos.top},I1III11III={columnIndex:I11I111111.endColumnIndex,rowIndex:I11I111111.endRowIndex,left:I111ll111l.style.left+I111ll111l.style.borderLeftWidth+l1II1I1III[I11I111111.endColumnIndex].config.lineHeight+l1II1I1III[I11I111111.endColumnIndex].fromPos.left,right:I111ll111l.style.left+I111ll111l.style.borderLeftWidth+l1II1I1III[I11I111111.endColumnIndex+1].fromPos.left,top:I111ll111l.style.top+I111ll111l.style.borderTopWidth+I1l1l111l1[I11I111111.endRowIndex].config.lineHeight+I1l1l111l1[I11I111111.endRowIndex].fromPos.top,bottom:I111ll111l.style.top+I111ll111l.style.borderTopWidth+I1l1l111l1[I11I111111.endRowIndex+1].fromPos.top};return I11I111111.left=l1III1I111.left,I11I111111.top=l1III1I111.top,I11I111111.right=I1III11III.right,I11I111111.bottom=I1III11III.bottom,(I11I111111.startSelectColumnIndex>-1||I11I111111.startSelectRowIndex>-1)&&(I11I111111.startRect=l1III1I111,I11I111111.endRect=I1III11III),I11I111111},showOperationSelectByTableLineSelectRect:function(l111ll111I,I1III111ll){var l1ll1l1llI=this;l1ll1l1llI.$operation||(l1ll1l1llI.$operation=l1lll111lI("#operation-layer"));var I1I1I111I1=l1ll1l1llI.$operation;if(I1III111ll){I1I1I111I1.find(".operation-select-area").css({display:"block",position:"absolute",background:"red",border:0,left:I1III111ll.left-l111ll111I.style.left+l111ll111I.style.lineHeight+"px",top:I1III111ll.top-l111ll111I.style.top+l111ll111I.style.lineHeight+"px",width:I1III111ll.right-I1III111ll.left+"px",height:I1III111ll.bottom-I1III111ll.top+"px"}),I1I1I111I1.find(".column-active").removeClass("column-active"),I1I1I111I1.find(".row-active").removeClass("row-active");for(var I11I1111l1=[],I1lll1l11l=[],I1III11IlI=I1III111ll.startColumnIndex;I1III11IlI<=I1III111ll.endColumnIndex;I1III11IlI++)I11I1111l1.push(".control-column-num-pabs[line-column-index="+I1III11IlI+"]");for(var I111111l1l=I1III111ll.startRowIndex;I111111l1l<=I1III111ll.endRowIndex;I111111l1l++)I1lll1l11l.push(".control-row-num-pabs[line-row-index="+I111111l1l+"]");I11I1111l1.length&&I1I1I111I1.find(I11I1111l1.join(",")).addClass("column-active"),I1lll1l11l.length&&I1I1I111I1.find(I1lll1l11l.join(",")).addClass("row-active")}else I1I1I111I1.find(".operation-select-area").css({display:"none"})},findRectBySelectArea:function(l111ll11Il,I1lll111Il){var I1ll1l1lI1=this,I1l1l111lI=I1lll111Il.startMouseX,I11l1111I1=I1lll111Il.startMouseY,l1III1I1II=I1lll111Il.mouseX,I1lll11lll=I1lll111Il.mouseY,I111111lII=I1lll111Il.dropPos,I1I1IIIIIl=I1l1l111lI+I1lll111Il.scrollContainerLeft-I111111lII.x,l11ll1ll1I=I11l1111I1+I1lll111Il.scrollContainerTop-I111111lII.y,l11I11IIlI=l1III1I1II+I1lll111Il.scrollContainerLeft-I111111lII.x,l11IIIIII1=I1lll11lll+I1lll111Il.scrollContainerTop-I111111lII.y,I11I1IIIlI={left:I1I1IIIIIl<l11I11IIlI?I1I1IIIIIl:l11I11IIlI,top:l11ll1ll1I<l11IIIIII1?l11ll1ll1I:l11IIIIII1,right:l11I11IIlI>I1I1IIIIIl?l11I11IIlI:I1I1IIIIIl,bottom:l11IIIIII1>l11ll1ll1I?l11IIIIII1:l11ll1ll1I};if("tableLine"==l111ll11Il.htmlType)if(I1lll111Il.startSelectColumnIndex>-1){var l1111lllIl=I1ll1l1lI1.findColumnRectByPosOrRect(l111ll11Il,{left:I11I1IIIlI.left,top:I11I1IIIlI.top}),l1ll1l1111=I1ll1l1lI1.findColumnRectByPosOrRect(l111ll11Il,{left:I11I1IIIlI.right,top:I11I1IIIlI.bottom}),l111llllll={rowIndex:0,columnIndex:l1111lllIl.columnIndex,left:l1111lllIl.left,right:l1111lllIl.right,top:l1111lllIl.startTop,bottom:l1111lllIl.startBottom},I111II1Il1={rowIndex:l111ll11Il.style.rowLines.length-2,columnIndex:l1ll1l1111.columnIndex,left:l1ll1l1111.left,right:l1ll1l1111.right,top:l1ll1l1111.top,bottom:l1ll1l1111.bottom};I11I1IIIlI={left:l111llllll.left,top:l111llllll.top,right:I111II1Il1.right,bottom:I111II1Il1.bottom,startRect:l111llllll,endRect:I111II1Il1},l111llllll.columnIndex==I111II1Il1.columnIndex&&(I11I1IIIlI.isSelectOneColumn=!0),I11I1IIIlI.startColumnIndex=l111llllll.columnIndex,I11I1IIIlI.endColumnIndex=I111II1Il1.columnIndex,I11I1IIIlI.startRowIndex=0,I11I1IIIlI.endRowIndex=I111II1Il1.rowIndex,I11I1IIIlI.isSelectColumn=!0,I11I1IIIlI.tableLineId=l111ll11Il.id}else if(I1lll111Il.startSelectRowIndex>-1){var l1111I1I1I=I1ll1l1lI1.findRowRectByPosOrRect(l111ll11Il,{left:I11I1IIIlI.left,top:I11I1IIIlI.top}),l1I111I11I=I1ll1l1lI1.findRowRectByPosOrRect(l111ll11Il,{left:I11I1IIIlI.right,top:I11I1IIIlI.bottom}),l111llllll={columnIndex:0,left:l1111I1I1I.startLeft,right:l1111I1I1I.startRight,rowIndex:l1111I1I1I.rowIndex,top:l1111I1I1I.top,bottom:l1111I1I1I.bottom},I111II1Il1={columnIndex:l111ll11Il.style.columnLines.length-2,left:l1I111I11I.left,right:l1I111I11I.right,rowIndex:l1I111I11I.rowIndex,top:l1I111I11I.top,bottom:l1I111I11I.bottom};I11I1IIIlI={left:l111llllll.left,top:l111llllll.top,right:I111II1Il1.right,bottom:I111II1Il1.bottom,startRect:l111llllll,endRect:I111II1Il1},l111llllll.rowIndex==I111II1Il1.rowIndex&&(I11I1IIIlI.isSelectOneRow=!0),I11I1IIIlI.startColumnIndex=0,I11I1IIIlI.endColumnIndex=I111II1Il1.columnIndex,I11I1IIIlI.startRowIndex=l111llllll.rowIndex,I11I1IIIlI.endRowIndex=I111II1Il1.rowIndex,I11I1IIIlI.isSelectRow=!0,I11I1IIIlI.tableLineId=l111ll11Il.id}else{var l111llllll=I1ll1l1lI1.findRectInTableLine(l111ll11Il,{left:I11I1IIIlI.left,top:I11I1IIIlI.top},!0),I111II1Il1=I1ll1l1lI1.findRectInTableLine(l111ll11Il,{left:I11I1IIIlI.right,top:I11I1IIIlI.bottom},!0);I11I1IIIlI=I1ll1l1lI1.findMaxArea(l111ll11Il,l111llllll,I111II1Il1)}return I11I1IIIlI},findColumnRectByPosOrRect:function(I111ll11lI,I1III111II){var I1ll1l1lII={tableLineId:I111ll11lI?I111ll11lI.id:"",columnIndex:-1,rowIndex:-1,left:1e5,top:1e5,right:-1e5,bottom:-1e5},l1l1l111l1=oui.parseJson(oui.parseString(I1ll1l1lII));if(!I111ll11lI||!I1III111II)return l1l1l111l1;for(var l11l1111I1=I1III111II.left-I111ll11lI.style.left,I1III1I1II=l11l1111I1+(I1III111II.width||0),l1lll11lll=1e5,l111111Ill=-1e5,l1I1IIII1l=I111ll11lI.style.columnLines||[],I11ll1ll11=!1,l11I11II1I=-1,I11IIIIII1=I111ll11lI.style.borderLeftWidth,l11l1lllll=I111ll11lI.style.borderTopWidth,I1111lllIl=0,l1ll1l1111=l1I1IIII1l.length;I1111lllIl<l1ll1l1111-1;I1111lllIl++)if(l1lll11lll=l1I1IIII1l[I1111lllIl].config.lineHeight+l1I1IIII1l[I1111lllIl].fromPos.left+I11IIIIII1,l111111Ill=l1I1IIII1l[I1111lllIl+1].fromPos.left+I11IIIIII1,l11l1111I1>=l1I1IIII1l[I1111lllIl].fromPos.left&&I1III1I1II<=l111111Ill+l1I1IIII1l[I1111lllIl+1].config.lineHeight){l11I11II1I=I1111lllIl,I11ll1ll11=!0;break}if(I11ll1ll11){var I111llllll=I111ll11lI.style.rowLines||[];l1l1l111l1.left=l1lll11lll+I111ll11lI.style.left,l1l1l111l1.right=l111111Ill+I111ll11lI.style.left,l1l1l111l1.columnIndex=l11I11II1I,l1l1l111l1.startTop=I111ll11lI.style.top+I111llllll[0].config.lineHeight+I111llllll[0].fromPos.top+l11l1lllll,l1l1l111l1.startBottom=I111ll11lI.style.top+I111llllll[1].fromPos.top+l11l1lllll,l1l1l111l1.top=I111ll11lI.style.top+I111llllll[I111llllll.length-2].config.lineHeight+I111llllll[I111llllll.length-2].fromPos.top+l11l1lllll,l1l1l111l1.bottom=I111ll11lI.style.top+I111llllll[I111llllll.length-1].fromPos.top+l11l1lllll}return l1l1l111l1},findRowRectByPosOrRect:function(l111ll111I,I1lll11111){var I1ll1l1lI1={tableLineId:l111ll111I?l111ll111I.id:"",columnIndex:-1,rowIndex:-1,left:1e5,top:1e5,right:-1e5,bottom:-1e5},I1I1I111Il=oui.parseJson(oui.parseString(I1ll1l1lI1));if(!l111ll111I||!I1lll11111)return I1I1I111Il;for(var I11l1111ll=I1lll11111.top-l111ll111I.style.top,l1lll1l11I=I11l1111ll+(I1lll11111.height||0),I1III11I11=1e5,l111111Il1=-1e5,l1l1llll1I=l111ll111I.style.rowLines||[],I11ll1llIl=!1,I11l11llII=-1,I11lllllIl=l111ll111I.style.borderTopWidth,l11l1lllll=0,I1111III1I=l1l1llll1I.length;l11l1lllll<I1111III1I-1;l11l1lllll++)if(I1III11I11=l1l1llll1I[l11l1lllll].config.lineHeight+l1l1llll1I[l11l1lllll].fromPos.top+I11lllllIl,l111111Il1=l1l1llll1I[l11l1lllll+1].fromPos.top+I11lllllIl,I11l1111ll>=l1l1llll1I[l11l1lllll].fromPos.top&&l1lll1l11I<=l111111Il1+l1l1llll1I[l11l1lllll+1].config.lineHeight){I11l11llII=l11l1lllll,I11ll1llIl=!0;break}if(I11ll1llIl){var I1ll1l11I1=l111ll111I.style.columnLines||[],l111lllllI=l111ll111I.style.borderLeftWidth;I1I1I111Il.startLeft=l111ll111I.style.left+I1ll1l11I1[0].config.lineHeight+I1ll1l11I1[0].fromPos.left+l111lllllI,I1I1I111Il.startRight=l111ll111I.style.left+I1ll1l11I1[1].fromPos.left+l111lllllI,I1I1I111Il.left=l111ll111I.style.left+I1ll1l11I1[I1ll1l11I1.length-2].config.lineHeight+I1ll1l11I1[I1ll1l11I1.length-2].fromPos.left+l111lllllI,I1I1I111Il.right=l111ll111I.style.left+I1ll1l11I1[I1ll1l11I1.length-1].fromPos.left+l111lllllI,I1I1I111Il.top=I1III11I11+l111ll111I.style.top,I1I1I111Il.bottom=l111111Il1+l111ll111I.style.top,I1I1I111Il.rowIndex=I11l11llII}return I1I1I111Il},findRectByPosOrRect:function(I111II111I){var I1lll111l1=this,l1ll1l1l11=I1lll111l1.findTableLineByPosOrRect(I111II111I);return I1lll111l1.findRectInTableLine(l1ll1l1l11,I111II111I)},createTableLines:function(l111ll111I){var I1lll111Il=this;return{columnLines:I1lll111Il.createTableColumnLines(l111ll111I),rowLines:I1lll111Il.createTableRowLines(l111ll111I)}},createTableColumnLines:function(I111ll11ll){for(var I1III11111=[],I1ll1l1l1l={color:I111ll11ll.style.lineColor,lineHeight:I111ll11ll.style.lineHeight},I1l1l111ll=0,I11I1111l1=I111ll11ll.style.lineHeight,l1lll1l1II=I111ll11ll.style.width,I1lll11ll1=I111ll11ll.style.height,l111111lIl=I111ll11ll.style.columnSize,I1l1llllII=(l1lll1l1II-I11I1111l1-I111ll11ll.style.borderLeftWidth-I111ll11ll.style.borderRightWidth)/l111111lIl,I11ll1ll1l=I1lll11ll1-I11I1111l1,I11I11II1l=0,I11lllllI1=l111111lIl+1;I11I11II1l<I11lllllI1;I11I11II1l++)I1III11111.push({fromPos:{left:I1l1l111ll,top:0},toPos:{left:I1l1l111ll,top:I11ll1ll1l},config:oui.parseJson(oui.parseString(I1ll1l1l1l))}),I1l1l111ll+=I1l1llllII;return I1III11111},createTableRowLines:function(l111ll111I){for(var I1lll11111=[],I1ll1l1l11={color:l111ll111I.style.lineColor,lineHeight:l111ll111I.style.lineHeight},l1I1I11111=0,I11I1111II=l111ll111I.style.lineHeight,l1III1I1II=l111ll111I.style.width,I1lll11l1l=l111ll111I.style.height,l111111l1I=l111ll111I.style.rowSize,I1l1llllII=(I1lll11l1l-I11I1111II-l111ll111I.style.borderBottomWidth-l111ll111I.style.borderTopWidth)/l111111l1I,l11ll1llIl=l1III1I1II-I11I1111II,I11l11llII=0,l11IIIIIl1=l111111l1I+1;I11l11llII<l11IIIIIl1;I11l11llII++)I1lll11111.push({fromPos:{left:0,top:l1I1I11111},toPos:{left:l11ll1llIl,top:l1I1I11111},config:oui.parseJson(oui.parseString(I1ll1l1l11))}),l1I1I11111+=I1l1llllII;return I1lll11111},isControlInDetail:function(l111ll1111){var l1lll111ll=!1;return l111ll1111&&l111ll1111.detailId&&(l1lll111ll=!0),l1lll111ll},isShowDetailControls:function(){return!!this.findCurrPageBizId()},findCurrPageBizId:function(){var I111II111l=this,l1III1111I="";return I111II111l.useControls&&(I111II111l.data&&I111II111l.data.currentControl&&("detail"==I111II111l.data.currentControl.controlType||"detail"==I111II111l.data.currentControl.controlType)?I111II111l.data.currentControl.bizId&&(l1III1111I=I111II111l.data.currentControl.bizId):I111II111l.isControlInDetail(I111II111l.data.currentControl)&&(l1III1111I=I111II111l.data.currentControl.detailId)),l1III1111I},findDetailName:function(l111II11ll){var l1lll1111I=this,I1II1I1I1l=oui.findOneFromArrayBy(l1lll1111I.ctrlAreaControls||[],function(I111ll111I){return I111ll111I.id==l111II11ll});return I1II1I1I1l?I1II1I1I1l.name:""},findControlTypes:function(){var l111II11Il=this,l1lll1111l=l111II11Il.findCurrPageBizId(),I1ll1l1l11=function(){var I111ll11lI=this.name;if(!this.controls){var I1III111lI=[];I1III111lI=l1lll1111l?l111II11Il.subControlsMap[l1lll1111l]||[]:l111II11Il.ctrlAreaControls||[],this.controls=oui.findManyFromArrayBy(I1III111lI,function(l111ll11Il){if(l111ll11Il.htmlType==I111ll11lI)return!0})||[]}return this.controls},I1l1l111l1=function(l111II11lI){var l1III1111l="";if(l111II11lI.id){l1III1111l="create-only-one";var I1II1I1IIl=com.oui.absolute.AbsoluteDesign;oui.findOneFromArrayBy(I1II1I1IIl.data.controls||[],function(I111ll111I){if(I111ll111I.id==l111II11lI.id)return!0})&&(l1III1111l+=" control-pabs-disable")}return l1III1111l};return[{name:l1II1I1I1l.button.name,title:"按钮",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.table.name,title:"表格",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.customTable.name,title:"自定义表格",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.container.name,title:"容器",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.detail.name,title:"明细表",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.textInput.name,title:"文本输入类",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.qrcode.name,title:"二维码",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.barcode.name,title:"条形码",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.image.name,title:"图片查看",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.selectInput.name,title:"选择输入类",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.repeatSelect.name,title:"平铺选择类",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.read.name,title:"查看类",findControls:I1ll1l1l11,findCls:I1l1l111l1},{name:l1II1I1I1l.other.name,title:"其它",findControls:I1ll1l1l11,findCls:I1l1l111l1}]},findThemeName:function(I111II111l){var l1lll111Il=this,l1ll1l1lII=oui.findOneFromArrayBy(l1lll111Il.themeTypes,function(l111ll11ll){if(l111ll11ll.value==I111II111l)return!0}),l1l1l111II="请选择主题";return l1ll1l1lII.value&&(l1l1l111II="self_edit"!=l1ll1l1lII.value?l1ll1l1lII.display:"自定义"),l1l1l111II},findPaperTypeName:function(I111ll111I){var l1III111Il=this,l1ll1l1lI1=oui.findOneFromArrayBy(l1III111Il.paperRuleTypes,function(I111II11lI){if(I111II11lI.value==I111ll111I)return!0}),I1I1I111II="请选择尺寸";return l1ll1l1lI1.value&&(I1I1I111II="self_edit"!=l1ll1l1lI1.value?l1ll1l1lI1.value+"（"+l1ll1l1lI1.width+l1ll1l1lI1.cellType+"*"+l1ll1l1lI1.height+l1ll1l1lI1.cellType+"）":"自定义"),I1I1I111II},event2pc:function(){var l111II1111=this;if("pc"!=l111II1111.clientType4Design)if(l111II1111.hasChange)oui.getTop().oui.alert("当前设计器存在变更，请先保存");else{var I1lll1111l=location.href;I1lll1111l=oui.setParam(I1lll1111l,"clientType","pc"),oui.go4replace(I1lll1111l)}},event2phone:function(){var l111ll11Il=this;if("phone"!=l111ll11Il.clientType4Design)if(l111ll11Il.hasChange)oui.getTop().oui.alert("当前设计器存在变更，请先保存");else{var I1lll111II=location.href;I1lll111II=oui.setParam(I1lll111II,"clientType","phone"),oui.go4replace(I1lll111II)}},event2showOrHideThemeSelect:function(l111ll11II){var I1lll111ll=l1lll111lI(l111ll11II.el).closest(".design-select-paper").find(".select-paper-list");I1lll111ll.hasClass("show-list")?I1lll111ll.removeClass("show-list"):I1lll111ll.addClass("show-list")},event2showOrHidePaperSizeSelect:function(I111II11ll){var I1III111l1=l1lll111lI(I111II11ll.el).closest(".design-select-paper").find(".select-paper-list");I1III111l1.hasClass("show-list")?I1III111l1.removeClass("show-list"):I1III111l1.addClass("show-list")},event2setTheme:function(I111ll111l){l1lll111lI(I111ll111l.el).closest(".design-select-paper").find(".select-paper-list").removeClass("show-list");var I1III111l1=l1lll111lI(I111ll111l.el).attr("value"),l1ll1l1l11=this;if(I1III111l1){var I1l1l11111=oui.findOneFromArrayBy(l1ll1l1l11.themeTypes,function(l111II1111){if(l111II1111.value==I1III111l1)return!0});I1l1l11111&&(l1ll1l1l11.data.style.theme=I1l1l11111.value,(oui.browser.ie||oui.browser.isEdge)&&l1ll1l1l11.setCurrPropsData4page("props","down2selectPage"),l1ll1l1l11.renderPaperStyle())}},findThemeUrl:function(){var I111ll1111=this;if(I111ll1111.data.style.theme){if("self_edit"==I111ll1111.data.style.theme){var I1lll11111=I111ll1111.data.style.themeUrl||"";return I1lll11111&&0!=I1lll11111.indexOf("http")&&(I1lll11111=oui.getContextPath()+I1lll11111),I1lll11111}return oui.getContextPath()+"res_common/oui/themes/"+I111ll1111.data.style.theme+".css"}return""},event2setPageInfo:function(l111ll111I){l1lll111lI(l111ll111I.el).closest(".design-select-paper").find(".select-paper-list").removeClass("show-list");var I1lll11111=l1lll111lI(l111ll111I.el).attr("value"),I1ll1l1l11=this;if(I1lll11111){var l1I1I111I1=oui.findOneFromArrayBy(I1ll1l1l11.paperRuleTypes,function(I111II11l1){if(I111II11l1.value==I1lll11111)return!0});if(l1I1I111I1){if(I1ll1l1l11.data.style.paperType=l1I1I111I1.value,I1ll1l1l11.data.style.cellType=l1I1I111I1.cellType,"self_edit"!=I1lll11111)I1ll1l1l11.data.style.width=l1I1I111I1.width,I1ll1l1l11.data.style.height=l1I1I111I1.height;else if(void 0===I1ll1l1l11.data.style.width||void 0===I1ll1l1l11.data.style.height){var l11l1111II=oui.findOneFromArrayBy(I1ll1l1l11.paperRuleTypes,function(l111ll11lI){if("A4"==l111ll11lI.value)return!0});I1ll1l1l11.data.style.width=l11l1111II.width,I1ll1l1l11.data.style.height=l11l1111II.height}(oui.browser.ie||oui.browser.isEdge)&&I1ll1l1l11.setCurrPropsData4page("props","down2selectPage"),I1ll1l1l11.renderPaperStyle()}}},event2setCurrTab2props:function(l111ll11ll){var I1lll111I1=this;I1lll111I1.activeTab=0,oui.browser.ie?I1lll111I1.changePropsView():oui.getById("absoluteProps").render(),oui.clear4notUse()},event2setCurrTab2bizProps:function(l111II11II){var l1lll11111=this;l1lll11111.activeTab=1,oui.browser.ie?l1lll11111.changePropsView():oui.getById("absoluteProps").render(),oui.clear4notUse()},onBeforeRender4Props:function(){var I111ll11lI=com.oui.absolute.AbsoluteDesign;if(I111ll11lI.timer4AfterRender4Props){try{clearTimeout(I111ll11lI.timer4AfterRender4Props)}catch(I111ll11ll){I111ll11lI.timer4AfterRender4Props=null}return!1}if(I111ll11lI.count=(I111ll11lI.count||0)+1,oui.browser.ie||oui.browser.isEdge){var l1III11111=l1lll111lI(".design-set-content");if(l1III11111&&l1III11111.length){var l1ll1l1ll1=l1III11111[0].scrollTop;I111ll11lI.lastScrollTop4props=l1ll1l1ll1}}},onAfterRender4Props:function(){var I111II11l1=com.oui.absolute.AbsoluteDesign;if(I111II11l1.timer4AfterRender4Props){try{clearTimeout(I111II11l1.timer4AfterRender4Props)}catch(I111II111I){}I111II11l1.timer4AfterRender4Props=null}else(oui.browser.ie||oui.browser.isEdge)&&(console.log("渲染次数"+I111II11l1.count),I111II11l1.timer4AfterRender4Props=setTimeout(function(){var l111II11Il=l1lll111lI(".fielderror-info").closest(".design-attribute-item");if(l111II11Il&&l111II11Il.length){if(l111II11Il.find(".design-set-attribute-tit").addClass("attribute-tit-active"),I111II11l1.lastScrollTop4props){if(I111II11l1.timer4errorFocus)try{clearTimeout(I111II11l1.timer4errorFocus)}catch(I111ll111l){}I111II11l1.timer4errorFocus=setTimeout(function(){var I111II11II=l1lll111lI(".design-set-content");document.body.onselectstart=function(){return!0},I111II11II[0].scrollTop=I111II11l1.lastScrollTop4props,I111II11l1.timer4errorFocus=null},50)}}else l1lll111lI(".design-set-content")[0].scrollTop=I111II11l1.lastScrollTop4props||0;I111II11l1.timer4AfterRender4Props=null},50))},changePropsView:function(){var l111ll11I1=this;(oui.browser.ie||oui.browser.isEdge)&&oui.getById("absoluteProps").setData(l111ll11I1.data),l111ll11I1.refreshBizProps()},setCurrPropsData:function(I111ll11II,I1lll111II,l1ll1l1lI1){var l1l1l111Il=this;if(l1l1l111Il.currTimer4change)try{clearTimeout(l1l1l111Il.currTimer4change)}catch(I111ll11l1){}l1l1l111Il.currTimer4change=setTimeout(function(){I111ll11II=I111ll11II||{},l1l1l111Il.data.currentControl=I111ll11II,l1l1l111Il.state=l1ll1l1lI1,"init"!=l1ll1l1lI1&&l1l1l111Il.designChanged(),l1l1l111Il.inited&&(l1l1l111Il.isShowDetailControls()?oui.getById("ctrlAreas").render():l1lll111lI(".design-ctrl-area").hasClass("detail-feilds")&&oui.getById("ctrlAreas").render(),"props"==I1lll111II?(l1l1l111Il.renderCenterAll(),l1l1l111Il.changePropsView(),setTimeout(function(){if(l1l1l111Il.isRenderAll=!1,l1l1l111Il.currDragEl)try{l1lll111lI(l1l1l111Il.currDragEl).attr("id")?l1lll111lI("#"+l1lll111lI(l1l1l111Il.currDragEl).attr("id")).trigger("mousedown"):l1lll111lI(l1l1l111Il.currDragEl).trigger("mousedown"),l1l1l111Il.currDragEl=null}catch(I111II111I){}},5)):oui.browser.ie||oui.browser.isEdge?l1l1l111Il.changePropsView():(oui.getById("absoluteProps").attr("forceUpdate",!0),oui.getById("absoluteProps").setData(l1l1l111Il.data,!0),l1l1l111Il.refreshBizProps())),l1l1l111Il.currTimer4change=null},10)},bizPropsUpdate:function(I111ll11ll,l1lll111lI){oui.getById("absoluteProps").attr("forceUpdate",!1),console.log("业务属性变更:"+I111ll11ll+":"+oui.parseString(l1lll111lI))},refreshBizProps:function(){var l111ll11ll=oui.getById("current-control-biz-props"),l1lll111l1=oui.getById("current-pageProps-biz");if(this.data.currentControl&&this.data.currentControl.id)if(null!=l111ll11ll)try{l111ll11ll.refresh()}catch(l111ll111I){}else oui.getById("absoluteProps").render();else if(null!=l1lll111l1)try{l1lll111l1.refresh()}catch(l111II11I1){}else oui.getById("absoluteProps").render()},getCurrPropsData:function(){return this.data},bindDrag:function(I111II11ll){function l1III11111(l111II11I1){return l111II11I1.pageX?l111II11I1.pageX:l111II11I1.clientX?l111II11I1.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):0}function l1ll1l1lII(I111II11II){return I111II11II.pageY?I111II11II.pageY:I111II11II.clientY?I111II11II.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):0}function I1l1l111l1(I111II11l1){var I1lll111l1=I111II11l1||window.event;return{x:l1III11111(I1lll111l1),y:l1ll1l1lII(I1lll111l1)}}function I11I11111I(I111II11ll){for(var l1lll1111I=0,l1II1I1II1=0;I111II11ll;)l1lll1111I+=I111II11ll.offsetLeft||0,l1II1I1II1+=I111II11ll.offsetTop||0,I111II11ll=I111II11ll.offsetParent;return-1!=navigator.userAgent.indexOf("Mac")&&void 0!==document.body.leftMargin&&(l1lll1111I+=document.body.leftMargin,l1II1I1II1+=document.body.topMargin),{x:l1lll1111I,y:l1II1I1II1}}var I1lll1l1lI=this,l1III11I1l=l1lll111lI("body"),l111111lII=l1lll111lI(".design-moving-layout"),I1I1IIIIII=l1lll111lI(document),l11ll1ll1l=l1lll111lI(I111II11ll.proxyDragSelector),l11l11ll1l=l1lll111lI(".proxy-drag-placeholder"),I11IIIII1I=l1lll111lI(I111II11ll.scrollContainer||"body"),I11l1lll1I=l1lll111lI(I111II11ll.dropContainer||I111II11ll.scrollContainer||"body"),l1111lll1I=l1lll111lI(I111II11ll.dragScrollContainer||"body"),I1ll1l1111=I111II11ll.cancelSelector||".control-pabs-disable",I111llllIl=I111II11ll.operationSelector||".operation-layer",l111II1III=(I11I11111I(I11l1lll1I[0]),I11I11111I(I11IIIII1I[0])),l1111I1I1I=I111II11ll.dragArea||{left:0,top:0,right:2e5,bottom:2e5};try{I1I1IIIIII.off("mousedown",I111II11ll.dragSelector)}catch(l111ll11lI){}I1lll1l1lI.getXY=I1l1l111l1,I1I1IIIIII.on("mousedown",I111II11ll.dragSelector,function(l111II111I){var I1III1111l=l1lll111lI(I111II11ll.dropContainer||I111II11ll.scrollContainer||"body");if(l1111lll1I=l1lll111lI(I111II11ll.dragScrollContainer||"body"),1==l111II111I.button);else if(2==l111II111I.button)return!1;l111II111I.target.setCapture&&l111II111I.target.setCapture();var l1ll1l1l1l=l1lll111lI(l111II111I.target).closest(".proxy-drag");if(l1lll111lI(l111II111I.target).is(".proxy-drag")||l1ll1l1l1l&&l1ll1l1l1l.length)return!1;var l1l1l111lI=I11I11111I(I1III1111l[0]),l11I1111Il=I11IIIII1I[0].scrollLeft,l1III1I1II=I11IIIII1I[0].scrollTop,l1III11Ill=l111II111I.target||l111II111I.srcElement,l111111lll=I1lll1l1lI.getXY(l111II111I),l1l1llllII=l111111lll.x,l11II1II1I=l111111lll.y,I11l11lllI=l1lll111lI(l1III11Ill).hasClass("drag-resizer"),l11llllll1=l1lll111lI(l1III11Ill).hasClass("line-row-resizer"),l11l1lllll=l1lll111lI(l1III11Ill).hasClass("line-column-resizer"),l1111lllIl=l1lll111lI(l1III11Ill).hasClass("drag-select-area"),I1ll1l11l1=l1lll111lI(l1III11Ill).hasClass("tableLine-drag-icon"),l111llll11=l1lll111lI(l1III11Ill).hasClass("control-column-num-pabs"),l111II1I11=null,l1111I1IIl=null;if(l111llll11?l111II1I11=l1III11Ill:l1lll111lI(l1III11Ill).closest(".control-column-num-pabs").length>0&&(l111llll11=!0,l111II1I11=l1lll111lI(l1III11Ill).closest(".control-column-num-pabs")[0]),l1I111I1lI)l1111I1IIl=l1III11Ill;else{var l1I111I1lI=l1lll111lI(l1III11Ill).hasClass("control-row-num-pabs");l1lll111lI(l1III11Ill).closest(".control-row-num-pabs").length>0&&(l1I111I1lI=!0,l1111I1IIl=l1lll111lI(l1III11Ill).closest(".control-row-num-pabs")[0])}var I11I111Ill=-1,l11111I11I=-1,l1l11ll1I1=-1,l1I1I1I1I1=-1,l11II1I1ll=0,I1II11I11I=0,l1l111llIl=-1e6,I1I11I11ll=1e6,I1llll11l1=-1e6,l11lll1111=1e6,I1ll111ll1=1,l1111l11I1=null;l111llll11&&(I11I111Ill=parseInt(l1lll111lI(l111II1I11).attr("line-column-index"))),l1I111I1lI&&(l11111I11I=parseInt(l1lll111lI(l1111I1IIl).attr("line-row-index"))),I11l11lllI&&(l1111l11I1=l1III11Ill,l11llllll1?(l1l11ll1I1=parseInt(l1lll111lI(l1III11Ill).attr("line-row-index")),l11II1I1ll=parseInt(l1lll111lI(l1III11Ill).attr("line-column-length")),I1II11I11I=parseInt(l1lll111lI(l1III11Ill).attr("line-row-length")),I1ll111ll1=l1lll111lI(l1111l11I1).outerHeight()):l11l1lllll&&(l1I1I1I1I1=parseInt(l1lll111lI(l1III11Ill).attr("line-column-index")),l11II1I1ll=parseInt(l1lll111lI(l1III11Ill).attr("line-column-length")),I1II11I11I=parseInt(l1lll111lI(l1III11Ill).attr("line-row-length")),I1ll111ll1=l1lll111lI(l1111l11I1).outerWidth()));var l11ll111I1=l1lll111lI(l1III11Ill).closest(I11IIIII1I).length>0;if(I11l11lllI)l1III11Ill=l1lll111lI(l1III11Ill).closest(I111II11ll.dragSelector)[0];else if(!l1lll111lI(l1III11Ill).is(I111II11ll.dragSelector)){if(l1lll111lI(l1III11Ill).is(I1ll1l1111))return!1;var l1I1111IlI=l1lll111lI(l1III11Ill).closest(I111II11ll.dragSelector);if(!l1I1111IlI||!l1I1111IlI.length)return!1;l1III11Ill=l1I1111IlI[0]}if(l1lll111lI(l1III11Ill).is(I1ll1l1111))return!1;if(l1lll111lI(l1III11Ill).is(I111llllIl)&&l11ll111I1&&(l1III11Ill=l1lll111lI("#"+l1III11Ill.getAttribute("control-pabs-id"))[0]),"dragging"==l1III11Ill.getAttribute("drag-status"))return!1;if(l1III11Ill.setAttribute("drag-status","down"),I1ll1l11l1||I11l11lllI||l1lll111lI(l1III11Ill).hasClass("drag-select-area")&&(l1111lllIl=!0),l1111l11I1){if(l11llllll1&&l1l11ll1I1>=0&&l1l11ll1I1<I1II11I11I){if(l1l11ll1I1>0){var I1I111111I=l1lll111lI(l1111l11I1).prev(".line-row-resizer");I1I111111I&&I1I111111I.length&&(I1llll11l1=Number(I1I111111I.css("top").replace("px","")||"0"),I1llll11l1+=I1I111111I.outerHeight())}if(l1l11ll1I1!=I1II11I11I-1){var I1I1I11I11=l1lll111lI(l1111l11I1).next(".line-row-resizer");I1I1I11I11&&I1I1I11I11.length&&(l11lll1111=Number(I1I1I11I11.css("top").replace("px","")||"0"),l11lll1111-=I1I1I11I11.outerHeight())}}if(l11l1lllll&&l1I1I1I1I1>=0&&l1I1I1I1I1<l11II1I1ll){if(l1I1I1I1I1>0){var I1ll1111lI=l1lll111lI(l1111l11I1).prev(".line-column-resizer");I1ll1111lI&&I1ll1111lI.length&&(l1l111llIl=Number(I1ll1111lI.css("left").replace("px","")||"0"),l1l111llIl+=I1ll1111lI.outerWidth())}if(l1I1I1I1I1!=l11II1I1ll-1){var l1I1II11l1=l1lll111lI(l1111l11I1).next(".line-column-resizer");l1I1II11l1&&l1I1II11l1.length&&(I1I11I11ll=Number(l1I1II11l1.css("left").replace("px","")||"0"),I1I11I11ll-=l1I1II11l1.outerWidth())}}}var l11l1l11l1=I1lll1l1lI.dragCfg;l11l1l11l1?(l11l1l11l1.e=l111II111I,l11l1l11l1.el=l1III11Ill,l11l1l11l1.isUpdate=l11ll111I1,l11l1l11l1.isResizer=I11l11lllI,l11l1l11l1.isSelectArea=l1111lllIl,l11l1l11l1.startSelectColumnIndex=I11I111Ill,l11l1l11l1.startSelectRowIndex=l11111I11I,l11l1l11l1.isSelectColumn=l111llll11,l11l1l11l1.isSelectRow=l1I111I1lI,l11l1l11l1.resizeRowIndex=l1l11ll1I1,l11l1l11l1.resizeColumnIndex=l1I1I1I1I1,l11l1l11l1.isResizerRow=l11llllll1,l11l1l11l1.isResizerColumn=l11l1lllll,l11l1l11l1.dropPos=l1l1l111lI,l11l1l11l1.scrollContainerLeft=l11I1111Il,l11l1l11l1.scrollContainerTop=l1III1I1II,l11l1l11l1.$proxyDrag=l11ll1ll1l,l11l1l11l1.$proxyPlaceholder=l11l11ll1l):(I1lll1l1lI.dragCfg={e:l111II111I,el:l1III11Ill,isUpdate:l11ll111I1,isResizer:I11l11lllI,isSelectArea:l1111lllIl,startSelectColumnIndex:I11I111Ill,startSelectRowIndex:l11111I11I,isSelectColumn:l111llll11,isSelectRow:l1I111I1lI,resizeRowIndex:l1l11ll1I1,resizeColumnIndex:l1I1I1I1I1,isResizerRow:l11llllll1,isResizerColumn:l11l1lllll,dropPos:l1l1l111lI,scrollContainerLeft:l11I1111Il,scrollContainerTop:l1III1I1II,$proxyDrag:l11ll1ll1l,$proxyPlaceholder:l11l11ll1l},l11l1l11l1=I1lll1l1lI.dragCfg);var l1IIIIIIII=I111II11ll.down&&I111II11ll.down(I1lll1l1lI.dragCfg);if("boolean"==typeof l1IIIIIIII&&!l1IIIIIIII)return l1III11I1l.removeClass("design-pointer-events"),l111II111I.target.releaseCapture&&l111II111I.target.releaseCapture(),!1;var I1l1ll1lI1=function(l111ll11lI){var l111ll11lI=l111ll11lI||event,l1III111II=l1III11Ill.getAttribute("drag-status");if(I111II11ll.move&&I111II11ll.move(l11l1l11l1),"down"!=l1III111II){if("start"==l1III111II||"dragging"==l1III111II){var I1II1I1II1="start"==l1III111II;if("start"==l1III111II){l1l1l111lI=I11I11111I(I1III1111l[0]),l111II1III=I11I11111I(I11IIIII1I[0]),l1l1l111lI.width=I1III1111l.width(),l1l1l111lI.height=I1III1111l.height(),l11ll1ll1l.addClass("proxy-dragging"),l111111lII.show(),I11l11lllI?l11ll1ll1l.addClass("proxy-dragging-resize"):l11ll1ll1l.removeClass("proxy-dragging-resize"),l1111lllIl?l11ll1ll1l.addClass("proxy-dragging-select-area"):l11ll1ll1l.removeClass("proxy-dragging-select-area"),l11ll1ll1l[0].style.position="absolute",l11ll1ll1l[0].style.zIndex=1e3,l11ll1ll1l.attr("tabindex",0),l11ll1ll1l.focus(),l1III111II="dragging",l1III11Ill.setAttribute("drag-status",l1III111II);var l1I1I111II,I11I1111ll;if(l11ll111I1)l1I1I111II=l1lll111lI(l1III11Ill).outerWidth(),I11I1111ll=l1lll111lI(l1III11Ill).outerHeight();else{var l1lll1l1l1=I1lll1l1lI.getElConfigByKeys(l1III11Ill,I1lll1l1lI.controlProps,I1lll1l1lI.controlDomAttrPrefix);l1I1I111II=l1lll1l1l1.style&&l1lll1l1l1.style.width,I11I1111ll=l1lll1l1l1.style&&l1lll1l1l1.style.height,l1I1I111II=l1I1I111II||230,I11I1111ll=I11I1111ll||42}l11ll1ll1l.width(l1I1I111II),l11ll1ll1l.height(I11I1111ll);var I1lll11lI1=I11I11111I(l1III11Ill);l11ll111I1||oui.isInDom(l1III11Ill,l1111lll1I[0])&&(I1lll11lI1.x-=l1111lll1I[0].scrollLeft,I1lll11lI1.y-=l1111lll1I[0].scrollTop);var I111111llI=0,l1I1IIIIl1=0;if(l1111l11I1){try{l1I1IIIIl1=Number(l1lll111lI(l1111l11I1).css("top").replace("px","")||"0")}catch(I111ll11l1){l1I1IIIIl1=0}try{I111111llI=Number(l1lll111lI(l1111l11I1).css("left").replace("px","")||"0")}catch(l111II11ll){I111111llI=0}l11l1lllll||l11llllll1?(l1lll111lI(l1111l11I1).addClass("line-dragging"),0==l1I1I1I1I1||l1I1I1I1I1==l11II1I1ll-1||0==l1l11ll1I1||l1l11ll1I1==I1II11I11I-1?l11ll1ll1l.removeClass("proxy-dragging-change-cell"):l11ll1ll1l.addClass("proxy-dragging-change-cell")):(l1lll111lI(l1111l11I1).removeClass("line-dragging"),l11ll1ll1l.removeClass("proxy-dragging-change-cell"))}else l11ll1ll1l.removeClass("proxy-dragging-change-cell");I1lll1l1lI.dragData?((I11ll1ll1l=I1lll1l1lI.dragData).startWidth=l1I1I111II,I11ll1ll1l.startHeight=I11I1111ll,I11ll1ll1l.width=l1I1I111II,I11ll1ll1l.height=I11I1111ll,I11ll1ll1l.elPos=I1lll11lI1,I11ll1ll1l.dropPos=l1l1l111lI,I11ll1ll1l.startX=I1lll11lI1.x-l1l1l111lI.x,I11ll1ll1l.startY=I1lll11lI1.y-l1l1l111lI.y,I11ll1ll1l.startMouseX=l1l1llllII,I11ll1ll1l.startMouseY=l11II1II1I,I11ll1ll1l.startSelectColumnIndex=I11I111Ill,I11ll1ll1l.startSelectRowIndex=l11111I11I,I11ll1ll1l.startResizeLeft=I111111llI,I11ll1ll1l.startResizeTop=l1I1IIIIl1,I11ll1ll1l.resizeRowIndex=l1l11ll1I1,I11ll1ll1l.resizeColumnIndex=l1I1I1I1I1,I11ll1ll1l.lineColumnLength=l11II1I1ll,I11ll1ll1l.lineRowLength=I1II11I11I,I11ll1ll1l.fromResizeLeft=l1l111llIl,I11ll1ll1l.toResizeLeft=I1I11I11ll,I11ll1ll1l.fromResizeTop=I1llll11l1,I11ll1ll1l.toResizeTop=l11lll1111,I11ll1ll1l.lineWidth=I1ll111ll1,I11ll1ll1l.scrollContainerLeft=l11I1111Il,I11ll1ll1l.scrollContainerTop=l1III1I1II,I11ll1ll1l.resizerEl=l1111l11I1):I1lll1l1lI.dragData={startWidth:l1I1I111II,startHeight:I11I1111ll,width:l1I1I111II,height:I11I1111ll,elPos:I1lll11lI1,dropPos:l1l1l111lI,startX:I1lll11lI1.x-l1l1l111lI.x,startY:I1lll11lI1.y-l1l1l111lI.y,startMouseX:l1l1llllII,startMouseY:l11II1II1I,startSelectColumnIndex:I11I111Ill,startSelectRowIndex:l11111I11I,startResizeLeft:I111111llI,startResizeTop:l1I1IIIIl1,resizeRowIndex:l1l11ll1I1,resizeColumnIndex:l1I1I1I1I1,lineColumnLength:l11II1I1ll,lineRowLength:I1II11I11I,fromResizeLeft:l1l111llIl,toResizeLeft:I1I11I11ll,fromResizeTop:I1llll11l1,toResizeTop:l11lll1111,lineWidth:I1ll111ll1,scrollContainerLeft:l11I1111Il,scrollContainerTop:l1III1I1II,resizerEl:l1111l11I1}}var I11ll1ll1l=I1lll1l1lI.dragData;I11ll1ll1l||(I11ll1ll1l={},I1lll1l1lI.dragData=I11ll1ll1l);var l11I11IIII,I11IIIIIll,I11l1lllI1=I1l1l111l1(l111ll11lI);I11ll1ll1l.mouseX=I11l1lllI1.x,I11ll1ll1l.mouseY=I11l1lllI1.y,I11ll1ll1l.mouseX4relative=I11l1lllI1.x+l11I1111Il-l1l1l111lI.x,I11ll1ll1l.mouseY4relative=I11l1lllI1.y+l1III1I1II-l1l1l111lI.y,I1II1I1II1?(l11I11IIII=I11ll1ll1l.startX,I11IIIIIll=I11ll1ll1l.startY):(l11I11IIII=I11ll1ll1l.startX+I11l1lllI1.x-I11ll1ll1l.startMouseX,I11IIIIIll=I11ll1ll1l.startY+I11l1lllI1.y-I11ll1ll1l.startMouseY,l11I11IIII+=l11I1111Il,I11IIIIIll+=l1III1I1II,l11ll111I1&&(l11I11IIII-=l11I1111Il,I11IIIIIll-=l1III1I1II));var l1111III1l=l11ll1ll1l.width(),I1ll1l1111=l11ll1ll1l.height();if(I11l11lllI||l1111lllIl){if((l11llllll1||l11l1lllll)&&l1111l11I1)if(l11llllll1){I11ll1ll1l.resizeTop=I11IIIIIll-I11ll1ll1l.startY+I11ll1ll1l.startResizeTop,I11ll1ll1l.resizeTop<I11ll1ll1l.fromResizeTop&&(I11ll1ll1l.resizeTop=I11ll1ll1l.fromResizeTop),I11ll1ll1l.resizeTop>I11ll1ll1l.toResizeTop&&(I11ll1ll1l.resizeTop=I11ll1ll1l.toResizeTop),I11ll1ll1l.resizeTop+I11ll1ll1l.startY<0&&(I11ll1ll1l.resizeTop=0-I11ll1ll1l.startY),I11ll1ll1l.resizeTop+I11ll1ll1l.startY>I11ll1ll1l.dropPos.height&&(I11ll1ll1l.resizeTop=I11ll1ll1l.dropPos.height-I11ll1ll1l.startY-I11ll1ll1l.lineWidth),l1lll111lI(l1111l11I1).css("top",I11ll1ll1l.resizeTop+"px");I111IIIIl1=I11ll1ll1l.resizeTop-I11ll1ll1l.startResizeTop;0!=l1l11ll1I1&&l1l11ll1I1!=I11ll1ll1l.lineRowLength-1||(0==l1l11ll1I1?(I11ll1ll1l.startHeight-I111IIIIl1<34&&(I111IIIIl1=I11ll1ll1l.startHeight-34),I11ll1ll1l.startY+I111IIIIl1<0&&(I111IIIIl1=-I11ll1ll1l.startY),I11ll1ll1l.resizeHeight=I11ll1ll1l.startHeight-I111IIIIl1,I11ll1ll1l.resizeY=I11ll1ll1l.startY+I111IIIIl1):(I11ll1ll1l.startHeight+I111IIIIl1<34?I11ll1ll1l.resizeHeight=34-I111IIIIl1:I11ll1ll1l.resizeHeight=I11ll1ll1l.startHeight+I111IIIIl1,I11ll1ll1l.resizeHeight+I11ll1ll1l.startY>l1l1l111lI.height&&(I11ll1ll1l.resizeHeight=l1l1l111lI.height-I11ll1ll1l.startY)))}else{I11ll1ll1l.resizeLeft=l11I11IIII-I11ll1ll1l.startX+I11ll1ll1l.startResizeLeft,I11ll1ll1l.resizeLeft<I11ll1ll1l.fromResizeLeft&&(I11ll1ll1l.resizeLeft=I11ll1ll1l.fromResizeLeft),I11ll1ll1l.resizeLeft>I11ll1ll1l.toResizeLeft&&(I11ll1ll1l.resizeLeft=I11ll1ll1l.toResizeLeft),I11ll1ll1l.resizeLeft+I11ll1ll1l.startX<0&&(I11ll1ll1l.resizeLeft=0-I11ll1ll1l.startX),I11ll1ll1l.resizeLeft+I11ll1ll1l.startX>I11ll1ll1l.dropPos.width&&(I11ll1ll1l.resizeLeft=I11ll1ll1l.dropPos.width-I11ll1ll1l.startX),l1lll111lI(l1111l11I1).css("left",I11ll1ll1l.resizeLeft+"px");var I111IIIIl1=I11ll1ll1l.resizeLeft-I11ll1ll1l.startResizeLeft;0!=l1I1I1I1I1&&l1I1I1I1I1!=I11ll1ll1l.lineColumnLength-1||(0==l1I1I1I1I1?(I11ll1ll1l.startWidth-I111IIIIl1<34&&(I111IIIIl1=I11ll1ll1l.startWidth-34),I11ll1ll1l.startX+I111IIIIl1<0&&(I111IIIIl1=-I11ll1ll1l.startX),I11ll1ll1l.resizeWidth=I11ll1ll1l.startWidth-I111IIIIl1,I11ll1ll1l.resizeX=I11ll1ll1l.startX+I111IIIIl1):(I11ll1ll1l.startWidth+I111IIIIl1<34?I11ll1ll1l.resizeWidth=34-I111IIIIl1:I11ll1ll1l.resizeWidth=I11ll1ll1l.startWidth+I111IIIIl1,I11ll1ll1l.resizeWidth+I11ll1ll1l.startX>l1l1l111lI.width&&(I11ll1ll1l.resizeWidth=l1l1l111lI.width-I11ll1ll1l.startX)))}else if(l1111lllIl)I11ll1ll1l.x=I11ll1ll1l.startX,I11ll1ll1l.y=I11ll1ll1l.startY;else{var l111II1IlI=l11I11IIII-I11ll1ll1l.startX+I11ll1ll1l.startWidth,I1111I1IIl=I11IIIIIll-I11ll1ll1l.startY+I11ll1ll1l.startHeight;l111II1IlI+I11ll1ll1l.startX>l1l1l111lI.width&&(l111II1IlI=l1l1l111lI.width-I11ll1ll1l.startX),I1111I1IIl+I11ll1ll1l.startY>l1l1l111lI.height&&(I1111I1IIl=l1l1l111lI.height-I11ll1ll1l.startY),I11ll1ll1l.width=l111II1IlI,I11ll1ll1l.height=I1111I1IIl,I11ll1ll1l.width<34&&(I11ll1ll1l.width=34),I11ll1ll1l.height<34&&(I11ll1ll1l.height=34),I11ll1ll1l.x<0&&(I11ll1ll1l.x=0),I11ll1ll1l.y<0&&(I11ll1ll1l.y=0),I11ll1ll1l.width+I11ll1ll1l.x>l1l1l111lI.width&&(I11ll1ll1l.width=l1l1l111lI.width-I11ll1ll1l.x),I11ll1ll1l.height+I11ll1ll1l.y>l1l1l111lI.height&&(I11ll1ll1l.height=l1l1l111lI.height-I11ll1ll1l.y)}I11ll1ll1l.x=I11ll1ll1l.startX,I11ll1ll1l.y=I11ll1ll1l.startY,I11ll1ll1l.x<0&&(I11ll1ll1l.x=0),I11ll1ll1l.y<0&&(I11ll1ll1l.y=0)}else l11ll111I1?(l11I11IIII<0&&(l11I11IIII=0),I11IIIIIll<0&&(I11IIIIIll=0),l11I11IIII+l1111III1l>l1l1l111lI.width&&(l11I11IIII=l1l1l111lI.width-l1111III1l),I11IIIIIll+I1ll1l1111>l1l1l111lI.height&&(I11IIIIIll=l1l1l111lI.height-I1ll1l1111)):(l11I11IIII<l1111I1I1I.left-l1l1l111lI.x&&(l11I11IIII=l1111I1I1I.left-l1l1l111lI.x),I11IIIIIll<l1111I1I1I.top-l1l1l111lI.y&&(I11IIIIIll=l1111I1I1I.top-l1l1l111lI.y),l11I11IIII+l1111III1l>l1l1l111lI.width&&(l11I11IIII=l1l1l111lI.width-l1111III1l),I11IIIIIll+I1ll1l1111>l1l1l111lI.height&&(I11IIIIIll=l1l1l111lI.height-I1ll1l1111)),I11ll1ll1l.x=l11I11IIII,I11ll1ll1l.y=I11IIIIIll;var I1I111I11l={left:I11ll1ll1l.x,top:I11ll1ll1l.y,width:I11ll1ll1l.width,height:I11ll1ll1l.height};l11l1lllll?0!=l1I1I1I1I1&&l1I1I1I1I1!=l11II1I1ll-1||(0==l1I1I1I1I1&&(I1I111I11l.left=I11ll1ll1l.resizeX),I1I111I11l.width=I11ll1ll1l.resizeWidth):l11llllll1&&(0!=l1l11ll1I1&&l1l11ll1I1!=I1II11I11I-1||(0==l1l11ll1I1&&(I1I111I11l.top=I11ll1ll1l.resizeY),I1I111I11l.height=I11ll1ll1l.resizeHeight)),l11ll1ll1l.css({left:I1I111I11l.left-l11I1111Il+l1l1l111lI.x+"px",top:I1I111I11l.top-l1III1I1II+l1l1l111lI.y+"px",width:I1I111I11l.width+"px",height:I1I111I11l.height+"px",display:"block"});var l11I111I11=I111II11ll.dragging;return l11l1l11l1.dragData=I11ll1ll1l,void(l11I111I11&&l11I111I11(l11l1l11l1))}}else{l1III111II="start",l1III11Ill.setAttribute("drag-status",l1III111II);var l11111l1l1=I111II11ll.dragStart;if(l11111l1l1){l11l1l11l1.e=l111ll11lI;var l1l11ll1lI=l11111l1l1(l11l1l11l1);if("boolean"==typeof l1l11ll1lI&&!l1l11ll1lI)return l1III111II="",void l1III11Ill.setAttribute("drag-status","")}}},I1I1I1IIll=function(l111ll11I1){return I1l1ll1lI1(l111ll11I1),!1},l11IIII11l=function(){document.onmousemove=function(I111ll11II){if(I1I1I1IIll.call(this,I111ll11II),document.onmousemove=null,I1lll1l1lI.timer4move)try{clearTimeout(I1lll1l1lI.timer4move),I1lll1l1lI.timer4move=null}catch(l111II11Il){}I1lll1l1lI.timer4move=window.setTimeout(function(){l11IIII11l(),I1lll1l1lI.timer4move=null},30)}};l11IIII11l();return document.onmouseup=function(I111ll11I1){if(document.onmousemove=null,document.onmouseup=null,1==l111II111I.button);else if(2==l111II111I.button)return!1;if(I111ll11I1.target.releaseCapture&&I111ll11I1.target.releaseCapture(),I1lll1l1lI.timer4move)try{clearTimeout(I1lll1l1lI.timer4move),I1lll1l1lI.timer4move=null}catch(I111ll1111){}var I1III11111=l1III11Ill.getAttribute("drag-status");if(l11l1l11l1.e=I111ll11I1,"dragging"==I1III11111){l11ll1ll1l.removeClass("proxy-dragging"),l111111lII.hide(),l11l11ll1l.hide(),l1III11I1l.removeClass("design-pointer-events"),I11l11lllI&&(l11ll1ll1l.removeClass("proxy-dragging-resize"),(l11l1lllll||l11llllll1)&&l1lll111lI(l1111l11I1).removeClass("line-dragging")),I1III11111="end",l1III11Ill.setAttribute("drag-status",I1III11111);var l1ll1l1l1l=I111II11ll.dragEnd;l1ll1l1l1l&&l1ll1l1l1l(l11l1l11l1),l1III11Ill.setAttribute("drag-status",""),l11ll1ll1l.hide()}return I111II11ll.up&&I111II11ll.up(l11l1l11l1),I1lll1l1lI.dragData=null,I1lll1l1lI.dragCfg=null,l11ll1ll1l[0].releaseCapture&&l11ll1ll1l[0].releaseCapture(),!1},!1})},findMergeCellsMapByTableLine:function(l111II11l1){return l111II11l1.style.mergeCellsMap||{}},addMergeCell:function(l111II11I1,I1III1111I){var l1II1I1III=l111II11I1.style.mergeCellsMap;l1II1I1III||(l1II1I1III={},l111II11I1.style.mergeCellsMap=l1II1I1III);var I1I1I1111l=I1III1111I.startColumnIndex,l11I111111=I1III1111I.startRowIndex,I1lll1l1II=I1III1111I.endColumnIndex,I1lll11llI=I1III1111I.endRowIndex;I1I1I1111l>I1lll1l1II&&(I1I1I1111l=I1lll1l1II),l11I111111>I1lll11llI&&(l11I111111=I1lll11llI),l1II1I1III[I1I1I1111l+"_"+l11I111111]=I1III1111I},removeMergeCellsByCellIndex:function(l111II111I,l1III111II,l1II1I1I11,l1I1I111l1,l11I1111ll){var I1lll1l1II=this,l1lll11lI1=I1lll1l1II.findMergeCellsByCellIndex(l111II111I,l1III111II,l1II1I1I11,l1I1I111l1,l11I1111ll);if(l1lll11lI1&&l1lll11lI1.length)for(var I111111lI1=0,I1l1llllIl=l1lll11lI1.length;I111111lI1<I1l1llllIl;I111111lI1++)I1lll1l1II.removeMergeCell(l111II111I,l1lll11lI1[I111111lI1])},findMergeCellsByCellIndex4Inner:function(I111II11ll,I1lll111l1,l1II1I1Ill,l1I1I111II,I11I1111Il){var I1III1I1I1=[],l1III11I1I=I111II11ll.style.mergeCellsMap;if(!l1III11I1I)return I1III1I1I1;for(var I111111I11 in l1III11I1I){var I1l1llllII=I111111I11.split("_"),I11ll1llIl=parseInt(I1l1llllII[0]),l11I11III1=parseInt(I1l1llllII[1]),I11IIIIIII=l1III11I1I[I111111I11].endColumnIndex,l11I1III1I=l1III11I1I[I111111I11].endRowIndex;l111II11I1:for(var I1111lllll=I1lll111l1;I1111lllll<=l1I1I111II;I1111lllll++)for(var l1II1I11II=l1II1I1Ill;l1II1I11II<=I11I1111Il;l1II1I11II++)if(I1111lllll>=I11ll1llIl&&I1111lllll<=I11IIIIIII&&l1II1I11II>=l11I11III1&&l1II1I11II<=l11I1III1I){I1III1I1I1.push(l1III11I1I[I111111I11]);break l111II11I1}}return I1III1I1I1},findMergeCellsByCellIndex:function(l111II11Il,I1III1111l,l1ll1l1lIl,I1l1l111ll,l11l111111){var I1lll1l11I=[],I1lll11lll=l111II11Il.style.mergeCellsMap;if(!I1lll11lll)return I1lll1l11I;for(var l111111lll in I1lll11lll){var I1I1IIII1l=l111111lll.split("_"),l11II1IIIl=parseInt(I1I1IIII1l[0]),l11I11III1=parseInt(I1I1IIII1l[1]),l11IIIIIII=I1lll11lll[l111111lll].endColumnIndex,l11I1IIII1=I1lll11lll[l111111lll].endRowIndex;l11II1IIIl>=I1III1111l&&l11IIIIIII<=I1l1l111ll&&l11I11III1>=l1ll1l1lIl&&l11I1IIII1<=l11l111111&&I1lll1l11I.push(I1lll11lll[l111111lll])}return I1lll1l11I},removeMergeCell:function(I111ll11ll,I1III111II){var l1ll1l1lll=I111ll11ll.style.mergeCellsMap;if(l1ll1l1lll){var l1l1l111ll=I1III111II.startColumnIndex,l11I1111lI=I1III111II.startRowIndex;l1ll1l1lll[l1l1l111ll+"_"+l11I1111lI]=null,delete l1ll1l1lll[l1l1l111ll+"_"+l11I1111lI]}},findRectsInTableLineByCellIndex:function(l111II11l1,l1III11111,I1II1I1II1,l1I1I111Il,I11l1111l1){for(var l1lll1l11I=this,l1lll11l1l=[],I111111Ill=l1III11111;I111111Ill<=l1I1I111Il;I111111Ill++)for(var l1I1IIIIll=I1II1I1II1;l1I1IIIIll<=I11l1111l1;l1I1IIIIll++){var I11ll1lll1=l1lll1l11I.findRectInTableLineByColumnAndRow(l111II11l1,I111111Ill,l1I1IIIIll);I11ll1lll1&&I11ll1lll1.controlId&&l1lll11l1l.push(I11ll1lll1)}return l1lll11l1l},findCellColspan:function(I111II111I,I1III111Il,l1ll1l1l1l){var l1I1I1111l=(I111II111I.style.mergeCellsMap||{})[I1III111Il+"_"+l1ll1l1l1l],l11I11111I=1;return l1I1I1111l&&(l11I11111I=l1I1I1111l.endColumnIndex-l1I1I1111l.startColumnIndex+1),l11I11111I},findCellRowspan:function(I111ll11l1,I1lll111l1,l1ll1l1ll1){var I1l1l111Il=(I111ll11l1.style.mergeCellsMap||{})[I1lll111l1+"_"+l1ll1l1ll1],l11l1111II=1;return I1l1l111Il&&(l11l1111II=I1l1l111Il.endRowIndex-I1l1l111Il.startRowIndex+1),l11l1111II},hasControlInTableCell:function(l111ll11I1,l1III111I1,l1ll1l1lIl){var l1I1I111I1=!1;return(l111ll11I1.style.cellsMap||{})[l1III111I1+"_"+l1ll1l1lIl]&&(l1I1I111I1=!0),l1I1I111I1},inDetail:function(I111ll11lI){var I1III11111=this,l1II1I1I1l=!1;if(I111ll11lI.style&&I111ll11lI.style.rect&&I111ll11lI.style.rect.tableLineId){var l1I1I111II=I1III11111.findTableLineControl(I111ll11lI.style.rect.tableLineId);l1I1I111II&&"detail"==l1I1I111II.controlType&&(l1II1I1I1l=!0)}return l1II1I1I1l},inDetailEndRow:function(I111II111l){var I1lll111I1=this,l1ll1l1lIl=!1;if(I111II111l.style&&I111II111l.style.rect&&I111II111l.style.rect.tableLineId){var l1I1I111I1=I1lll111I1.findTableLineControl(I111II111l.style.rect.tableLineId);l1I1I111I1&&"detail"==l1I1I111I1.controlType&&I111II111l.style.rect.rowIndex==l1I1I111I1.style.rowLines.length-1-1&&(l1ll1l1lIl=!0)}return l1ll1l1lIl},findControlInTableCell:function(l111ll111I,l1III11111,l1II1I1IlI){var l1l1l111II=this,l11I11111I=l111ll111I.style.cellsMap||{},l1III1I1I1=null;if(l11I11111I[l1III11111+"_"+l1II1I1IlI]){var I1III11Il1=l11I11111I[l1III11111+"_"+l1II1I1IlI].controlId;return I1III11Il1?(l1III1I1I1=l1l1l111II.getControlById(I1III11Il1),l1l1l111II.findFieldStyle4Dom(l1III1I1I1),l1l1l111II.findStyleFieldOuter4Dom(l1III1I1I1),l1III1I1I1):l1III1I1I1}return l1III1I1I1},getClientType:function(I111ll1111){return oui.util.getClientType(I111ll1111)},getControlRenderDataById:function(l111ll111l){var I1lll111ll=this,I1ll1l1l11={},I1I1I11111=I1lll111ll.getControlById(l111ll111l);if(I1I1I11111){I1ll1l1l11.showType=I1I1I11111.showType,I1ll1l1l11.control=I1I1I11111,I1ll1l1l11.style=I1lll111ll.findFieldStyle4Dom(I1I1I11111),I1ll1l1l11.cls="control-field-value-pabs",I1ll1l1l11.id="field-"+I1I1I11111.id,I1ll1l1l11.title=I1I1I11111.name,I1ll1l1l11.otherAttrs=I1I1I11111.otherAttrs||{};var I11l1111I1=I1I1I11111.placeholder||I1I1I11111.otherAttrs&&I1I1I11111.otherAttrs.placeholder||"";I11l1111I1&&(I1ll1l1l11.placeholder=I11l1111I1)}return I1ll1l1l11},getView:function(){return this.refs||(this.refs={}),this},findCells4Detail:function(l111ll1111){for(var l1lll1111l=this,l1ll1l1lI1=[],I1I1I111lI={},l11l1111l1=l111ll1111.style.columnLines||[],I1lll1l111=(l111ll1111.style.rowLines||[]).length-2,I1lll11ll1=0,I111111IlI=l11l1111l1.length-1;I1lll11ll1<I111111IlI;I1lll11ll1++){var I1l1llll1l=l1lll1111l.findTableCell(l111ll1111,I1lll11ll1,I1lll1l111);I1I1I111lI[I1l1llll1l.columnIndex+"_"+I1l1llll1l.rowIndex]||(I1I1I111lI[I1l1llll1l.columnIndex+"_"+I1l1llll1l.rowIndex]=I1l1llll1l,l1ll1l1lI1.push(I1l1llll1l))}return I1I1I111lI=null,delete I1I1I111lI,l1ll1l1lI1},findTableCell:function(I111II11I1,I1lll111l1,I1ll1l1lll){var l1I1I111ll={columnIndex:I1lll111l1,rowIndex:I1ll1l1lll};if((I111II11I1.style.cellsMap||{})[I1lll111l1+"_"+I1ll1l1lll])return l1I1I111ll;var I11I1111l1=I111II11I1.style.mergeCellsMap;if(I11I1111l1)for(var I1lll1l11l in I11I1111l1){var l1III11II1=I11I1111l1[I1lll1l11l];if(l1III11II1){if(l1III11II1.startColumnIndex==I1lll111l1&&l1III11II1.startRowIndex==I1ll1l1lll){l1I1I111ll.columnIndex=l1III11II1.startColumnIndex,l1I1I111ll.rowIndex=l1III11II1.startRowIndex;break}if(I1lll111l1>=l1III11II1.startColumnIndex&&I1lll111l1<=l1III11II1.endColumnIndex&&I1ll1l1lll>=l1III11II1.startRowIndex&&I1ll1l1lll<=l1III11II1.endRowIndex){l1I1I111ll.columnIndex=l1III11II1.startColumnIndex,l1I1I111ll.rowIndex=l1III11II1.startRowIndex;break}}}return l1I1I111ll},hasTableCell:function(I111ll11lI,I1III1111I,l1II1I1I1I){var I1l1l1111I=!0;if((I111ll11lI.style.cellsMap||{})[I1III1111I+"_"+l1II1I1I1I])return I1l1l1111I;var I11I111111=I111ll11lI.style.mergeCellsMap;if(I11I111111){for(var I1lll1l1ll in I11I111111){var l1III11IIl=I11I111111[I1lll1l1ll];if(l1III11IIl){if(l1III11IIl.startColumnIndex==I1III1111I&&l1III11IIl.startRowIndex==l1II1I1I1I){I1l1l1111I=!0;break}if(I1III1111I>=l1III11IIl.startColumnIndex&&I1III1111I<=l1III11IIl.endColumnIndex&&l1II1I1I1I>=l1III11IIl.startRowIndex&&l1II1I1I1I<=l1III11IIl.endRowIndex){I1l1l1111I=!1;break}}}return I1l1l1111I}return I1l1l1111I},findColumnPos:function(I111II11l1,I1lll111lI,l1II1I1I1I){var I1I1I111I1=I111II11l1.style.columnLines[I1lll111lI].fromPos.left,I11l1111Il=I111II11l1.style.columnLines[I1lll111lI+1].fromPos.left-I1I1I111I1+l1lll11llI.operationAreaOffset/2,I1III1I11I=I111II11l1.style.columnLines[I1lll111lI].config.lineHeight,l1lll11l1I=I111II11l1.style.columnLines[I1lll111lI+1].config.lineHeight,I111111I11=I111II11l1.style.columnLines[I1lll111lI].config.color,l1l1llll11=I111II11l1.style.columnLines[I1lll111lI+1].config.color,I11II1II11=I111II11l1.style.columnLines.length,l11l11lllI={left:I1I1I111I1,width:I11l1111Il,borderLeftWidth:I1III1I11I,borderLeftColor:I111111I11,borderRightColor:l1l1llll11,borderLeftStyle:I111II11l1.style.columnLines[I1lll111lI].config.borderStyle||"solid",borderRightStyle:I111II11l1.style.columnLines[I1lll111lI+1].config.borderStyle||"solid",borderRightWidth:I1lll111lI==I11II1II11-2?l1lll11l1I:0};return l1II1I1I1I?l11l11lllI[l1II1I1I1I]:l11l11lllI},findRowPos:function(l111II11ll,I1III111I1,l1ll1l1l1I){var I1l1l111II=l111II11ll.style.rowLines[I1III111I1].fromPos.top,l11I1111I1=l111II11ll.style.rowLines[I1III111I1+1].fromPos.top-I1l1l111II+l1lll11llI.operationAreaOffset/2,I1III1I1Il=l111II11ll.style.rowLines[I1III111I1].config.lineHeight,I1lll11lIl=l111II11ll.style.rowLines[I1III111I1+1].config.lineHeight,I111111l1l=l111II11ll.style.rowLines[I1III111I1].config.color,I1l1llll1I=l111II11ll.style.rowLines[I1III111I1+1].config.color,I11ll1llII=l111II11ll.style.rowLines.length,l11I11IIll={top:I1l1l111II,height:l11I1111I1,borderTopWidth:I1III1I1Il,borderTopColor:I111111l1l,borderBottomColor:I1l1llll1I,borderTopStyle:l111II11ll.style.rowLines[I1III111I1].config.borderStyle||"solid",borderBottomStyle:l111II11ll.style.rowLines[I1III111I1+1].config.borderStyle||"solid",borderBottomWidth:I1III111I1==I11ll1llII-2?I1lll11lIl:0};return l1ll1l1l1I?l11I11IIll[l1ll1l1l1I]:l11I11IIll},event2merge:function(l111ll11Il){var l1III1111I=this,I1ll1l1lI1=l1III1111I.data.currentControl;if(I1ll1l1lI1&&"tableLine"==I1ll1l1lI1.htmlType&&l1III1111I.selectRect){(l1III1111I.selectRect.isSelectColumn||l1III1111I.selectRect.isSelectRow)&&(l1III1111I.selectRect=l1III1111I.findMaxArea(I1ll1l1lI1,l1III1111I.selectRect.startRect,l1III1111I.selectRect.endRect));var I1l1l111l1=l1III1111I.selectRect.startColumnIndex,I11I1111lI=l1III1111I.selectRect.startRowIndex,I1III1I1ll=l1III1111I.selectRect.endColumnIndex,I1lll11lII=l1III1111I.selectRect.endRowIndex,I111111I1l=!0;if(I1l1l111l1==I1III1I1ll&&I11I1111lI==I1lll11lII&&(I111111I1l=!1),(I1l1l111l1<0||I1III1I1ll<0||I11I1111lI<0||I1lll11lII<0)&&(I111111I1l=!1),I111111I1l){var l1l1llll1I=I1ll1l1lI1.style.mergeCellsMap;l1l1llll1I||(l1l1llll1I={},I1ll1l1lI1.style.mergeCellsMap=l1l1llll1I);var I11ll1ll1I=l1III1111I.findRectsInTableLineByCellIndex(I1ll1l1lI1,I1l1l111l1,I11I1111lI,I1III1I1ll,I1lll11lII);if(I11ll1ll1I&&I11ll1ll1I.length>1)oui.getTop().oui.alert("当前选择单元格区域含有多个控件不能进行合并");else{if(l1III1111I.removeMergeCellsByCellIndex(I1ll1l1lI1,I1l1l111l1,I11I1111lI,I1III1I1ll,I1lll11lII),l1III1111I.addMergeCell(I1ll1l1lI1,oui.parseJson(oui.parseString(l1III1111I.selectRect))),1==I11ll1ll1I.length){var l11l11llI1={controlId:I11ll1ll1I[0].controlId,tableLineId:I11ll1ll1I[0].tableLineId};l11l11llI1.columnIndex=I1l1l111l1,l11l11llI1.rowIndex=I11I1111lI,l11l11llI1.left=l1III1111I.selectRect.left,l11l11llI1.top=l1III1111I.selectRect.top,l11l11llI1.right=l1III1111I.selectRect.right,l11l11llI1.bottom=l1III1111I.selectRect.bottom,l11l11llI1.rowspan=l1III1111I.selectRect.endRowIndex-l1III1111I.selectRect.startRowIndex+1,l11l11llI1.colspan=l1III1111I.selectRect.endColumnIndex-l1III1111I.selectRect.startColumnIndex+1;var I11lllllI1=l1III1111I.getControlById(l11l11llI1.controlId);l1III1111I.removeRect4Control(I11lllllI1),l1III1111I.removeRectInTableLineByColumnAndRow(I1ll1l1lI1,I11ll1ll1I[0].columnIndex,I11ll1ll1I[0].rowIndex),l1III1111I.setRectInTableLineByColumnAndRow(I1ll1l1lI1,l11l11llI1),I11lllllI1.style.rect=l11l11llI1,I11lllllI1.style.left=l11l11llI1.left,I11lllllI1.style.top=l11l11llI1.top,I11lllllI1.style.width=l11l11llI1.right-l11l11llI1.left,I11lllllI1.style.height=l11l11llI1.bottom-l11l11llI1.top;var I11I1IIIl1=l1lll111lI("#"+I11lllllI1.id,".ppt-paper-area")[0];I11I1IIIl1.style.left=I11lllllI1.style.left+"px",I11I1IIIl1.style.top=I11lllllI1.style.top+"px",I11I1IIIl1.style.width=I11lllllI1.style.width+"px",I11I1IIIl1.style.height=I11lllllI1.style.height+"px"}l1III1111I.hideOperationArea(),l1III1111I.changed4props(l111ll11Il)}}}},event2split:function(I111II111I){var l1III111II=this,I1ll1l1l11=l1III111II.data.currentControl;if(I1ll1l1l11&&"tableLine"==I1ll1l1l11.htmlType&&l1III111II.selectRect){(l1III111II.selectRect.isSelectColumn||l1III111II.selectRect.isSelectRow)&&(l1III111II.selectRect=l1III111II.findMaxArea(I1ll1l1l11,l1III111II.selectRect.startRect,l1III111II.selectRect.endRect));var I1I1I111Il=l1III111II.selectRect.startColumnIndex,l11l1111lI=l1III111II.selectRect.startRowIndex,I1III1I1II=l1III111II.selectRect.endColumnIndex,I1lll11lll=l1III111II.selectRect.endRowIndex,l111111IlI=!0;if(I1I1I111Il==I1III1I1II&&l11l1111lI==I1lll11lll&&(l111111IlI=!1),(I1I1I111Il<0||I1III1I1II<0||l11l1111lI<0||I1lll11lll<0)&&(l111111IlI=!1),I1ll1l1l11.style.mergeCellsMap||(l111111IlI=!1),l111111IlI){var l1I1IIIIl1=l1III111II.findMergeCellsByCellIndex(I1ll1l1l11,I1I1I111Il,l11l1111lI,I1III1I1II,I1lll11lll),I11II1IIII=[],I11l11llll={};if(l1I1IIIIl1&&l1I1IIIIl1.length){for(var l11llllllI=I1ll1l1l11.style.left,I11l1lll11=I1ll1l1l11.style.top,I1111IIIlI=I1ll1l1l11.style.borderLeftWidth,I1II1I11I1=I1ll1l1l11.style.borderTopWidth,l111IIII1I=I1ll1l1l11.style.rowLines||[],I111ll1l1I=I1ll1l1l11.style.columnLines||[],I1111I1Il1=0,l1l111l111=l1I1IIIIl1.length;I1111I1Il1<l1l111l111;I1111I1Il1++){var l11I111I1l=l1III111II.findRectsInTableLineByCellIndex(I1ll1l1l11,l1I1IIIIl1[I1111I1Il1].startColumnIndex,l1I1IIIIl1[I1111I1Il1].startRowIndex,l1I1IIIIl1[I1111I1Il1].endColumnIndex,l1I1IIIIl1[I1111I1Il1].endRowIndex);if(l11I111I1l&&1==l11I111I1l.length){var I11111l1l1={controlId:l11I111I1l[0].controlId,tableLineId:l11I111I1l[0].tableLineId};I11111l1l1.columnIndex=l1I1IIIIl1[I1111I1Il1].startColumnIndex,I11111l1l1.rowIndex=l1I1IIIIl1[I1111I1Il1].startRowIndex,I11111l1l1.left=l1I1IIIIl1[I1111I1Il1].left,I11111l1l1.top=l1I1IIIIl1[I1111I1Il1].top,I11111l1l1.right=l11llllllI+I1111IIIlI+I111ll1l1I[l1I1IIIIl1[I1111I1Il1].startColumnIndex+1].fromPos.left,I11111l1l1.bottom=I11l1lll11+I1II1I11I1+l111IIII1I[l1I1IIIIl1[I1111I1Il1].startRowIndex+1].fromPos.top;var l1I11II1Il=l1III111II.getControlById(I11111l1l1.controlId);l1III111II.removeRect4Control(l1I11II1Il),l1III111II.removeRectInTableLineByColumnAndRow(I1ll1l1l11,l11I111I1l[0].columnIndex,l11I111I1l[0].rowIndex),l1III111II.setRectInTableLineByColumnAndRow(I1ll1l1l11,I11111l1l1),l1I11II1Il.style.rect=I11111l1l1,l1I11II1Il.style.left=I11111l1l1.left,l1I11II1Il.style.top=I11111l1l1.top,l1I11II1Il.style.width=I11111l1l1.right-I11111l1l1.left,l1I11II1Il.style.height=I11111l1l1.bottom-I11111l1l1.top,I11II1IIII.push(l1I11II1Il.id),I11l11llll[l1I11II1Il.id]=l1I11II1Il}else l11I111I1l&&l11I111I1l.length>1&&(console.log("error:find many control in mergeCell"),console.log(l11I111I1l));l1III111II.removeMergeCell(I1ll1l1l11,l1I1IIIIl1[I1111I1Il1])}if(I11II1IIII&&I11II1IIII.length){var I1I1I1I111="#"+I11II1IIII.join(",#");l1lll111lI(I1I1I1I111,".ppt-paper-area").each(function(){var l111II11l1=this.getAttribute("id"),I1lll111Il=this;l1I11II1Il=I11l11llll[l111II11l1],I1lll111Il.style.left=l1I11II1Il.style.left+"px",I1lll111Il.style.top=l1I11II1Il.style.top+"px",I1lll111Il.style.width=l1I11II1Il.style.width+"px",I1lll111Il.style.height=l1I11II1Il.style.height+"px"})}l1III111II.hideOperationArea(),l1III111II.changed4props(I111II111I)}}}},event2insertColumn4prev:function(I111II11l1){var l1III111lI=this,l1II1I1I1I=(new Date,l1III111lI.data.currentControl);if(l1II1I1I1I&&"tableLine"==l1II1I1I1I.htmlType&&l1III111lI.selectRect){var I1l1l1111l=l1III111lI.selectRect.startColumnIndex,l11l1111Il=l1III111lI.selectRect.startRowIndex,l1lll1l1ll=l1III111lI.selectRect.endColumnIndex,I1lll11lII=l1III111lI.selectRect.endRowIndex,l111111l11=!0;if((I1l1l1111l<0||l1lll1l1ll<0||l11l1111Il<0||I1lll11lII<0)&&(l111111l11=!1),l111111l11){for(var I1l1llll1l=l1III111lI.selectRect.endColumnIndex-l1III111lI.selectRect.startColumnIndex+1,l11ll1ll1l=l1II1I1I1I.style.columnLines,I11I11IIll=l1II1I1I1I.style.columnLines[I1l1l1111l],l11llllllI=[],I11I1IIII1=50*I1l1llll1l,I1111llll1=[I1l1l1111l,0],I1II1I111I=0;I1II1I111I<I1l1llll1l;I1II1I111I++){var l111IIIIlI=oui.parseJson(oui.parseString(I11I11IIll));l111IIIIlI.fromPos.left+=50*I1II1I111I,l111IIIIlI.toPos&&(l111IIIIlI.toPos.left=l111IIIIlI.fromPos.left),l11llllllI.push(l111IIIIlI)}I1111llll1=I1111llll1.concat(l11llllllI),l11ll1ll1l.splice.apply(l11ll1ll1l,I1111llll1),l1II1I1I1I.style.width+=I11I1IIII1;for(var l111II1Ill=I1l1l1111l+I1l1llll1l,I1111I1I1l=l11ll1ll1l.length;l111II1Ill<I1111I1I1l;l111II1Ill++){var l1l111l1I1=l1II1I1I1I.style.columnLines[l111II1Ill];l1l111l1I1.fromPos.left+=I11I1IIII1,l1l111l1I1.toPos&&(l1l111l1I1.toPos.left=l1l111l1I1.fromPos.left)}var I11l111ll1=l1II1I1I1I.style.cellsMap||{},I11111l1ll={};for(var I1l11ll11I in I11l111ll1)if(I1l111llII=I11l111ll1[I1l11ll11I]){if(I1l111llII.columnIndex>=I1l1l1111l)I1l111llII.columnIndex+=I1l1llll1l,(l1I1I1I1Il=l1III111lI.getControlById(I1l111llII.controlId))&&(l1I1I1I1Il.style.rect=I1l111llII);else if(I1l111llII.colspan&&I1l111llII.colspan>1&&I1l1l1111l>I1l111llII.columnIndex&&I1l111llII.columnIndex+I1l111llII.colspan-1>=I1l1l1111l){I1l111llII.colspan+=I1l1llll1l;var l1I1I1I1Il=l1III111lI.getControlById(I1l111llII.controlId);l1I1I1I1Il&&(l1I1I1I1Il.style.rect=I1l111llII)}I11111l1ll[I1l111llII.columnIndex+"_"+I1l111llII.rowIndex]=I1l111llII}l1II1I1I1I.style.cellsMap=I11111l1ll;var I11ll1l11l=l1II1I1I1I.style.mergeCellsMap;if(I11ll1l11l){var I1II11I1II={};for(var l111II1Ill in I11ll1l11l){var I1l111llII=I11ll1l11l[l111II1Ill];I1l111llII.startColumnIndex>=I1l1l1111l?(I1l111llII.startColumnIndex+=I1l1llll1l,I1l111llII.endColumnIndex+=I1l1llll1l):I1l111llII.startColumnIndex<I1l1l1111l&&I1l111llII.endColumnIndex>=I1l1l1111l&&(I1l111llII.endColumnIndex+=I1l1llll1l),I1II11I1II[I1l111llII.startColumnIndex+"_"+I1l111llII.startRowIndex]=I1l111llII}l1II1I1I1I.style.mergeCellsMap=I1II11I1II}l1III111lI.updateControlsInTableLine(l1II1I1I1I,{resizeColumnIndex:0==I1l1l1111l?-1:I1l1l1111l,resizeRowIndex:-1}),l1III111lI.selectRect=l1III111lI.findRectBySelectRect(l1II1I1I1I,l1III111lI.selectRect),l1III111lI.changed4props({},function(){l1III111lI.hideOperationArea(),l1III111lI.showOperationArea(l1II1I1I1I),l1III111lI.setCurrPropsData(l1II1I1I1I,"center","dragEndField")})}}},event2insertRow4prev:function(I111II11II){var I1lll111Il=this,l1ll1l1ll1=(new Date,I1lll111Il.data.currentControl);if(l1ll1l1ll1&&"tableLine"==l1ll1l1ll1.htmlType&&I1lll111Il.selectRect){var l1I1I1111l=I1lll111Il.selectRect.startColumnIndex,I11I1111Il=I1lll111Il.selectRect.startRowIndex,I1III1I111=I1lll111Il.selectRect.endColumnIndex,I1lll11lIl=I1lll111Il.selectRect.endRowIndex,l111111I1l=!0;if((l1I1I1111l<0||I1III1I111<0||I11I1111Il<0||I1lll11lIl<0)&&(l111111I1l=!1),l111111I1l){for(var I1l1llllI1=I1lll111Il.selectRect.endRowIndex-I1lll111Il.selectRect.startRowIndex+1,l11II1IIll=l1ll1l1ll1.style.rowLines,l11l11ll1I=l1ll1l1ll1.style.rowLines[I11I1111Il],I11llllllI=(oui.parseJson(oui.parseString(l11l11ll1I)),50*I1l1llllI1),I11l1lllII=[I11I1111Il,0],I1111III11=[],I1ll1l11ll=0;I1ll1l11ll<I1l1llllI1;I1ll1l11ll++){var l111llll11=oui.parseJson(oui.parseString(l11l11ll1I));l111llll11.fromPos.top+=50*I1ll1l11ll,l111llll11.toPos&&(l111llll11.toPos.top=l111llll11.fromPos.top),I1111III11.push(l111llll11)}I11l1lllII=I11l1lllII.concat(I1111III11),l11II1IIll.splice.apply(l11II1IIll,I11l1lllII),l1ll1l1ll1.style.height+=I11llllllI;for(var l111ll1lll=I11I1111Il+I1l1llllI1,I1111l1llI=l11II1IIll.length;l111ll1lll<I1111l1llI;l111ll1lll++){var I1I111I11l=l1ll1l1ll1.style.rowLines[l111ll1lll];I1I111I11l.fromPos.top+=I11llllllI,I1I111I11l.toPos&&(I1I111I11l.toPos.top=I1I111I11l.fromPos.top)}var l11I111IlI=l1ll1l1ll1.style.cellsMap||{},l11111l1Il={};for(var l1l11ll111 in l11I111IlI)if(l1l111ll1I=l11I111IlI[l1l11ll111]){if(l1l111ll1I.rowIndex>=I11I1111Il)l1l111ll1I.rowIndex+=I1l1llllI1,(l1I1I1I1l1=I1lll111Il.getControlById(l1l111ll1I.controlId))&&(l1I1I1I1l1.style.rect=l1l111ll1I);else if(l1l111ll1I.rowspan&&l1l111ll1I.rowspan>1&&I11I1111Il>l1l111ll1I.rowIndex&&l1l111ll1I.rowIndex+l1l111ll1I.rowspan-1>=I11I1111Il){l1l111ll1I.rowspan+=I1l1llllI1;var l1I1I1I1l1=I1lll111Il.getControlById(l1l111ll1I.controlId);l1I1I1I1l1&&(l1I1I1I1l1.style.rect=l1l111ll1I)}l11111l1Il[l1l111ll1I.columnIndex+"_"+l1l111ll1I.rowIndex]=l1l111ll1I}l1ll1l1ll1.style.cellsMap=l11111l1Il;var l11II1I11l=l1ll1l1ll1.style.mergeCellsMap;if(l11II1I11l){var l1ll11l1I1={};for(var l111ll1lll in l11II1I11l){var l1l111ll1I=l11II1I11l[l111ll1lll];l1l111ll1I.startRowIndex>=I11I1111Il?(l1l111ll1I.startRowIndex+=I1l1llllI1,l1l111ll1I.endRowIndex+=I1l1llllI1):l1l111ll1I.startRowIndex<I11I1111Il&&l1l111ll1I.endRowIndex>=I11I1111Il&&(l1l111ll1I.endRowIndex+=I1l1llllI1),l1ll11l1I1[l1l111ll1I.startColumnIndex+"_"+l1l111ll1I.startRowIndex]=l1l111ll1I}l1ll1l1ll1.style.mergeCellsMap=l1ll11l1I1}I1lll111Il.updateControlsInTableLine(l1ll1l1ll1,{resizeColumnIndex:-1,resizeRowIndex:0==I11I1111Il?-1:I11I1111Il}),I1lll111Il.selectRect=I1lll111Il.findRectBySelectRect(l1ll1l1ll1,I1lll111Il.selectRect),I1lll111Il.changed4props({},function(){I1lll111Il.hideOperationArea(),I1lll111Il.showOperationArea(l1ll1l1ll1),I1lll111Il.setCurrPropsData(l1ll1l1ll1,"center","dragEndField")})}}},event2removeColumn:function(I111ll11Il){var I1lll111Il=this,I1II1I1I11=(new Date,I1lll111Il.data.currentControl);if(I1II1I1I11&&"tableLine"==I1II1I1I11.htmlType&&I1lll111Il.selectRect){var I1l1l11111=I1lll111Il.selectRect.startColumnIndex,I11l1111II=I1lll111Il.selectRect.startRowIndex,I1lll1l1Il=I1lll111Il.selectRect.endColumnIndex,l1lll11lIl=I1lll111Il.selectRect.endRowIndex,I111111l1l=!0;if((I1l1l11111<0||I1lll1l1Il<0||I11l1111II<0||l1lll11lIl<0)&&(I111111l1l=!1),I1II1I1I11.style.columnLines.length-2<=0)I111111l1l=!1;else if(I1l1l11111>I1II1I1I11.style.columnLines.length-2&&(I111111l1l=!1),I111111l1l){var l1I1IIIIIl=I1lll111Il.selectRect.endColumnIndex-I1lll111Il.selectRect.startColumnIndex+1,I11ll1llII=I1II1I1I11.style.columnLines;l1I1IIIIIl>=I11ll1llII.length-2&&(l1I1IIIIIl=I11ll1llII.length-2);var I11I11II1l=I1II1I1I11.style.columnLines[I1l1l11111],l11lllllIl=I1II1I1I11.style.columnLines[I1lll1l1Il+1].fromPos.left-I11I11II1l.fromPos.left;I11ll1llII.splice(I1l1l11111,l1I1IIIIIl),I1II1I1I11.style.width-l11lllllIl<30&&(l11lllllIl=I1II1I1I11.style.width-I1II1I1I11.style.columnLines[1].fromPos.left+I1II1I1I11.style.columnLines[0].fromPos.left),I1II1I1I11.style.width-=l11lllllIl;for(var l11I1III1I=I1l1l11111,I1111IIIll=I11ll1llII.length;l11I1III1I<I1111IIIll;l11I1III1I++){var l1ll1l11ll=I1II1I1I11.style.columnLines[l11I1III1I];l1ll1l11ll.fromPos.left-=l11lllllIl,l1ll1l11ll.toPos&&(l1ll1l11ll.toPos.left-=l11lllllIl)}var l111IIIIIl=I1II1I1I11.style.cellsMap||{},I111ll1lI1={};for(var I1111I1I1I in l111IIIIIl)if(I1l11ll1II=l111IIIIIl[I1111I1I1I]){l1I1I1I1ll=!0;if(I1l11ll1II.columnIndex>=I1l1l11111)I1l11ll1II.columnIndex==I1l1l11111?I1l11ll1II.colspan&&I1l11ll1II.colspan>1?(I1l11ll1II.colspan-=l1I1IIIIIl,I1l11ll1II.colspan<1&&(l1I1I1I1ll=!1),I1l11ll1II.colspan<2&&delete I1l11ll1II.colspan):l1I1I1I1ll=!1:(I1l11ll1II.columnIndex-=l1I1IIIIIl,I1l11ll1II.columnIndex<0&&(l1I1I1I1ll=!1)),(I1I111I1Il=I1lll111Il.getControlById(I1l11ll1II.controlId))&&(l1I1I1I1ll?I1I111I1Il.style.rect=I1l11ll1II:(I1I111I1Il.style.rect=null,delete I1I111I1Il.style.rect));else if(I1l11ll1II.colspan&&I1l11ll1II.colspan>1&&I1l1l11111>I1l11ll1II.columnIndex&&I1l11ll1II.columnIndex+I1l11ll1II.colspan-1>=I1l1l11111){I1l11ll1II.colspan-=l1I1IIIIIl,I1l11ll1II.colspan<1&&(l1I1I1I1ll=!1),I1l11ll1II.colspan<2&&delete I1l11ll1II.colspan;var I1I111I1Il=I1lll111Il.getControlById(I1l11ll1II.controlId);I1I111I1Il&&(l1I1I1I1ll?I1I111I1Il.style.rect=I1l11ll1II:(I1I111I1Il.style.rect=null,delete I1I111I1Il.style.rect))}l1I1I1I1ll&&(I111ll1lI1[I1l11ll1II.columnIndex+"_"+I1l11ll1II.rowIndex]=I1l11ll1II)}I1II1I1I11.style.cellsMap=I111ll1lI1;var I11l111ll1=I1II1I1I11.style.mergeCellsMap;if(I11l111ll1){var l11111I1lI={};for(var l11I1III1I in I11l111ll1){var I1l11ll1II=I11l111ll1[l11I1III1I],l1I1I1I1ll=!0;I1l11ll1II.startColumnIndex>=I1l1l11111?I1l11ll1II.startColumnIndex==I1l1l11111?(I1l11ll1II.endColumnIndex-=l1I1IIIIIl,I1l11ll1II.startColumnIndex>=I1l11ll1II.endColumnIndex&&(l1I1I1I1ll=!1)):(I1l11ll1II.startColumnIndex-=l1I1IIIIIl,I1l11ll1II.endColumnIndex-=l1I1IIIIIl,I1l11ll1II.startColumnIndex<0&&(l1I1I1I1ll=!1)):I1l11ll1II.startColumnIndex<I1l1l11111&&I1l11ll1II.endColumnIndex>=I1l1l11111&&(I1l11ll1II.endColumnIndex-=l1I1IIIIIl,I1l11ll1II.startColumnIndex>=I1l11ll1II.endColumnIndex&&(l1I1I1I1ll=!1)),l1I1I1I1ll&&(l11111I1lI[I1l11ll1II.startColumnIndex+"_"+I1l11ll1II.startRowIndex]=I1l11ll1II)}I1II1I1I11.style.mergeCellsMap=l11111I1lI}I1lll111Il.updateControlsInTableLine(I1II1I1I11,{resizeColumnIndex:0==I1l1l11111?-1:I1l1l11111,resizeRowIndex:-1}),I1lll111Il.selectRect=I1lll111Il.findRectBySelectRect(I1II1I1I11,I1lll111Il.selectRect),I1lll111Il.changed4props({},function(){I1lll111Il.hideOperationArea(),I1lll111Il.showOperationArea(I1II1I1I11),I1lll111Il.setCurrPropsData(I1II1I1I11,"center","dragEndField")})}}},event2removeRow:function(I111ll1111){var I1III111Il=this,I1ll1l1l1I=I1III111Il.data.currentControl;if(I1ll1l1l1I&&"tableLine"==I1ll1l1l1I.htmlType&&I1III111Il.selectRect){var l1l1l1111I=I1III111Il.selectRect.startColumnIndex,I11l1111ll=I1III111Il.selectRect.startRowIndex,I1III1I111=I1III111Il.selectRect.endColumnIndex,I1lll11lI1=I1III111Il.selectRect.endRowIndex,l111111l11=!0;if((l1l1l1111I<0||I1III1I111<0||I11l1111ll<0||I1lll11lI1<0)&&(l111111l11=!1),I1ll1l1l1I.style.rowLines.length-2<=0)l111111l11=!1;else if(I11l1111ll>I1ll1l1l1I.style.rowLines.length-2&&(l111111l11=!1),l111111l11){var l1l1llllII=I1III111Il.selectRect.endRowIndex-I1III111Il.selectRect.startRowIndex+1,I11II1IIIl=I1ll1l1l1I.style.rowLines;l1l1llllII>=I11II1IIIl.length-2&&(l1l1llllII=I11II1IIIl.length-2);var l11I11III1=I1ll1l1l1I.style.rowLines[I11l1111ll],I11lllll1I=I1ll1l1l1I.style.rowLines[I1lll11lI1+1].fromPos.top-l11I11III1.fromPos.top;I1ll1l1l1I.style.height-I11lllll1I<30&&(I11lllll1I=I1ll1l1l1I.style.height-I1ll1l1l1I.style.rowLines[1].fromPos.top+I1ll1l1l1I.style.rowLines[0].fromPos.top),I11II1IIIl.splice(I11l1111ll,l1l1llllII),I1ll1l1l1I.style.height-=I11lllll1I;for(var l11l1lll1I=I11l1111ll,l1111III11=I11II1IIIl.length;l11l1lll1I<l1111III11;l11l1lll1I++){var I1ll1l11Il=I11II1IIIl[l11l1lll1I];I1ll1l11Il.fromPos.top-=I11lllll1I,I1ll1l11Il.toPos&&(I1ll1l11Il.toPos.top-=I11lllll1I)}var l111IIIIl1=I1ll1l1l1I.style.cellsMap||{},l111II1IlI={};for(var I1111I1IlI in l111IIIIl1)if(l1I11II1ll=l111IIIIl1[I1111I1IlI]){I1I1I1I1l1=!0;if(l1I11II1ll.rowIndex>=I11l1111ll)l1I11II1ll.rowIndex==I11l1111ll?l1I11II1ll.rowspan&&l1I11II1ll.rowspan>1?(l1I11II1ll.rowspan-=l1l1llllII,l1I11II1ll.rowspan<1&&(I1I1I1I1l1=!1),l1I11II1ll.rowspan<2&&delete l1I11II1ll.rowspan):I1I1I1I1l1=!1:(l1I11II1ll.rowIndex-=l1l1llllII,l1I11II1ll.rowIndex<0&&(I1I1I1I1l1=!1)),(l1I111I11I=I1III111Il.getControlById(l1I11II1ll.controlId))&&(I1I1I1I1l1?l1I111I11I.style.rect=l1I11II1ll:(l1I111I11I.style.rect=null,delete l1I111I11I.style.rect));else if(l1I11II1ll.rowspan&&l1I11II1ll.rowspan>1&&I11l1111ll>l1I11II1ll.rowIndex&&l1I11II1ll.rowIndex+l1I11II1ll.rowspan-1>=I11l1111ll){l1I11II1ll.rowspan-=l1l1llllII,l1I11II1ll.rowspan<1&&(I1I1I1I1l1=!1),l1I11II1ll.rowspan<2&&delete l1I11II1ll.rowspan;var l1I111I11I=I1III111Il.getControlById(l1I11II1ll.controlId);l1I111I11I&&(I1I1I1I1l1?l1I111I11I.style.rect=l1I11II1ll:(l1I111I11I.style.rect=null,delete l1I111I11I.style.rect))}I1I1I1I1l1&&(l111II1IlI[l1I11II1ll.columnIndex+"_"+l1I11II1ll.rowIndex]=l1I11II1ll)}I1ll1l1l1I.style.cellsMap=l111II1IlI;var l11l111llI=I1ll1l1l1I.style.mergeCellsMap;if(l11l111llI){var l11111I11I={};for(var l11l1lll1I in l11l111llI){var l1I11II1ll=l11l111llI[l11l1lll1I],I1I1I1I1l1=!0;l1I11II1ll.startRowIndex>=I11l1111ll?l1I11II1ll.startRowIndex==I11l1111ll?(l1I11II1ll.endRowIndex-=l1l1llllII,l1I11II1ll.startRowIndex>=l1I11II1ll.endRowIndex&&(I1I1I1I1l1=!1)):(l1I11II1ll.startRowIndex-=l1l1llllII,l1I11II1ll.endRowIndex-=l1l1llllII,l1I11II1ll.startRowIndex<0&&(I1I1I1I1l1=!1)):l1I11II1ll.startRowIndex<I11l1111ll&&l1I11II1ll.endRowIndex>=I11l1111ll&&(l1I11II1ll.endRowIndex-=l1l1llllII,l1I11II1ll.startRowIndex>=l1I11II1ll.endRowIndex&&(I1I1I1I1l1=!1)),I1I1I1I1l1&&(l11111I11I[l1I11II1ll.startColumnIndex+"_"+l1I11II1ll.startRowIndex]=l1I11II1ll)}I1ll1l1l1I.style.mergeCellsMap=l11111I11I}I1III111Il.updateControlsInTableLine(I1ll1l1l1I,{resizeColumnIndex:-1,resizeRowIndex:0==I11l1111ll?-1:I11l1111ll}),I1III111Il.selectRect=I1III111Il.findRectBySelectRect(I1ll1l1l1I,I1III111Il.selectRect),I1III111Il.changed4props({},function(){I1III111Il.hideOperationArea(),I1III111Il.showOperationArea(I1ll1l1l1I),I1III111Il.setCurrPropsData(I1ll1l1l1I,"center","dragEndField")})}}},buildCanvasByControlId:function(l111II11I1,I1III111II){var I1ll1l1llI=this.getControlById(l111II11I1),l1I1I1111I=I1ll1l1llI.style,I11I1111ll=I1ll1l1llI.innerStyle,I1lll1l1II=(I11I1111ll.styleField,I11I1111ll.styleFieldOuter,I11I1111ll.styleTitle,l1I1I1111I.width),I1III11IlI=l1I1I1111I.height,l111111Ill=l1I1I1111I.left,I1l1llllll=l1I1I1111I.top,l11II1IIll=l1I1I1111I.borderRadius||0,l11l11llII=l1I1I1111I.borderLeftWidth||0,I11lllll1l=l1I1I1111I.borderTopWidth||0,I11I1III1I=l1I1I1111I.borderBottomWidth||0,I1111IIII1=l1I1I1111I.borderRightWidth||0,l1II1I11Il=l1I1I1111I.borderLeftColor||0,l111IIIIl1=l1I1I1111I.borderTopColor||0,I111II1I1l=l1I1I1111I.borderBottomColor||0,I1111l1l1I=l1I1I1111I.borderRightColor||0,I1l111l111=(l1I1I1111I.backgroundColor,l1I1I1111I.backgroundImage,l1I1I1111I.paddingLeft,l1I1I1111I.paddingTop,l1I1I1111I.paddingRight,l1I1I1111I.paddingBottom,document.createElement("canvas"));I1l111l111.width=I1lll1l1II,I1l111l111.height=I1III11IlI,I1l111l111.style.left=l111111Ill+"px",I1l111l111.style.top=I1l1llllll+"px";var l11I111I1I=I1l111l111.getContext("2d"),l11111I11l=l11II1IIll;I1lll1l1II<2*l11111I11l&&(l11111I11l=I1lll1l1II/2),I1III11IlI<2*l11111I11l&&(l11111I11l=I1III11IlI/2),l11I111I1I.beginPath(),l11I111I1I.moveTo(x+l11111I11l,y),I1111IIII1&&(l11I111I1I.lineWidth=I1111IIII1,l11I111I1I.strokeStyle=I1111l1l1I,l11I111I1I.arcTo(x+I1lll1l1II,y,x+I1lll1l1II,y+I1III11IlI,l11111I11l)),I11I1III1I&&(l11I111I1I.lineWidth=I11I1III1I,l11I111I1I.strokeStyle=I111II1I1l,l11I111I1I.arcTo(x+I1lll1l1II,y+I1III11IlI,x,y+I1III11IlI,l11111I11l)),l11l11llII&&(l11I111I1I.lineWidth=l11l11llII,l11I111I1I.strokeStyle=l1II1I11Il,l11I111I1I.arcTo(x,y+I1III11IlI,x,y,l11111I11l)),I11lllll1l&&(l11I111I1I.lineWidth=I11lllll1l,l11I111I1I.strokeStyle=l111IIIIl1,l11I111I1I.arcTo(x,y,x+I1lll1l1II,y,l11111I11l)),l11I111I1I.closePath(),l1lll111lI(".ppt-paper-area").append(I1l111l111)},buildHtmlCanvasByControlId:function(I111II11lI,I1lll1111l){var l1II1I1Il1=this,l1l1l111II=l1II1I1Il1.getControlById(I111II11lI),l11I1111Il=oui.getById("items").getHtmlByTplId("item-canvas-div-tpl",{item:l1l1l111II}),I1lll1l1ll=oui.getById("items").getHtmlByTplId("item-canvas-object-tpl",{item:l1l1l111II}),l1III11IIl=l1lll111lI(".ppt-paper-area");l1III11IIl.append(l11I1111Il);var l111111l1l=l1III11IIl.find("#canvas_div_"+I111II11lI),I1I1IIIIl1=document.createElement("canvas"),I11ll1ll1I=3*l111111l1l[0].scrollWidth,I11l11lll1=3*l111111l1l[0].scrollHeight;I11ll1ll1I<200&&(I11ll1ll1I=200),I11l11lll1<200&&(I11l11lll1=200),I1I1IIIIl1.width=I11ll1ll1I,I1I1IIIIl1.height=I11l11lll1,I1I1IIIIl1.style.width=I11ll1ll1I+"px",I1I1IIIIl1.style.height=I11l11lll1+"px",l1II1I1Il1.eachDomStyle(l111111l1l[0]);var l11IIIIII1=l1lll111lI(".design-middle"),l11I1III1l=l11IIIIII1[0].scrollTop,I1111lllll=l11IIIIII1[0].scrollLeft;I1111lllll>0&&(l11IIIIII1[0].scrollLeft=0),l11I1III1l>0&&(l11IIIIII1[0].scrollTop=0),html2canvas(l111111l1l[0],{canvas:I1I1IIIIl1,width:I1I1IIIIl1.width,height:I1I1IIIIl1.height}).then(function(l111II11ll){var l1lll11111=document.createElement("canvas"),I1II1I1Il1=l111111l1l[0].scrollWidth,l1I1I111l1=l111111l1l[0].scrollHeight;l1lll11111.width=I1II1I1Il1,l1lll11111.height=l1I1I111l1,l1lll11111.style.width=I1II1I1Il1+"px",l1lll11111.style.height=l1I1I111l1+"px";var I11I1111I1=l1lll11111.getContext("2d"),I1III1I111=l111111l1l.css("border-top-width")||"";I1III1I111=I1III1I111.replace("px",""),I1III1I111=parseInt(I1III1I111||0);var l1III11I11=l111111l1l.css("border-left-width")||"";l1III11I11=l1III11I11.replace("px",""),l1III11I11=parseInt(l1III11I11||0);var I111111IlI=l111111l1l.css("border-right-width")||"";I111111IlI=I111111IlI.replace("px",""),I111111IlI=parseInt(I111111IlI||0);var l1I1IIIIll=l111111l1l.css("border-bottom-width")||"";l1I1IIIIll=l1I1IIIIll.replace("px",""),l1I1IIIIll=parseInt(l1I1IIIIll||0);var l11ll1llII=l111II11ll.getContext("2d").getImageData(l1III11I11,I1III1I111,l111II11ll.width-I111111IlI,l111II11ll.height-l1I1IIIIll);I11I1111I1.putImageData(l11ll1llII,0,0);var l11l11llI1=I11I1111I1.getImageData(0,0,I1II1I1Il1,l1I1I111l1);I11I1111I1.putImageData(l11l11llI1,0,0),l1III11IIl.append(I1lll1l1ll),l1lll111lI("#canvas_object_"+I111II11lI).append(l1lll11111),I1111lllll>0&&(l11IIIIII1[0].scrollLeft=I1111lllll),l11I1III1l>0&&(l11IIIIII1[0].scrollTop=l11I1III1l),I1lll1111l&&I1lll1111l()})},canvasRunner:function(l111ll11ll){for(var I1III111l1=0,I1II1I1I1l=[],I1l1l111ll=0,l11l11111l=l111ll11ll;I1l1l111ll<l11l11111l;I1l1l111ll++)I1II1I1I1l.push({idx:I1l1l111ll,run:function(){I1III111l1=this.idx,com.oui.absolute.AbsoluteDesign.buildCanvasByControlId(com.oui.absolute.AbsoluteDesign.data.controls[0].id,function(){I1II1I1I1l[I1III111l1+1]&&I1II1I1I1l[I1III111l1+1].run()})}});I1II1I1I1l[0].run()},eachDomStyle:function(I111ll11l1){var I1III1111l=this,l1ll1l1lII=I111ll11l1.style;I111ll11l1.currentStyle?l1lll111lI.extend(!0,l1ll1l1lII,I111ll11l1.currentStyle):window.getComputedStyle&&l1lll111lI.extend(!0,l1ll1l1lII,getComputedStyle(I111ll11l1));var I1I1I1111l=l1lll111lI(I111ll11l1).children();I1I1I1111l&&I1I1I1111l.length&&I1I1I1111l.each(function(){I1III1111l.eachDomStyle(this)})},bindScrollEvents:function(){var I111ll11II=this;l1lll111lI(".design-middle").on("scroll",function(I111ll11Il){try{I111ll11II.scrollTimer&&window.clearTimeout(I111ll11II.scrollTimer)}catch(I111ll11Il){}I111ll11II.scrollTimer=window.setTimeout(function(){I111ll11II.renderPaperStyle(),window.scrollTimer=null},1)})},getControlIdxById:function(l111ll111I){var I1III1111I=this,l1II1I1Il1=-1;oui.findOneFromArrayBy(I1III1111I.data.controls||[],function(I111ll111I,l1lll111I1){if(I111ll111I.id==l111ll111I)return l1II1I1Il1=l1lll111I1,!0});return l1II1I1Il1},getControlById:function(I111ll11lI){var l1III11111=this;return oui.findOneFromArrayBy(l1III11111.data.controls||[],function(l111ll11Il){if(l111ll11Il.id==I111ll11lI)return!0})},removeControlsByIds:function(l111II11l1){var l1lll1111l=this;if(l111II11l1&&l111II11l1.length){for(var I1II1I1I1I=[],l1I1I1111l=0,l11l1111l1=l111II11l1.length;l1I1I1111l<l11l1111l1;l1I1I1111l++){var l1lll1l1II=l1lll1111l.getControlById(l111II11l1[l1I1I1111l]);l1lll1l1II&&I1II1I1I1I.push(".control-pabs-disable[control-pabs-id="+l1lll1l1II.id+"]"),l1lll1111l.removeControlById(l111II11l1[l1I1I1111l])}var I1III11II1="#"+l111II11l1.join(",#");l1lll111lI(I1III11II1,".ppt-paper-area").remove(),I1II1I1I1I&&I1II1I1I1I.length&&l1lll111lI(I1II1I1I1I.join(","),".design-left").removeClass("control-pabs-disable")}},removeControlById:function(l111ll1111){var l1III111II=this,l1ll1l1lll=-1,l1I1I111I1=oui.findOneFromArrayBy(l1III111II.data.controls||[],function(I111ll11lI,l1III111II){if(I111ll11lI.id==l111ll1111)return l1ll1l1lll=l1III111II,!0});if(l1III111II.data.tempControl={},l1I1I111I1&&l1I1I111I1.style.zIndex==l1III111II.data.style.currControlZIndex&&l1III111II.data.style.currControlZIndex--,l1III111II.data.controls.length||(l1III111II.data.style.currControlZIndex=0),l1I1I111I1&&"tableLine"==l1I1I111I1.htmlType)l1ll1l1lll=l1III111II.removeTableLineControl(l111ll1111);else if(l1I1I111I1&&l1I1I111I1.style.rect&&l1I1I111I1.style.rect.tableLineId){var I11l1111I1=l1III111II.findTableLineControl(l1I1I111I1.style.rect.tableLineId);if(I11l1111I1){var l1III1I1II=l1I1I111I1.style.rect;l1III111II.removeRectInTableLineByColumnAndRow(I11l1111I1,l1III1I1II.columnIndex,l1III1I1II.rowIndex)}}l1ll1l1lll>-1&&l1III111II.data.controls.splice(l1ll1l1lll,1)},bindCheckEvents:function(){var I111ll111l=this;I111ll111l.setInterceptFuns("down2selectPaperArea,event2cloneControl,event2preview,event2save,event2selectBoxArea,event2print,event2triggerPaperDown",function(){return I111ll111l.checkData()})},setInterceptFuns:function(I111II1111,I1lll111ll){for(var I1ll1l1lI1,I1I1I1111l,l11I11111l=this,l1III1I1l1=0,I1lll11l11=(I1ll1l1lI1="string"==typeof I111II1111?I111II1111.split(","):I111II1111||[]).length;l1III1I1l1<I1lll11l11;l1III1I1l1++)(I1I1I1111l=I1ll1l1lI1[l1III1I1l1])&&(this[I1I1I1111l+"Before"]=I1lll111ll,this[I1I1I1111l+"Before"]=function(I111ll1111){return!!I1lll111ll.call(l11I11111l,I111ll1111)})},bindColorChangeEvents:function(){var l111ll11l1=this;!function(l111ll111I){var l1III1111l=l111ll111I.spectrum.localization["zh-cn"]={cancelText:"取消",chooseText:"选择",clearText:"清除",togglePaletteMoreText:"更多选项",togglePaletteLessText:"隐藏",noColorSelectedText:"尚未选择任何颜色"};l111ll111I.extend(l111ll111I.fn.spectrum.defaults,l1III1111l)}(jQuery),l1lll111lI(document).on("mouseenter","[type=spectrum]",function(){if(!l1lll111lI(this).data("initColor")){l1lll111lI(this).data("initColor",!0);var I111II11lI=l1lll111lI(this).attr("value");l1lll111lI(this).spectrum({color:I111II11lI,preferredFormat:"hex",showInput:!0,showInput:!0,allowEmpty:!0,showInitial:!0,showPalette:!0,showSelectionPalette:!0,maxPaletteSize:10,palette:[["rgb(208,215,229)","rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(153, 153, 153)","rgb(183, 183, 183)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(239, 239, 239)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(76, 17, 48)"],["rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)"],["rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)"],["rgb(166, 77, 121)","rgb(133, 32, 12)","rgb(153, 0, 0)","rgb(180, 95, 6)","rgb(191, 144, 0)","rgb(56, 118, 29)","rgb(19, 79, 92)","rgb(17, 85, 204)","rgb(11, 83, 148)","rgb(53, 28, 117)"],["rgb(116, 27, 71)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)"]],move:function(l111II11l1){l111ll11l1.updateColor(this,l111II11l1)},change:function(I111ll11II){l111ll11l1.updateColor(this,I111ll11II)},hide:function(I111II1111){l111ll11l1.updateColor(this,I111II1111)}})}}),oui.browser.ie&&(oui.browser.ie+"").indexOf("9")>=0&&l1lll111lI("[type=spectrum]").each(function(){l1lll111lI(this).data("initColor",!0);var I111ll11II=l1lll111lI(this).attr("value");l1lll111lI(this).spectrum({color:I111ll11II,preferredFormat:"rgb",preferredFormat:"hex",showInput:!0,move:function(I111ll11ll){l111ll11l1.updateColor(this,I111ll11ll)},change:function(l111II11ll){l111ll11l1.updateColor(this,l111II11ll)},hide:function(l111ll111I){l111ll11l1.updateColor(this,l111ll111I)}})})},updateColor:function(l111ll111I,l1III111lI){var I1II1I1III,I1l1l111I1=this;I1II1I1III=l1III111lI?l1III111lI.toHexString():"",l1lll111lI(l111ll111I).attr("value",I1II1I1III),l1lll111lI(l111ll111I).css("background-color",I1II1I1III),l1lll111lI(l111ll111I).next(".set-color-info").text(I1II1I1III||"transparent");var I11I1111lI=l1lll111lI(l111ll111I).attr("invoke-prop");I11I1111lI&&oui.JsonPathUtil.setObjByPath(I11I1111lI,I1l1l111I1.data,I1II1I1III,!0);var I1lll1l11I=l1lll111lI(l111ll111I).attr("invoke-fun");I1lll1l11I&&I1l1l111I1[I1lll1l11I]&&I1l1l111I1[I1lll1l11I]({el:l111ll111I,value:I1II1I1III})},resetTableLineEditStateBy:function(I111ll11Il){var l1III111I1=this.tableLinesMap||{},l1II1I1I1l=[];for(var I1I1I111Il in l1III111I1){var I11l1111II=l1III111I1[I1I1I111Il];I11l1111II&&(I111ll11Il?I111ll11Il(I11l1111II)&&(I11l1111II.style.isDragging4SelectArea=!1,l1II1I1I1l.push("#"+I1I1I111Il+".drag-select-area")):(I11l1111II.style.isDragging4SelectArea=!1,l1II1I1I1l.push("#"+I1I1I111Il+".drag-select-area")))}l1II1I1I1l&&l1II1I1I1l.length&&l1lll111lI(l1II1I1I1l.join(",")).removeClass("drag-select-area").find("[oui-e-click=event2editTable]").attr("title","编辑完成")},bindDragEvents:function(){var I111II11I1=this,I1III11111=function(I111ll111I,l1lll111lI){var I1II1I1IlI=[],I1I1I1111I=I111ll111I.style.left,l11I11111l=I111ll111I.style.top,I1III1I11I=I111ll111I.style.width,I1lll11lIl=I111ll111I.style.height,I111111IIl=l1lll111lI.style.left,I1I1IIIII1=l1lll111lI.style.top,l11ll1ll11=l1lll111lI.style.width,l11l11ll11=l1lll111lI.style.height;return(Math.abs(I1I1I1111I-I111111IIl)<1||Math.abs(I1I1I1111I-I111111IIl-l11ll1ll11)<1)&&I1II1I1IlI.push("left"),(Math.abs(I1I1I1111I+I1III1I11I-(I111111IIl+l11ll1ll11))<1||Math.abs(I1I1I1111I+I1III1I11I-I111111IIl)<1)&&I1II1I1IlI.push("right"),Math.abs((2*I1I1I1111I+I1III1I11I)/2-(2*I111111IIl+l11ll1ll11)/2)<1&&I1II1I1IlI.push("center"),(Math.abs(l11I11111l-I1I1IIIII1)<1||Math.abs(l11I11111l-I1I1IIIII1-l11l11ll11)<1)&&I1II1I1IlI.push("top"),(Math.abs(l11I11111l+I1lll11lIl-(I1I1IIIII1+l11l11ll11))<1||Math.abs(l11I11111l+I1lll11lIl-I1I1IIIII1)<1)&&I1II1I1IlI.push("bottom"),Math.abs((2*l11I11111l+I1lll11lIl)/2-(2*I1I1IIIII1+l11l11ll11)/2)<1&&I1II1I1IlI.push("middle"),I1II1I1IlI},l1II1I1Il1=function(l111ll1111,l1lll111lI){for(var l1II1I1I11=[],l1l1l111I1=0,I11I1111I1=l1lll111lI.length;l1l1l111I1<I11I1111I1;l1l1l111I1++)if(l111ll1111.id!=l1lll111lI[l1l1l111I1].id)for(var l1lll1l1Il=I1III11111(l111ll1111,l1lll111lI[l1l1l111I1]),l1lll11lll=0,I111111II1=l1lll1l1Il.length;l1lll11lll<I111111II1;l1lll11lll++)l1II1I1I11.indexOf(l1lll1l1Il[l1lll11lll])<0&&l1II1I1I11.push(l1lll1l1Il[l1lll11lll]);return l1II1I1I11};this.bindDrag({operationSelector:".design-operation-layer",cancelSelector:".control-pabs-disable,.design-copy-ctrl,.design-del-ctrl,.tableLine-edit-icon,.proxy-drag-placeholder,.proxy-dragging-select-area",dragSelector:".design-item,.tree-node-page,.control-pabs-component",proxyDragSelector:".proxy-drag",scrollContainer:".design-middle",dragScrollContainer:".design-ctrl-area",dropContainer:".ppt-paper-area",down:function(I111ll111I){I111ll111I.e;var I1III111l1=I111ll111I.el,I1ll1l1llI=I111ll111I.isUpdate,I1I1I111l1=(I111ll111I.isResizer,l1lll111lI(I1III111l1).closest(".preview-box"));if(I1I1I111l1&&I1I1I111l1.length)return!1;var I11I111111=I111II11I1.checkData(),l1III1I1l1=I1III111l1.getAttribute("id");if(l1III1I1l1&&!I111II11I1.getControlById(l1III1I1l1)&&(I111II11I1.isRenderAll=!0),I111II11I1.isRenderAll)return I111II11I1.currDragEl=I1III111l1,!1;if(!I11I111111)return!1;if(I1ll1l1llI){if("absoluteProps-pageProps-base"!=I111II11I1.currAccordingActiveId&&"absoluteProps-pageProps-setttings"!=I111II11I1.currAccordingActiveId||(I111II11I1.currAccordingActiveId=""),l1lll111lI(".active",".ppt-paper-area").removeClass("active"),l1lll111lI(I1III111l1).addClass("active"),l1III1I1l1=I1III111l1.getAttribute("id")){I111II11I1.resetTableLineEditStateBy(function(l111II11lI){if(l111II11lI.id!=l1III1I1l1)return!0});var l1lll11l1I=I111II11I1.getControlById(l1III1I1l1);I111II11I1.data.currentControl.id!=l1III1I1l1&&(I111II11I1.currAccordingActiveId=""),"tableLine"!=l1lll11l1I.htmlType||I111II11I1.isDragging4SelectArea(l1lll11l1I)?I111II11I1.showOperationArea(l1lll11l1I,I111ll111I):I111II11I1.hideOperationArea(),I111II11I1.setCurrPropsData(l1lll11l1I,"center","down2selectField")}}else I111II11I1.resetTableLineEditStateBy(function(I111II11ll){return!0});I111II11I1.data.tempControl={}},dragStart:function(l111ll111I){l111ll111I.e;var I1lll1111I=l111ll111I.el,l1ll1l1l1l=l111ll111I.$proxyDrag;l111ll111I.isUpdate,l111ll111I.isResizer;if(I111II11I1.isRenderAll)return I111II11I1.currDragEl=I1lll1111I,!1;l1lll111lI(I1lll1111I).hasClass("control-pabs-tableLine")?l1ll1l1l1l.find(".tableLine-drag-icon,.tableLine-edit-icon").show():l1ll1l1l1l.find(".tableLine-drag-icon,.tableLine-edit-icon").hide(),l1lll111lI(I1lll1111I).hasClass("control-pabs-component")?l1ll1l1l1l.addClass("control-pabs-component"):l1ll1l1l1l.removeClass("control-pabs-component")},dragging:function(I111II11Il){I111II11Il.e;var I1lll111I1=I111II11Il.el,l1ll1l1ll1=I111II11Il.$proxyDrag,l1l1l11111=I111II11Il.dragData,l11l1111lI=I111II11Il.isUpdate,l1lll1l1ll=I111II11Il.isResizer,I1III11II1=I111II11Il.$proxyPlaceholder;if(I111II11I1.isRenderAll)return I111II11I1.currDragEl=I1lll111I1,!1;var l111111II1=I1lll111I1.getAttribute("id"),l1I1IIIIl1=l1l1l11111.width,I11ll1lll1=l1l1l11111.height,l11I11II11=l1l1l11111.x,l11IIIIIII=l1l1l11111.y;!I111II11Il.isResizerColumn||0!=l1l1l11111.resizeColumnIndex&&l1l1l11111.resizeColumnIndex!=l1l1l11111.lineColumnLength-1||(l1I1IIIIl1=l1l1l11111.resizeWidth,0==l1l1l11111.resizeColumnIndex&&(l11I11II11=l1l1l11111.resizeX)),!I111II11Il.isResizerRow||0!=l1l1l11111.resizeRowIndex&&l1l1l11111.resizeRowIndex!=l1l1l11111.lineRowLength-1||(I11ll1lll1=l1l1l11111.resizeHeight,0==l1l1l11111.resizeRowIndex&&(l11IIIIIII=l1l1l11111.resizeY)),I111II11Il.isResizerRow||I111II11Il.isResizerColumn||I111II11Il.isSelectArea||I111II11I1.hideOperationArea();var I11I1IIII1=[];if(I111II11Il.isSelectArea||(I11I1IIII1=l1II1I1Il1({id:l111111II1,style:{left:l11I11II11,top:l11IIIIIII,width:l1I1IIIIl1,height:I11ll1lll1}},I111II11I1.findItems())),I111II11I1.timer4proxyLine)try{clearTimeout(I111II11I1.timer4proxyLine),I111II11I1.timer4proxyLine=null}catch(I111ll111l){}var l1111III1l="left,center,right,top,middle,bottom".split(",");if(I11I1IIII1&&I11I1IIII1.length){for(var l1II1I11Il=[],I111llll11=0,I111ll1l1l=I11I1IIII1.length;I111llll11<I111ll1l1l;I111llll11++){l1II1I11Il.push(".proxy-line-"+I11I1IIII1[I111llll11]);var l1111l1lIl=l1111III1l.indexOf(I11I1IIII1[I111llll11]);l1111l1lIl>-1&&l1111III1l.splice(l1111l1lIl,1)}l1II1I11Il.length&&(I111II11I1.timer4proxyLine=setTimeout(function(){l1ll1l1ll1.find(l1II1I11Il.join(",")).addClass("display-block"),I111II11I1.timer4proxyLine=null},16.7))}if(l1111III1l&&l1111III1l.length){var I1l111l111=".proxy-line-"+l1111III1l.join(",.proxy-line-");l1ll1l1ll1.find(I1l111l111).removeClass("display-block")}var l11l111l1l;l11l1111lI?(l11l111l1l=I111II11I1.data.currentControl&&I111II11I1.data.currentControl.id==l111111II1?I111II11I1.data.currentControl:I111II11I1.getControlById(l111111II1),l11I11II11<0&&(l11I11II11=0),l11IIIIIII<0&&(l11IIIIIII=0),l11l111l1l.style.left=l11I11II11,l11l111l1l.style.top=l11IIIIIII,l11l111l1l.style.width=l1I1IIIIl1,l11l111l1l.style.height=I11ll1lll1):l11l111l1l={parentId:l1lll111lI(I1lll111I1).attr(I111II11I1.controlDomAttrPrefix+"parentId"),detailId:l1lll111lI(I1lll111I1).attr(I111II11I1.controlDomAttrPrefix+"detailId"),bizId:l1lll111lI(I1lll111I1).attr(I111II11I1.controlDomAttrPrefix+"bizId"),htmlType:l1lll111lI(I1lll111I1).attr(I111II11I1.controlDomAttrPrefix+"htmlType"),style:{left:l11I11II11,top:l11IIIIIII,width:l1I1IIIIl1,height:I11ll1lll1}},l11l111l1l.otherAttrs=l11l111l1l.otherAttrs||{},l11l111l1l.name=l11l111l1l.name||l1lll111lI.trim(l1lll111lI(I1lll111I1).text());var I11111I1II={left:l1l1l11111.mouseX4relative,top:l1l1l11111.mouseY4relative},l1I11II1l1=!1;if(I1III11II1.removeClass("proxy-drag-placeholder-normalForm"),l1lll1l1ll||"tableLine"==l11l111l1l.htmlType||"selectArea"==l11l111l1l.htmlType){if(I111II11Il.isSelectArea){var l1I1I1I1l1=I111II11I1.findRectBySelectArea(l11l111l1l,l1l1l11111);l1I1I1I1l1?I111II11I1.showOperationSelectByTableLineSelectRect(l11l111l1l,l1I1I1I1l1):I1III11II1.css({display:"none"})}}else(l1I1I1I1l1=I111II11I1.findRectByPosOrRect(I11111I1II)).tableLineId&&l1I1I1I1l1.columnIndex>-1&&l1I1I1I1l1.rowIndex>-1?(l1I11II1l1=!0,I1III11II1.css({display:"block","z-index":999,left:l1I1I1I1l1.left-l1l1l11111.scrollContainerLeft+l1l1l11111.dropPos.x+"px",top:l1I1I1I1l1.top-l1l1l11111.scrollContainerTop+l1l1l11111.dropPos.y+"px",width:l1I1I1I1l1.right-l1I1I1I1l1.left+"px",height:l1I1I1I1l1.bottom-l1I1I1I1l1.top+"px"})):I1III11II1.css({display:"none"});if(!I111II11Il.isSelectArea&&!l1I11II1l1&&I111II11I1.data.pageDesignType&&"normalForm"==I111II11I1.data.pageDesignType&&!l1lll1l1ll){var l11ll1l1lI=I111II11I1.findControlByPosOrRect(I11111I1II,l11l111l1l);l11ll1l1lI&&(I1III11II1.addClass("proxy-drag-placeholder-normalForm"),I111II11I1.isPosAtControlHaffTop(l11ll1l1lI,I11111I1II)?I1III11II1.css({display:"block","z-index":999,left:l11ll1l1lI.style.left-l1l1l11111.scrollContainerLeft+l1l1l11111.dropPos.x+"px",top:l11ll1l1lI.style.top-l1l1l11111.scrollContainerTop+l1l1l11111.dropPos.y+"px",width:l11l111l1l.style.width+"px",height:"20px"}):I1III11II1.css({display:"block","z-index":999,left:l11ll1l1lI.style.left-l1l1l11111.scrollContainerLeft+l1l1l11111.dropPos.x+"px",top:l11ll1l1lI.style.top+l11ll1l1lI.style.height-l1l1l11111.scrollContainerTop+l1l1l11111.dropPos.y+"px",width:l11l111l1l.style.width+"px",height:"20px"}))}I111II11I1.data.currentControl!=l11l111l1l&&I111II11I1.setCurrPropsData(l11l111l1l,"center","draggingField")},dragEnd:function(l111ll111l){l111ll111l.e;var I1III111II=l111ll111l.el;l111ll111l.$proxyDrag,l111ll111l.dragData,l111ll111l.isUpdate,l111ll111l.isResizer;if(I111II11I1.isRenderAll)return I111II11I1.currDragEl=I1III111II,!1;I111II11I1.dragEndControl(l111ll111l)}})},bindEvents:function(){this.bindMessageEvents(),this.bindDragEvents(),this.bindControlPropsTitleEvents(),this.bindScrollEvents(),this.bindCheckEvents(),this.bindColorChangeEvents(),this.bindHidePaperTypeSelectEvents(),this.bindBeforeUnloadEvents(),this.bindHotKeyEvents()},bindMessageEvents:function(){var I111II11ll=this;window.addEventListener("message",function(I111II111I){var I1III111Il=I111II111I.data;"string"!=typeof I1III111Il&&"object"==typeof I1III111Il&&I1III111Il.cmd&&I1III111Il.param&&I111II11ll[I1III111Il.cmd]&&I111II11ll[I1III111Il.cmd](I1III111Il.param,I111II111I)},!1)},bindSortEvents:function(){},bindEvent4ie:function(){oui.browser.ie||oui.browser.isEdge},bindHotKeyEvents:function(){var I111II11I1=this;l1lll111lI(document).bind("keydown","up",function(I111ll11I1){var l1lll111Il=I111II11I1.data.currentControl;return l1lll111Il&&l1lll111Il.id&&(l1lll111Il.style.top-=1,l1lll111Il.style.top<0&&(l1lll111Il.style.top=0),I111II11I1.updateCurrControlStyle()),!1}),l1lll111lI(document).bind("keydown","left",function(l111ll11lI){var l1III111l1=I111II11I1.data.currentControl;return l1III111l1&&l1III111l1.id&&(l1III111l1.style.left-=1,l1III111l1.style.left<0&&(l1III111l1.style.left=0),I111II11I1.updateCurrControlStyle()),!1}),l1lll111lI(document).bind("keydown","down",function(I1lll111ll){var l1ll1l1l11=I111II11I1.data.currentControl;return l1ll1l1l11&&l1ll1l1l11.id&&(l1ll1l1l11.style.top+=1,I111II11I1.updateCurrControlStyle()),!1}),l1lll111lI(document).bind("keydown","right",function(l111ll111l){var I1III11111=I111II11I1.data.currentControl;return I1III11111&&I1III11111.id&&(I1III11111.style.left+=1,I111II11I1.updateCurrControlStyle()),!1})},bindBeforeUnloadEvents:function(){var l111ll111l=this;window.onunload=function(){l1lll111lI("body").remove(),l1lll111lI("html").remove(),console.log("destroy..."),oui.biz.Tool.Clear(window),window.setTimeout=function(){},window=null},window.onbeforeunload=function(I111II111I){if(!l111ll111l.hasSaveData())return(I111II111I||window.event).returnValue="有信息未保存"}},hasSaveData:function(){return!this.hasChange},changeDesignView:function(){var l111ll11I1=this;window.postMessage({cmd:"cmd4updatePageImgUrl",param:{pageId:l111ll11I1.pageId}},"*"),l111ll11I1.ready2loadHistory||window.postMessage({cmd:"cmd4addHistory",param:{pageId:l111ll11I1.pageId}},"*")},update4watch:function(){},designChanged:function(){this.inited&&(this.hasChange=!0,this.changeDesignView())},bindHidePaperTypeSelectEvents:function(){l1lll111lI(document).on("mousedown","body",function(l111II1111){oui.isInDom(l111II1111.target,".design-select-paper")||l1lll111lI(".show-list").removeClass("show-list")})},refreshTableLineMergeCell:function(l111II11l1,I1III111I1,l1II1I1Ill){var l1l1l111ll=l111II11l1.style.mergeCellsMap||{},l11l11111l=l111II11l1.style.left,I1III1I1II=l111II11l1.style.top,l1lll11lIl=l111II11l1.style.borderLeftWidth,I111111l1l=l111II11l1.style.borderTopWidth,I1I1IIII1l=l111II11l1.style.columnLines||[],I11II1IIlI=l111II11l1.style.rowLines||[],I11I11IIll=l1l1l111ll[I1III111I1+"_"+l1II1I1Ill];if(I11I11IIll){var l11lllllIl=I11I11IIll.startColumnIndex,I11l1lll1l=I11I11IIll.startRowIndex,l1111IIIIl=I11I11IIll.endColumnIndex+1,I1ll1l111l=I11I11IIll.endRowIndex+1,l111IIIIl1=l11l11111l+l1lll11lIl+I1I1IIII1l[l11lllllIl].config.lineHeight+I1I1IIII1l[l11lllllIl].fromPos.left,I111II1II1=I1III1I1II+I111111l1l+I11II1IIlI[I11l1lll1l].config.lineHeight+I11II1IIlI[I11l1lll1l].fromPos.top,I1111I1I1l=l11l11111l+l1lll11lIl+I1I1IIII1l[l1111IIIIl].fromPos.left,l1I111I1II=I1III1I1II+I111111l1l+I11II1IIlI[I1ll1l111l].fromPos.top;I11I11IIll.left=l111IIIIl1,I11I11IIll.top=I111II1II1,I11I11IIll.right=I1111I1I1l,I11I11IIll.bottom=l1I111I1II}},refreshTableLineMergeCells:function(l111ll11l1,I1lll111II,I1ll1l1lI1){var I1l1l1111I=this;if("tableLine"==l111ll11l1.htmlType)if(void 0!==I1lll111II&&void 0!==I1ll1l1lI1)I1l1l1111I.refreshTableLineMergeCell(l111ll11l1,I1lll111II,I1ll1l1lI1);else{var I11I1111l1=l111ll11l1.style.mergeCellsMap||{};for(var I1III1I1lI in I11I1111l1){var I1III11IlI=I11I1111l1[I1III1I1lI];if(I1III11IlI){var I111111IlI=I1III11IlI.startColumnIndex,I1l1llllll=I1III11IlI.startRowIndex;I1l1l1111I.refreshTableLineMergeCell(l111ll11l1,I111111IlI,I1l1llllll)}}}},refreshTableLineMergeCellControls:function(I111ll11I1,I1III111l1,I1ll1l1lll,l1I1I111lI,I11l1111Il){var I1lll1l1ll=this;if("tableLine"==I111ll11I1.htmlType)if(void 0!==l1I1I111lI&&void 0!==I11l1111Il)I1lll1l1ll.refreshTableLineMergeCellControl(I111ll11I1,l1I1I111lI,I11l1111Il,I1III111l1,I1ll1l1lll);else{var I1lll11llI=I111ll11I1.style.mergeCellsMap||{};for(var l111111Ill in I1lll11llI){var I1I1IIIIIl=I1lll11llI[l111111Ill];if(I1I1IIIIIl){var I11ll1ll1l=I1I1IIIIIl.startColumnIndex,l11I11IIl1=I1I1IIIIIl.startRowIndex;I1lll1l1ll.refreshTableLineMergeCellControl(I111ll11I1,I11ll1ll1l,l11I11IIl1,I1III111l1,I1ll1l1lll)}}}},refreshTableLineMergeCellControl:function(I111ll111l,I1lll111Il,I1II1I1I1l,I1l1l111II,l11I11111l){var I1lll1l11I=this,l1lll11l1l=I111ll111l.style.mergeCellsMap||{},l111111l1I=I111ll111l.style.left,I1l1lllllI=I111ll111l.style.top,I11ll1llI1=I111ll111l.style.borderLeftWidth,l11I11IIlI=I111ll111l.style.borderTopWidth,I11lllllIl=I111ll111l.style.columnLines||[],l11I1IIIll=I111ll111l.style.rowLines||[],l1111lllII=l1lll11l1l[I1lll111Il+"_"+I1II1I1I1l];if(l1111lllII){if(l11I11111l){var l1II1I1111=l11I11111l(l1111lllII,I111ll111l);if("boolean"==typeof l1II1I1111&&!l1II1I1111)return}var I111IIIIll=l1111lllII.startColumnIndex,I111II1Ill=l1111lllII.startRowIndex,I1111l1lIl=l1111lllII.endColumnIndex+1,l1I111I1ll=l1111lllII.endRowIndex+1,I11I111IlI=l111111l1I+I11ll1llI1+I11lllllIl[I111IIIIll].config.lineHeight+I11lllllIl[I111IIIIll].fromPos.left,l11111I1Il=I1l1lllllI+l11I11IIlI+l11I1IIIll[I111II1Ill].config.lineHeight+l11I1IIIll[I111II1Ill].fromPos.top,I1l11ll1ll=l111111l1I+I11ll1llI1+I11lllllIl[I1111l1lIl].fromPos.left,I1I1I1I1lI=I1l1lllllI+l11I11IIlI+l11I1IIIll[l1I111I1ll].fromPos.top;l1111lllII.left=I11I111IlI,l1111lllII.top=l11111I1Il,l1111lllII.right=I1l11ll1ll,l1111lllII.bottom=I1I1I1I1lI;var I11II1I1II=I1lll1l11I.findRectInTableLineByColumnAndRow(I111ll111l,I1lll111Il,I1II1I1I1l);if(I11II1I1II&&I11II1I1II.controlId&&I11II1I1II.tableLineId){var l1II11I1II=!1,l1I111II1I=I1lll1l11I.getControlById(I11II1I1II.controlId);I11II1I1II.left!=I11I111IlI&&(I11II1I1II.left=I11I111IlI,l1II11I1II=!0),I11II1I1II.right!=I1l11ll1ll&&(I11II1I1II.right=I1l11ll1ll,l1II11I1II=!0),I11II1I1II.top!=l11111I1Il&&(I11II1I1II.top=l11111I1Il,l1II11I1II=!0),I11II1I1II.bottom!=I1I1I1I1lI&&(I11II1I1II.bottom=I1I1I1I1lI,l1II11I1II=!0),l1I111II1I.style.left!=I11II1I1II.left&&(l1I111II1I.style.left=I11II1I1II.left,l1II11I1II=!0),l1I111II1I.style.top!=I11II1I1II.top&&(l1I111II1I.style.top=I11II1I1II.top,l1II11I1II=!0),l1I111II1I.style.width!=I11II1I1II.right-I11II1I1II.left&&(l1I111II1I.style.width=I11II1I1II.right-I11II1I1II.left,l1II11I1II=!0),l1I111II1I.style.height!=I11II1I1II.bottom-I11II1I1II.top&&(l1I111II1I.style.height=I11II1I1II.bottom-I11II1I1II.top,l1II11I1II=!0),l1I111II1I.style.rect=I11II1I1II,I1lll1l11I.setRectInTableLineByColumnAndRow(I111ll111l,I11II1I1II),I1l1l111II&&I1l1l111II(l1I111II1I,l1111lllII,l1II11I1II)}}},updateTableLines:function(l111II11I1,l1lll111ll){var l1ll1l1l1l=this,l1l1l1111l=(l1lll111ll.e,l1lll111ll.el,l1lll111ll.$proxyDrag,l1lll111ll.dragData),I11l111111=(l1lll111ll.isUpdate,l1lll111ll.isResizer,l1lll111ll.isResizerRow),I1III1I1I1=l1lll111ll.isResizerColumn;if(!l1lll111ll.isResizerColumn||0!=l1l1l1111l.resizeColumnIndex&&l1l1l1111l.resizeColumnIndex!=l1l1l1111l.lineColumnLength-1||(l111II11I1.style.width=l1l1l1111l.resizeWidth,0==l1l1l1111l.resizeColumnIndex&&(l1l1l1111l.resizeX<0&&(l1l1l1111l.resizeX=0),l111II11I1.style.left=l1l1l1111l.resizeX)),!l1lll111ll.isResizerRow||0!=l1l1l1111l.resizeRowIndex&&l1l1l1111l.resizeRowIndex!=l1l1l1111l.lineRowLength-1||(l111II11I1.style.height=l1l1l1111l.resizeHeight,l1l1l1111l.resizeY<0&&(l1l1l1111l.resizeY=0),0==l1l1l1111l.resizeRowIndex&&(l111II11I1.style.top=l1l1l1111l.resizeY)),I1III1I1I1){var I1lll11llI=l1l1l1111l.resizeColumnIndex,I111111II1=l1l1l1111l.resizeLeft-l1l1l1111l.startResizeLeft,l1I1IIIII1=l111II11I1.style.columnLines[I1lll11llI].fromPos.left;if(l111II11I1.style.columnLines[I1lll11llI].fromPos.left=l1I1IIIII1+I111111II1,0==I1lll11llI||I1lll11llI==l1l1l1111l.lineColumnLength-1){if(0==I1lll11llI){var l11II1IIIl=l111II11I1.style.columnLines[I1lll11llI].fromPos.left;l1l1l1111l.resizeWidth<34&&(I111111II1=34-l1l1l1111l.resizeWidth);var I11l11lll1=l111II11I1.style.columnLines||[];l1l1l1111l.startX+I111111II1<0?(I111111II1=-l1l1l1111l.startX,l111II11I1.style.columnLines[I1lll11llI].fromPos.left=l1I1IIIII1+I111111II1,l11II1IIIl=l111II11I1.style.columnLines[I1lll11llI].fromPos.left,l111II11I1.style.left=0):(l111II11I1.style.width=l1l1l1111l.startWidth-I111111II1,l111II11I1.style.left=l1l1l1111l.startX+I111111II1);for(var l11llllll1=0,l11l1lll11=I11l11lll1.length;l11llllll1<l11l1lll11;l11llllll1++)I11l11lll1[l11llllll1].fromPos.left-=l11II1IIIl,I11l11lll1[l11llllll1].toPos.left-=l11II1IIIl;var I1111lllIl=I11l11lll1[I1lll11llI+1].fromPos.left-I11l11lll1[I1lll11llI].fromPos.left-I11l11lll1[I1lll11llI].config.lineHeight;if(I1111lllIl<34){I1111lllIl=34;I111llll1I=(l1II1I11Il=I11l11lll1[I1lll11llI+1].fromPos.left-I11l11lll1[I1lll11llI].config.lineHeight-I1111lllIl)-I11l11lll1[I1lll11llI].fromPos.left;I11l11lll1[I1lll11llI].fromPos.left=l1II1I11Il,l11II1IIIl=l1II1I11Il,l111II11I1.style.width=l111II11I1.style.width-I111llll1I,l111II11I1.style.left=l111II11I1.style.left+I111llll1I;for(var l11llllll1=0,l11l1lll11=I11l11lll1.length;l11llllll1<l11l1lll11;l11llllll1++)I11l11lll1[l11llllll1].fromPos.left-=l11II1IIIl,I11l11lll1[l11llllll1].toPos.left-=l11II1IIIl}}else if(l1l1l1111l.resizeWidth<34&&(I111111II1=34-l1l1l1111l.startWidth),l111II11I1.style.width=l1l1l1111l.startWidth+I111111II1,(l111ll1lIl=l111II11I1.style.columnLines[I1lll11llI].fromPos.left-l111II11I1.style.columnLines[I1lll11llI-1].fromPos.left-l111II11I1.style.columnLines[I1lll11llI-1].config.lineHeight)<34){var l1II1I11Il=(l111ll1lIl=34)+l111II11I1.style.columnLines[I1lll11llI-1].fromPos.left+l111II11I1.style.columnLines[I1lll11llI-1].config.lineHeight,I111llll1I=l1II1I11Il-l111II11I1.style.columnLines[I1lll11llI].fromPos.left;l111II11I1.style.width=l111II11I1.style.width+I111llll1I,l111II11I1.style.columnLines[I1lll11llI].fromPos.left=l1II1I11Il}}else{var l111ll1lIl=l111II11I1.style.columnLines[I1lll11llI].fromPos.left-l111II11I1.style.columnLines[I1lll11llI-1].fromPos.left-l111II11I1.style.columnLines[I1lll11llI-1].config.lineHeight;l111ll1lIl<34&&(l111ll1lIl=34,l111II11I1.style.columnLines[I1lll11llI].fromPos.left=l111II11I1.style.columnLines[I1lll11llI-1].fromPos.left+l111II11I1.style.columnLines[I1lll11llI-1].config.lineHeight+l111ll1lIl),I111111II1=l111II11I1.style.columnLines[I1lll11llI].fromPos.left-l1I1IIIII1,l111II11I1.style.width+=I111111II1;for(l11llllll1=I1lll11llI+1;l11llllll1<l1l1l1111l.lineColumnLength;l11llllll1++)l111II11I1.style.columnLines[l11llllll1].fromPos.left+=I111111II1,l111II11I1.style.columnLines[l11llllll1].toPos&&(l111II11I1.style.columnLines[l11llllll1].toPos.left=l111II11I1.style.columnLines[l11llllll1].fromPos.left)}}else if(I11l111111){var l1111I1I1l=l1l1l1111l.resizeRowIndex,I111111II1=l1l1l1111l.resizeTop-l1l1l1111l.startResizeTop,I1I111I1II=l111II11I1.style.rowLines[l1111I1I1l].fromPos.top;if(l111II11I1.style.rowLines[l1111I1I1l].fromPos.top=I1I111I1II+I111111II1,0==l1111I1I1l||l1111I1I1l==l1l1l1111l.lineRowLength-1){if(0==l1111I1I1l){var I11l111l1l=l111II11I1.style.rowLines[l1111I1I1l].fromPos.top;l1l1l1111l.resizeHeight<34&&(I111111II1=34-l1l1l1111l.startHeight),l1l1l1111l.startY+I111111II1<0?(I111111II1=-l1l1l1111l.startY,l111II11I1.style.rowLines[l1111I1I1l].fromPos.top=I1I111I1II+I111111II1,I11l111l1l=l111II11I1.style.rowLines[l1111I1I1l].fromPos.top,l111II11I1.style.top=0):(l111II11I1.style.height=l1l1l1111l.startHeight-I111111II1,l111II11I1.style.top=l1l1l1111l.startY+I111111II1);for(var l11111l1l1=l111II11I1.style.rowLines||[],l11llllll1=0,l11l1lll11=l11111l1l1.length;l11llllll1<l11l1lll11;l11llllll1++)l11111l1l1[l11llllll1].fromPos.top-=I11l111l1l,l11111l1l1[l11llllll1].toPos.top-=I11l111l1l;var l1I11II1lI=l11111l1l1[l1111I1I1l+1].fromPos.top-l11111l1l1[l1111I1I1l].fromPos.top-l11111l1l1[l1111I1I1l].config.lineHeight;if(l1I11II1lI<34){l1I11II1lI=34;I111llll1I=(I1l1l1l1l1=l11111l1l1[l1111I1I1l+1].fromPos.top-l11111l1l1[l1111I1I1l].config.lineHeight-l1I11II1lI)-l11111l1l1[l1111I1I1l].fromPos.top;l11111l1l1[l1111I1I1l].fromPos.top=I1l1l1l1l1,I11l111l1l=I1l1l1l1l1,l111II11I1.style.height=l111II11I1.style.height-I111llll1I,l111II11I1.style.top=l111II11I1.style.top+I111llll1I;for(var l11llllll1=0,l11l1lll11=l11111l1l1.length;l11llllll1<l11l1lll11;l11llllll1++)l11111l1l1[l11llllll1].fromPos.top-=I11l111l1l,l11111l1l1[l11llllll1].toPos.top-=I11l111l1l}}else if(l1l1l1111l.resizeHeight<34&&(I111111II1=l1l1l1111l.startHeight-34),l111II11I1.style.height=l1l1l1111l.startHeight+I111111II1,(l11II1I1II=l111II11I1.style.rowLines[l1111I1I1l].fromPos.top-l111II11I1.style.rowLines[l1111I1I1l-1].fromPos.top-l111II11I1.style.rowLines[l1111I1I1l-1].config.lineHeight)<34){var I1l1l1l1l1=(l11II1I1II=34)+l111II11I1.style.rowLines[l1111I1I1l-1].fromPos.top+l111II11I1.style.rowLines[l1111I1I1l-1].config.lineHeight,I111llll1I=I1l1l1l1l1-l111II11I1.style.rowLines[l1111I1I1l].fromPos.top;l111II11I1.style.height=l111II11I1.style.height+I111llll1I,l111II11I1.style.rowLines[l1111I1I1l].fromPos.top=I1l1l1l1l1}}else{var l11II1I1II=l111II11I1.style.rowLines[l1111I1I1l].fromPos.top-l111II11I1.style.rowLines[l1111I1I1l-1].fromPos.top-l111II11I1.style.rowLines[l1111I1I1l-1].config.lineHeight;l11II1I1II<34&&(l11II1I1II=34,l111II11I1.style.rowLines[l1111I1I1l].fromPos.top=l111II11I1.style.rowLines[l1111I1I1l-1].fromPos.top+l111II11I1.style.rowLines[l1111I1I1l-1].config.lineHeight+l11II1I1II),I111111II1=l111II11I1.style.rowLines[l1111I1I1l].fromPos.top-I1I111I1II,l111II11I1.style.height+=I111111II1;for(l11llllll1=l1111I1I1l+1;l11llllll1<l1l1l1111l.lineRowLength;l11llllll1++)l111II11I1.style.rowLines[l11llllll1].fromPos.top+=I111111II1,l111II11I1.style.rowLines[l11llllll1].toPos&&(l111II11I1.style.rowLines[l11llllll1].toPos.top=l111II11I1.style.rowLines[l11llllll1].fromPos.top)}}l1ll1l1l1l.updateTableLineControl4Border(l111II11I1)},updateControlRect4Border:function(l111ll11ll){var I1lll111ll=this;I1lll111ll.updateControlRect(l111ll11ll,{dragData:{startWidth:l111ll11ll.style.width,startHeight:l111ll11ll.style.height,width:l111ll11ll.style.width,height:l111ll11ll.style.height}}),"tableLine"==l111ll11ll.htmlType&&I1lll111ll.updateAllRectsInTableLine(l111ll11ll),I1lll111ll.hideOperationArea()},updateTableLineControl4Border:function(l111II11ll,I1III111Il){I1III111Il||(I1III111Il={startWidth:l111II11ll.style.width,startHeight:l111II11ll.style.height,width:l111II11ll.style.width,height:l111II11ll.style.height});var I1II1I1IIl=I1III111Il.width-I1III111Il.startWidth,I1l1l1111I=I1III111Il.height-I1III111Il.startHeight,l11I1111l1=l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-2].fromPos.left+l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-2].config.lineHeight,l1III1I1l1=l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-1].fromPos.left+I1II1I1IIl;l1III1I1l1<l11I1111l1&&(l1III1I1l1=l11I1111l1),l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-1].fromPos.left=l1III1I1l1,l111II11ll.style.width=parseInt(l1III1I1l1+l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-1].config.lineHeight+l111II11ll.style.borderLeftWidth+l111II11ll.style.borderRightWidth);var I1lll11lIl=l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-2].fromPos.top+l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-2].config.lineHeight,I111111IlI=l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-1].fromPos.top+I1l1l1111I;I111111IlI<I1lll11lIl&&(I111111IlI=I1lll11lIl),l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-1].fromPos.top=I111111IlI,l111II11ll.style.height=parseInt(I111111IlI+l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-1].config.lineHeight+l111II11ll.style.borderTopWidth+l111II11ll.style.borderBottomWidth);var I1l1llllIl=l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-1].fromPos.left-l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-2].fromPos.left-l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-2].config.lineHeight;if(I1l1llllIl<34){var l11ll1ll11=(I1l1llllIl=34)+l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-2].fromPos.left+l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-2].config.lineHeight,l11I11IIIl=l11ll1ll11-l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-1].fromPos.left;l111II11ll.style.width=parseInt(l111II11ll.style.width+l11I11IIIl),l111II11ll.style.columnLines[l111II11ll.style.columnLines.length-1].fromPos.left=l11ll1ll11}var l11IIIIIIl=l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-1].fromPos.top-l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-2].fromPos.top-l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-2].config.lineHeight;if(l11IIIIIIl<34){var I11l1lllII=(l11IIIIIIl=34)+l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-2].fromPos.top+l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-2].config.lineHeight,l11I11IIIl=I11l1lllII-l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-1].fromPos.top;l111II11ll.style.height=parseInt(l111II11ll.style.height+l11I11IIIl),l111II11ll.style.rowLines[l111II11ll.style.rowLines.length-1].fromPos.top=I11l1lllII}},updateControlsInTableLine:function(I111II11ll,I1III1111I){var l1II1I1Ill=this,I1l1l1111I=I111II11ll.style.columnLines||[],I11I1111Il=I111II11ll.style.rowLines||[],I1lll1l1II=I1l1l1111I.length,I1III11Ill=I11I1111Il.length,l111111III=I1III1111I.resizeColumnIndex,I1I1IIIIl1=I1III1111I.resizeRowIndex,l11II1III1=[];l111111III>-1&&(0==l111111III||l111111III==I1lll1l1II-1?l11II1III1.push({startColumnIndex:l111111III==I1lll1l1II-1?l111111III-1:l111111III,startRowIndex:0,endColumnIndex:l111111III==I1lll1l1II-1?l111111III-1:l111111III,endRowIndex:I1III11Ill-2}):l11II1III1.push({startColumnIndex:l111111III-1,startRowIndex:0,endColumnIndex:I1lll1l1II-2,endRowIndex:I1III11Ill-2})),I1I1IIIIl1>-1&&(0==I1I1IIIIl1||I1I1IIIIl1==I1III11Ill-1?l11II1III1.push({startColumnIndex:0,startRowIndex:I1I1IIIIl1==I1III11Ill-1?I1I1IIIIl1-1:I1I1IIIIl1,endColumnIndex:I1lll1l1II-2,endRowIndex:I1I1IIIIl1==I1III11Ill-1?I1I1IIIIl1-1:I1I1IIIIl1}):l11II1III1.push({startColumnIndex:0,startRowIndex:I1I1IIIIl1-1,endColumnIndex:I1lll1l1II-2,endRowIndex:I1III11Ill-2}));var I11I11IIII={},l11llllllI=[];l1II1I1Ill.refreshRectsAndMergeCells(I111II11ll,{eachRules:l11II1III1,callback:function(){l1II1I1Ill.refreshControlElsStyleBatch(l11llllllI,I11I11IIII)},filter:function(I111II11ll){},onControlChange:function(l111ll11I1){l111ll11I1&&l111ll11I1.id&&(l11llllllI.push(l111ll11I1.id),I11I11IIII[l111ll11I1.id]=l111ll11I1)}})},refreshControlElsStyleBatch:function(I111II11I1,l1III111II){if(I111II11I1.length){var l1ll1l1ll1="#"+I111II11I1.join(",#");l1lll111lI(l1ll1l1ll1,".ppt-paper-area").each(function(){var l111II1111=this,l1lll1111I=l111II1111.getAttribute("id"),I1ll1l1l11=l1III111II[l1lll1111I];l111II1111.style.left=I1ll1l1l11.style.left+"px",l111II1111.style.top=I1ll1l1l11.style.top+"px",l111II1111.style.width=I1ll1l1l11.style.width+"px",l111II1111.style.height=I1ll1l1l11.style.height+"px",l1III111II[l1lll1111I]=null,delete l1III111II[l1lll1111I]}),I111II11I1.length=0,I111II11I1=null,l1III111II=null}},updateControlRect:function(l111ll11I1,I1lll111II){var I1II1I1Il1=this,I1l1l111II=(I1lll111II.e,I1lll111II.el),I11l1111l1=(I1lll111II.$proxyDrag,I1lll111II.dragData),I1III1I1lI=I1lll111II.isUpdate,I1lll11l1I=(I1lll111II.isResizer,I1lll111II.isResizerRow);if(I1lll111II.isResizerColumn||I1lll11l1I)I1II1I1Il1.updateTableLines(l111ll11I1,I1lll111II),I1II1I1Il1.updateControlsInTableLine(l111ll11I1,I1lll111II);else if("tableLine"==l111ll11I1.htmlType)I1II1I1Il1.updateTableLineControl4Border(l111ll11I1,I11l1111l1),I1II1I1Il1.updateControlsInTableLine(l111ll11I1,{resizeColumnIndex:l111ll11I1.style.columnLines.length-1,resizeRowIndex:l111ll11I1.style.rowLines.length-1}),I1l1l111II&&(I1l1l111II.style.width=l111ll11I1.style.width+"px",I1l1l111II.style.height=l111ll11I1.style.height+"px");else if(I1III1I1lI&&I1lll111II.e&&I1II1I1Il1.clearControlAndTableLineRect(l111ll11I1),l111ll11I1.style.width=I11l1111l1.width,l111ll11I1.style.height=I11l1111l1.height,I1l1l111II&&(I1l1l111II.style.width=l111ll11I1.style.width+"px",I1l1l111II.style.height=l111ll11I1.style.height+"px"),l111ll11I1.htmlType==l1II1I1I1l.selectArea.name){var l111111l1I=l1lll111lI(".ppt-paper-area"),l1l1lllllI=I1II1I1Il1.data.style.width/l111111l1I.width()*l111ll11I1.style.width,I11ll1llIl=I1II1I1Il1.data.style.height/l111111l1I.height()*l111ll11I1.style.height;l111ll11I1.style.width4mm=l1l1lllllI,l111ll11I1.style.height4mm=I11ll1llIl;var I11I11IIlI=document.getElementById(l111ll11I1.id+"_box");I11I11IIlI.style.width=l111ll11I1.style.width+"px",I11I11IIlI.style.height=l111ll11I1.style.height+"px"}},clearControlAndTableLineRect:function(I111ll11ll){var I1III111I1=this;if(I111ll11ll&&I111ll11ll.style&&I111ll11ll.style.rect){var l1II1I1I1l=I111ll11ll.style.rect;if(l1II1I1I1l&&l1II1I1I1l.controlId&&l1II1I1I1l.tableLineId){var I1I1I11111=I1III111I1.findTableLineControl(l1II1I1I1l.tableLineId);I1III111I1.removeRectInTableLineByColumnAndRow(I1I1I11111,l1II1I1I1l.columnIndex,l1II1I1I1l.rowIndex),I111ll11ll.style.rect=null,I111ll11ll.parentId="",I111ll11ll.detailId="",delete I111ll11ll.style.rect}}},dragControl2TableLine:function(I111II11II,l1lll111lI){var l1II1I1I11=this,I1I1I111Il=null,I11I11111l=l1lll111lI.dragData,I1III1I1I1=!1;if("tableLine"==I111II11II.htmlType||"selectArea"==I111II11II.htmlType)return I1III1I1I1;var l1lll11lI1={left:I11I11111l.mouseX4relative,top:I11I11111l.mouseY4relative};if((I1I1I111Il=l1II1I1I11.findRectByPosOrRect(l1lll11lI1)).tableLineId&&I1I1I111Il.columnIndex>-1&&I1I1I111Il.rowIndex>-1){var l111111Il1=l1II1I1I11.getTableLineControl(I1I1I111Il.tableLineId),I1I1IIIIIl=l1II1I1I11.findRectInTableLineByColumnAndRow(l111111Il1,I1I1I111Il.columnIndex,I1I1I111Il.rowIndex);if(I1I1IIIIIl&&I1I1IIIIIl.controlId)I1I1IIIIIl.controlId==I111II11II.id&&(I1III1I1I1=!0);else{var I11II1II1I=oui.parseJson(oui.parseString(I111II11II.style.rect||{}));if(I11II1II1I.tableLineId&&I11II1II1I.controlId){var I11l11llll=l1II1I1I11.getTableLineControl(I11II1II1I.tableLineId);l1II1I1I11.removeRectInTableLineByColumnAndRow(I11l11llll,I11II1II1I.columnIndex,I11II1II1I.rowIndex)}I111II11II.style.zIndex<l111111Il1.style.zIndex&&(l1II1I1I11.data.style.currControlZIndex++,I111II11II.style.zIndex=l1II1I1I11.data.style.currControlZIndex);var I11llllll1=I1I1I111Il;I11llllll1.controlId=I111II11II.id,l1II1I1I11.setRectInTableLineByColumnAndRow(l111111Il1,I11llllll1),I111II11II.style.rect=I11llllll1,I1III1I1I1=!0}}if(I1III1I1I1){I111II11II.style.left=I1I1I111Il.left,I111II11II.style.top=I1I1I111Il.top,I111II11II.style.width=I1I1I111Il.right-I1I1I111Il.left,I111II11II.style.height=I1I1I111Il.bottom-I1I1I111Il.top,I111II11II.parentId=I1I1I111Il.tableLineId;var I11I1III1l=l1II1I1I11.getTableLineControl(I1I1I111Il.tableLineId);"detail"==I11I1III1l.controlType?I111II11II.detailId=I11I1III1l.bizId:I111II11II.detailId=""}else l1II1I1I11.clearControlAndTableLineRect(I111II11II);return I1III1I1I1},updateAllRectsInTableLine:function(I111ll11lI){var l1lll111I1=this;if("tableLine"==I111ll11lI.htmlType){var l1ll1l1l1I=I111ll11lI.style.columnLines||[],l1l1l1111I=I111ll11lI.style.rowLines||[],I11I1111lI=I111ll11lI.style.cellsMap||{},I1lll1l1ll=I111ll11lI.style.left,l1lll11lll=I111ll11lI.style.top,I111111Il1=I111ll11lI.style.borderLeftWidth,I1l1llll1I=I111ll11lI.style.borderTopWidth,I11II1II1l=[],I11l11llII={};for(var l11IIIIIlI in I11I1111lI){var I11I1IIIIl=I11I1111lI[l11IIIIIlI];if(I11I1IIIIl&&I11I1IIIIl.controlId&&I11I1IIIIl.tableLineId){var l1111IIIl1=l1ll1l1l1I[I11I1IIIIl.columnIndex].config.lineHeight+l1ll1l1l1I[I11I1IIIIl.columnIndex].fromPos.left+I1lll1l1ll+I111111Il1,I1ll1l11II=l1l1l1111I[I11I1IIIIl.rowIndex].config.lineHeight+l1l1l1111I[I11I1IIIIl.rowIndex].fromPos.top+l1lll11lll+I1l1llll1I,l111IIIIII=l1ll1l1l1I[I11I1IIIIl.columnIndex+1].fromPos.left+I1lll1l1ll+I111111Il1,I111II1III=l1l1l1111I[I11I1IIIIl.rowIndex+1].fromPos.top+l1lll11lll+I1l1llll1I;I11I1IIIIl.colspan&&I11I1IIIIl.colspan>1&&(l111IIIIII=l1ll1l1l1I[I11I1IIIIl.columnIndex+I11I1IIIIl.colspan].fromPos.left+I1lll1l1ll+I111111Il1),I11I1IIIIl.rowspan&&I11I1IIIIl.rowspan>1&&(I111II1III=l1l1l1111I[I11I1IIIIl.rowIndex+I11I1IIIIl.rowspan].fromPos.top+l1lll11lll+I1l1llll1I),I11I1IIIIl.left=l1111IIIl1,I11I1IIIIl.top=I1ll1l11II,I11I1IIIIl.right=l111IIIIII,I11I1IIIIl.bottom=I111II1III;var I1111I1Il1=l1lll111I1.getControlById(I11I1IIIIl.controlId);I1111I1Il1.style.left=I11I1IIIIl.left,I1111I1Il1.style.top=I11I1IIIIl.top,I1111I1Il1.style.width=I11I1IIIIl.right-I11I1IIIIl.left,I1111I1Il1.style.height=I11I1IIIIl.bottom-I11I1IIIIl.top,I1111I1Il1.style.rect=I11I1IIIIl,I11II1II1l.push(I11I1IIIIl.controlId),I11l11llII[I11I1IIIIl.controlId]=I1111I1Il1}}if(I11II1II1l&&I11II1II1l.length){var I1I111I1lI="#"+I11II1II1l.join(",#");l1lll111lI(I1I111I1lI,".ppt-paper-area").each(function(){var l111II111l=this,l1III1111I=l111II111l.getAttribute("id"),I1II1I1I1I=I11l11llII[l1III1111I].style;I1II1I1I1I&&(l111II111l.style.left=I1II1I1I1I.left+"px",l111II111l.style.top=I1II1I1I1I.top+"px",l111II111l.style.width=I1II1I1I1I.width+"px",l111II111l.style.height=I1II1I1I1I.height+"px")})}}},dragEndControlByPageDesignType:function(I111ll111I,I1III1111l,l1II1I1I1I,I1l1l111l1){var l11l111111=this;if(!I1III1111l.isSelectArea&&!l1II1I1I1I&&l11l111111.data.pageDesignType&&"normalForm"==l11l111111.data.pageDesignType){var I1III1I1lI=l11l111111.getControlIdxById(I111ll111I.id);l11l111111.data.controls.splice(I1III1I1lI,1);var I1III11I1l=l11l111111.findControlByPosOrRect(I1l1l111l1,I111ll111I);if(I1III11I1l){var l111111IIl=l11l111111.getControlIdxById(I1III11I1l.id);l11l111111.isPosAtControlHaffTop(I1III11I1l,I1l1l111l1)?l11l111111.data.controls.splice(l111111IIl,0,I111ll111I):l11l111111.data.controls.splice(l111111IIl+1,0,I111ll111I)}else l11l111111.data.controls.push(I111ll111I);l11l111111.updateControlsByPageDesignType(I111ll111I)}"page"==I111ll111I.controlType&&(I111ll111I.otherAttrs.nodeId||(I111ll111I.otherAttrs.nodeId=l1lll111lI(I1III1111l.el).attr("node-id")))},updateControlsByPageDesignType:function(I111ll11ll){var l1III11111=this;if(l1III11111.data.pageDesignType&&"normalForm"==l1III11111.data.pageDesignType){var I1II1I1I1l=l1III11111.data.controls||[],l1l1l1111I=0,I11I1111I1=null;l1III11111.data.style.currControlZIndex=0;for(var I1III1I1lI=0,l1lll11lII=I1II1I1I1l.length;I1III1I1lI<l1lll11lII;I1III1I1lI++)if((l111111llI=I1II1I1I1l[I1III1I1lI])&&!(l111111llI.style&&l111111llI.style.rect&&l111111llI.style.rect.tableLineId)){l1III11111.data.style.currControlZIndex++;l111111llI.style.top;l111111llI.style.top=l1l1l1111I,l111111llI.style.left=0,l111111llI.style.zIndex=l1III11111.data.style.currControlZIndex;"tableLine"==l111111llI.htmlType&&l1III11111.updateControlsInTableLine(l111111llI,{resizeColumnIndex:-1,resizeRowIndex:-1}),l1l1l1111I+=l111111llI.style.height,(I11I1111I1=document.getElementById(l111111llI.id)).style.left=l111111llI.style.left+"px",I11I1111I1.style.top=l111111llI.style.top+"px",I11I1111I1.style.zIndex=l111111llI.style.zIndex}for(var I1III1I1lI=0,l1lll11lII=I1II1I1I1l.length;I1III1I1lI<l1lll11lII;I1III1I1lI++){var l111111llI=I1II1I1I1l[I1III1I1lI];l111111llI&&(l111111llI.style&&l111111llI.style.rect&&l111111llI.style.rect.tableLineId&&(l1III11111.data.style.currControlZIndex++,l111111llI.style.zIndex=l1III11111.data.style.currControlZIndex,(I11I1111I1=document.getElementById(l111111llI.id)).style.zIndex=l111111llI.style.currControlZIndex))}}},updateCurrControlStyle:function(){var l111II111l=this,I1lll111l1=l111II111l.data.currentControl;if(I1lll111l1&&I1lll111l1.id){var I1II1I1I1I=document.getElementById(I1lll111l1.id);if(I1II1I1I1I.style.left=I1lll111l1.style.left+"px",I1II1I1I1I.style.top=I1lll111l1.style.top+"px",I1lll111l1.htmlType==l1II1I1I1l.selectArea.name){var I1I1I111lI=document.getElementById(I1lll111l1.id+"_box");I1I1I111lI.style.left=I1lll111l1.style.left+"px",I1I1I111lI.style.top=I1lll111l1.style.top+"px"}if(l111II111l.clearControlAndTableLineRect(I1lll111l1),l111II111l.updateTableLineMaxRect(I1lll111l1),l111II111l.updateAllRectsInTableLine(I1lll111l1),l111II111l.inDetail(I1lll111l1)){var l11I1111l1=l1lll111lI("#"+I1lll111l1.id).find(".control-container-pabs");l11I1111l1&&l11I1111l1.length&&l11I1111l1.remove()}else if(I1lll111l1.formField||I1lll111l1.isFormField){var I1lll1l111=oui.getById("items").getHtmlByTplId("item-tpl",{item:I1lll111l1});l1lll111lI("#"+I1lll111l1.id).replaceWith(I1lll1l111),l1lll111lI("#"+I1lll111l1.id).addClass("active")}"tableLine"!=I1lll111l1.htmlType||l111II111l.isDragging4SelectArea(I1lll111l1)||l111II111l.refreshTableLineMergeCells(I1lll111l1),l111II111l.showOperationArea(I1lll111l1),l111II111l.setCurrPropsData(I1lll111l1,"center","dragEndField")}},clearControlRefs:function(){if(oui.routerView&&oui.routerView.refs){var l111ll111I=oui.routerView.refs;for(var I1III11111 in l111ll111I)l111ll111I[I1III11111]=null,delete l111ll111I[I1III11111]}},dragEndControl:function(l111II11II){l111II11II.e;var l1lll111ll=l111II11II.el,l1ll1l1l1l=l111II11II.$proxyDrag,I1l1l11111=l111II11II.dragData,I11l111111=l111II11II.isUpdate,I1III1I1l1=l111II11II.isResizer,I1III11I1I=(l111II11II.isResizerRow,l111II11II.isResizerColumn,this);l1ll1l1l1l.removeClass("control-pabs-component"),I1l1l11111.x<0&&(I1l1l11111.x=0),I1l1l11111.y<0&&(I1l1l11111.y=0);var I111111lll=l1lll111lI(l1lll111ll).attr("id"),I1I1IIIIlI="";I11l111111&&I111111lll&&(I1I1IIIIlI=I1III11I1I.getControlById(I111111lll)),I1III11I1I.clearControlRefs(),oui.clearByContainer("#control_items"),oui.clear4notUse();var l11II1IIll=!1;if(I1III1I1l1)I1III11I1I.updateControlRect(I1I1IIIIlI,l111II11II),I1III11I1I.updateTableLineMaxRect(I1I1IIIIlI),I1III11I1I.updateControlsByPageDesignType(I1I1IIIIlI);else{var l11I11IIII={left:I1l1l11111.mouseX4relative,top:I1l1l11111.mouseY4relative};if(I11l111111){if(l11II1IIll=I1III11I1I.dragControl2TableLine(I1I1IIIIlI,l111II11II))l1lll111ll.style.left=I1I1IIIIlI.style.left+"px",l1lll111ll.style.top=I1I1IIIIlI.style.top+"px",l1lll111ll.style.width=I1I1IIIIlI.style.width+"px",l1lll111ll.style.height=I1I1IIIIlI.style.height+"px",l1lll111ll.style.zIndex=I1I1IIIIlI.style.zIndex;else if(I1I1IIIIlI.style.left=I1l1l11111.x,I1I1IIIIlI.style.top=I1l1l11111.y,l1lll111ll.style.left=I1I1IIIIlI.style.left+"px",l1lll111ll.style.top=I1I1IIIIlI.style.top+"px",I1I1IIIIlI.htmlType==l1II1I1I1l.selectArea.name){var I11lllll11=document.getElementById(I1I1IIIIlI.id+"_box");I11lllll11.style.left=I1I1IIIIlI.style.left+"px",I11lllll11.style.top=I1I1IIIIlI.style.top+"px"}I1III11I1I.updateTableLineMaxRect(I1I1IIIIlI),I1III11I1I.updateAllRectsInTableLine(I1I1IIIIlI),I1III11I1I.dragEndControlByPageDesignType(I1I1IIIIlI,l111II11II,l11II1IIll,l11I11IIII)}else{var I11I1IIIlI=I1III11I1I.data.canCloneControl,I1I1IIIIlI=I1III11I1I.getElConfigByKeys(l1lll111ll,I1III11I1I.controlProps,I1III11I1I.controlDomAttrPrefix);I11I1IIIlI=I11I1IIIlI||I1I1IIIIlI.canCloneControl,I1I1IIIIlI.canCloneControl=I11I1IIIlI;var I1111IIIl1=I1III11I1I.findDefaultControlByBizControlType(I1I1IIIIlI.controlType,I1I1IIIIlI.htmlType,I1I1IIIIlI),I1II1I1111=oui.parseJson(oui.parseString(I1111IIIl1)),l111IIIIl1={style:I1III11I1I.data.innerStyle.style,innerStyle:{styleTitle:I1III11I1I.data.innerStyle.styleTitle,styleFieldOuter:I1III11I1I.data.innerStyle.styleFieldOuter,styleInnerOuter:I1III11I1I.data.innerStyle.styleInnerOuter,styleField:I1III11I1I.data.innerStyle.styleField}};l111IIIIl1=oui.parseJson(oui.parseString(l111IIIIl1)),"label"==(I1I1IIIIlI=l1lll111lI.extend(!0,l111IIIIl1,I1II1I1111,I1I1IIIIlI)).htmlType&&(I1I1IIIIlI.description=I1I1IIIIlI.title||I1I1IIIIlI.description),I1III11I1I.data.style.currControlZIndex++,I1I1IIIIlI.style.zIndex=I1III11I1I.data.style.currControlZIndex;var I111ll1lll=I1I1IIIIlI.id;I1I1IIIIlI.id=I1I1IIIIlI.id||I1III11I1I.newId(),I1I1IIIIlI.bizId=I1I1IIIIlI.bizId||I1III11I1I.newId(),I1I1IIIIlI.name=I1I1IIIIlI.name||l1lll111lI.trim(l1lll111lI(l1lll111ll).text()),I1I1IIIIlI.style.left=I1l1l11111.x,I1I1IIIIlI.style.top=I1l1l11111.y,I1I1IIIIlI.style.width=I1I1IIIIlI.style.width||230,I1I1IIIIlI.style.height=I1I1IIIIlI.style.height||I1l1l11111.height,oui.isEmptyObject(I1I1IIIIlI.innerStyle)&&(I1I1IIIIlI.innerStyle.styleField={},I1I1IIIIlI.innerStyle.styleFieldOuter={},I1I1IIIIlI.innerStyle.styleInnerOuter={},I1I1IIIIlI.innerStyle.styleTitle={}),l11II1IIll=I1III11I1I.dragControl2TableLine(I1I1IIIIlI,l111II11II),I1III11I1I.data.controls.push(I1I1IIIIlI),I1III11I1I.addTableLineControl(I1I1IIIIlI),I111ll1lll&&l1lll111lI(l1lll111ll).addClass("control-pabs-disable");var I1111l1lIl=oui.getById("items").getHtmlByTplId("item-tpl",{item:I1I1IIIIlI}),I1l111l1l1=oui.getById("items").getEl();l1lll111lI(I1l111l1l1).find(".ppt-paper-area").append(I1111l1lIl),I1III11I1I.dragEndControlByPageDesignType(I1I1IIIIlI,l111II11II,l11II1IIll,l11I11IIII),l1lll111lI(".active",".ppt-paper-area").removeClass("active"),l1lll111lI("#"+I1I1IIIIlI.id).addClass("active")}}if(I11l111111)if(I1III11I1I.inDetail(I1I1IIIIlI)){if(I1I1IIIIlI.formField||I1I1IIIIlI.isFormField){I1111l1lIl=oui.getById("items").getHtmlByTplId("item-tpl",{item:I1I1IIIIlI});l1lll111lI("#"+I1I1IIIIlI.id).replaceWith(I1111l1lIl),l1lll111lI("#"+I1I1IIIIlI.id).addClass("active")}}else if(I1I1IIIIlI.formField||I1I1IIIIlI.isFormField){I1111l1lIl=oui.getById("items").getHtmlByTplId("item-tpl",{item:I1I1IIIIlI});l1lll111lI("#"+I1I1IIIIlI.id).replaceWith(I1111l1lIl),l1lll111lI("#"+I1I1IIIIlI.id).addClass("active")}I1III1I1l1?(I1III11I1I.refreshTableLineMergeCells(I1I1IIIIlI),I1III11I1I.changed4props({},function(){I1III11I1I.hideOperationArea(),I1III11I1I.showOperationArea(I1I1IIIIlI),I1III11I1I.setCurrPropsData(I1I1IIIIlI,"center","dragEndField")})):("tableLine"!=I1I1IIIIlI.htmlType||I1III11I1I.isDragging4SelectArea(I1I1IIIIlI)?(l111II11II.isSelectArea||I1III11I1I.refreshTableLineMergeCells(I1I1IIIIlI),I1III11I1I.showOperationArea(I1I1IIIIlI,l111II11II)):I1III11I1I.refreshTableLineMergeCells(I1I1IIIIlI),I1III11I1I.setCurrPropsData(I1I1IIIIlI,"center","dragEndField")),oui.parse()},matchEachRules:function(l111II11I1,l1lll1111l){var l1II1I1Ill=this,I1l1l11111=!1;if(!l1lll1111l||!l1lll1111l.length)return!0;for(var l11I11111I=0,I1lll1l11I=l1lll1111l.length;l11I11111I<I1lll1l11I;l11I11111I++)if(l1II1I1Ill.matchEachRule(l111II11I1,l1lll1111l[l11I11111I])){I1l1l11111=!0;break}return I1l1l11111},matchEachRule:function(I111ll111I,l1lll1111I){var I1ll1l1ll1=!1,I1I1I1111I=!1;return I111ll111I.columnIndex>=l1lll1111I.startColumnIndex&&I111ll111I.columnIndex<=l1lll1111I.endColumnIndex?I1ll1l1ll1=!0:I111ll111I.columnIndex<l1lll1111I.startColumnIndex&&I111ll111I.colspan&&I111ll111I.colspan>1&&I111ll111I.columnIndex+I111ll111I.colspan-1>=l1lll1111I.startColumnIndex&&(I1ll1l1ll1=!0),I111ll111I.rowIndex>=l1lll1111I.startRowIndex&&I111ll111I.rowIndex<=l1lll1111I.endRowIndex?I1I1I1111I=!0:I111ll111I.rowIndex<l1lll1111I.startRowIndex&&I111ll111I.rowspan&&I111ll111I.rowspan>1&&I111ll111I.rowIndex+I111ll111I.rowspan-1>=l1lll1111I.startRowIndex&&(I1I1I1111I=!0),I1ll1l1ll1&&I1I1I1111I},refreshRectsAndMergeCells:function(I111ll1111,l1lll111I1){var I1ll1l1llI=(l1lll111I1=l1lll111I1||{}).eachRules||[],I1l1l1111I=l1lll111I1.callback,I11I1111II=l1lll111I1.onControlChange,I1III1I11I=l1lll111I1.filter,I1III11IlI=this;if("tableLine"==I111ll1111.htmlType){I1III11IlI.updateTableLineMaxRect(I111ll1111);var I111111II1=I111ll1111.style.mergeCellsMap||{};for(var I1l1lllllI in I111111II1){var I11ll1ll1I=I111111II1[I1l1lllllI];if(I11ll1ll1I){var l11l11llII=I11ll1ll1I.startColumnIndex,l11IIIII11=I11ll1ll1I.startRowIndex;if(!I1III11IlI.matchEachRules({columnIndex:l11l11llII,rowIndex:l11IIIII11,colspan:I11ll1ll1I.endColumnIndex-I11ll1ll1I.startColumnIndex+1,rowspan:I11ll1ll1I.endRowIndex-I11ll1ll1I.startRowIndex+1},I1ll1l1llI))continue;I1III11IlI.refreshTableLineMergeCell(I111ll1111,l11l11llII,l11IIIII11)}}I1III11IlI.refreshTableLineMergeCells(I111ll1111);var I11I1III1l=I111ll1111.style.columnLines||[],I1111IIIll=I111ll1111.style.rowLines||[],I1ll1l11I1=I111ll1111.style.cellsMap||{},l111llllI1=I111ll1111.style.left,l111ll1lll=I111ll1111.style.top,l1111I1I1I=I111ll1111.style.borderLeftWidth,l1l111l1ll=I111ll1111.style.borderTopWidth;for(var l11I111IlI in I1ll1l11I1){var l11111l1I1=I1ll1l11I1[l11I111IlI];if(l11111l1I1&&l11111l1I1.controlId&&l11111l1I1.tableLineId){if(I1III1I11I){var I1l11ll1Il=I1III1I11I(l11111l1I1);if("boolean"==typeof I1l11ll1Il&&!I1l11ll1Il)continue}var I1l1l1l1Il=!1;if(I1ll1l1llI&&I1ll1l1llI.length&&!I1III11IlI.matchEachRules(l11111l1I1,I1ll1l1llI))continue;var l11ll1l1lI=I1III11IlI.getControlById(l11111l1I1.controlId),l1II11I11I=I11I1III1l[l11111l1I1.columnIndex].config.lineHeight+I11I1III1l[l11111l1I1.columnIndex].fromPos.left+l111llllI1+l1111I1I1I,I1I111IIII=I1111IIIll[l11111l1I1.rowIndex].config.lineHeight+I1111IIIll[l11111l1I1.rowIndex].fromPos.top+l111ll1lll+l1l111l1ll,I1I11I111l=I11I1III1l[l11111l1I1.columnIndex+1].fromPos.left+l111llllI1+l1111I1I1I,l1IIII11lI=I1111IIIll[l11111l1I1.rowIndex+1].fromPos.top+l111ll1lll+l1l111l1ll;l11111l1I1.colspan&&l11111l1I1.colspan>1&&(I1I11I111l=I11I1III1l[l11111l1I1.columnIndex+l11111l1I1.colspan].fromPos.left+l111llllI1+l1111I1I1I),l11111l1I1.rowspan&&l11111l1I1.rowspan>1&&(l1IIII11lI=I1111IIIll[l11111l1I1.rowIndex+l11111l1I1.rowspan].fromPos.top+l111ll1lll+l1l111l1ll),l11111l1I1.left!=l1II11I11I&&(l11111l1I1.left=l1II11I11I,I1l1l1l1Il=!0),l11111l1I1.top!=I1I111IIII&&(l11111l1I1.top=I1I111IIII,I1l1l1l1Il=!0),l11111l1I1.right!=I1I11I111l&&(l11111l1I1.right=I1I11I111l,I1l1l1l1Il=!0),l11111l1I1.bottom!=l1IIII11lI&&(l11111l1I1.bottom=l1IIII11lI,I1l1l1l1Il=!0),l11ll1l1lI.style.left!=l11111l1I1.left&&(l11ll1l1lI.style.left=l11111l1I1.left,I1l1l1l1Il=!0),l11ll1l1lI.style.top!=l11111l1I1.top&&(l11ll1l1lI.style.top=l11111l1I1.top,I1l1l1l1Il=!0),l11ll1l1lI.style.width!=l11111l1I1.right-l11111l1I1.left&&(l11ll1l1lI.style.width=l11111l1I1.right-l11111l1I1.left,I1l1l1l1Il=!0),l11ll1l1lI.style.height!=l11111l1I1.bottom-l11111l1I1.top&&(l11ll1l1lI.style.height=l11111l1I1.bottom-l11111l1I1.top,I1l1l1l1Il=!0),l11ll1l1lI.style.rect=l11111l1I1,I1l1l1l1Il&&I11I1111II&&I11I1111II(l11ll1l1lI)}}I1l1l1111I&&I1l1l1111I(I111ll1111)}},isDragging4SelectArea:function(I111II11l1){return I111II11l1.style.isDragging4SelectArea},showOperationArea:function(l111ll11II,l1lll111I1){var I1II1I1I1I=this;if(l111ll11II){var I1I1I111l1=l1lll111lI("#operation-layer"),I11I1111II=I1II1I1I1I.isDragging4SelectArea(l111ll11II),l1III1I11l=null;if("tableLine"==l111ll11II.htmlType&&l1lll111I1&&l1lll111I1.isSelectArea&&!l1lll111I1.isResizer){var l1III11II1=l1lll111I1.dragData;if(!l1III11II1){var I111111I1I=I1II1I1I1I.getXY(l1lll111I1.e);l1III11II1={startSelectColumnIndex:l1lll111I1.startSelectColumnIndex,startSelectRowIndex:l1lll111I1.startSelectRowIndex,dropPos:l1lll111I1.dropPos,startMouseX:I111111I1I.x,startMouseY:I111111I1I.y,scrollContainerLeft:l1lll111I1.scrollContainerLeft,scrollContainerTop:l1lll111I1.scrollContainerTop,mouseX:I111111I1I.x,mouseY:I111111I1I.y}}(l1III1I11l=I1II1I1I1I.findRectBySelectArea(l111ll11II,l1III11II1))&&(I1II1I1I1I.selectRect=l1III1I11l,I1II1I1I1I.showOperationSelectByTableLineSelectRect(l111ll11II,l1III1I11l))}else I1II1I1I1I.selectRect&&I1II1I1I1I.selectRect.tableLineId==l111ll11II.id?(l1III1I11l=I1II1I1I1I.findRectBySelectRect(l111ll11II,I1II1I1I1I.selectRect))&&(I1II1I1I1I.selectRect=l1III1I11l,I1II1I1I1I.showOperationSelectByTableLineSelectRect(l111ll11II,l1III1I11l)):I1I1I111l1.find(".operation-select-area").css({display:"none"});if(I11I1111II?I1I1I111l1.addClass("drag-select-area"):I1I1I111l1.removeClass("drag-select-area"),I1I1I111l1.css({left:l111ll11II.style.left-I1II1I1I1I.operationAreaOffset+"px",top:l111ll11II.style.top-I1II1I1I1I.operationAreaOffset+"px",width:l111ll11II.style.width+2*I1II1I1I1I.operationAreaOffset+"px",height:l111ll11II.style.height+2*I1II1I1I1I.operationAreaOffset+"px"}),l111ll11II.canCloneControl?I1I1I111l1.find("[oui-e-click=event2cloneControl]").show():I1I1I111l1.find("[oui-e-click=event2cloneControl]").hide(),I1I1I111l1.attr("control-pabs-id",l111ll11II.id),"selectArea"==l111ll11II.htmlType?I1I1I111l1.find(".ctrl-del-copy").hide():I1I1I111l1.find(".ctrl-del-copy").show(),"tableLine"==l111ll11II.htmlType){if(!l1lll111lI(".control-line-pabs[control-pabs-id="+l111ll11II.id+"]").length){I1I1I111l1.find(".merge-cell").remove(),I1I1I111l1.find(".control-line-pabs").remove(),I1I1I111l1.find(".control-table-num-pabs").remove();var l1l1lllll1=oui.getById("items").getHtmlByTplId("control-tableLine-drag-tpl",{item:l111ll11II,rect:l1III1I11l});I1I1I111l1.append(l1l1lllll1)}}else I1I1I111l1.find(".control-table-num-pabs").remove(),I1I1I111l1.find(".merge-cell").remove(),I1I1I111l1.find(".control-line-pabs").remove();I1I1I111l1.show()}},isTableColumnActive:function(I111II1111,l1III1111l){var l1II1I1IIl=this,l1I1I111Il=!1;return l1II1I1IIl.selectRect?(l1III1111l>=l1II1I1IIl.selectRect.startColumnIndex&&l1III1111l<=l1II1I1IIl.selectRect.endColumnIndex&&(l1I1I111Il=!0),l1I1I111Il):l1I1I111Il},isTableRowActive:function(l111II11II,I1III111Il){var l1II1I1I11=this,I1I1I111l1=!1;if(l1II1I1I11.selectRect)return I1III111Il>=l1II1I1I11.selectRect.startRowIndex&&I1III111Il<=l1II1I1I11.selectRect.endRowIndex&&(I1I1I111l1=!0),I1I1I111l1},hideOperationArea:function(){var l111ll11II=l1lll111lI("#operation-layer");l111ll11II.hide(),l111ll11II.find(".control-line-pabs").remove(),l111ll11II.find(".control-table-num-pabs").remove(),l1lll111lI(".proxy-drag-placeholder").hide()},bindControlPropsTitleEvents:function(){var I111ll11II="attribute-tit-active",I1III111Il=this;l1lll111lI(document).on("click",".design-set-attribute-tit",function(l111II1111){var I1II1I1I1l=l111II1111.target||l111II1111.srcElement;if(!I1III111Il.checkData())return!1;if(l1lll111lI(I1II1I1I1l).is(".design-set-attribute-tit")||(I1II1I1I1l=l1lll111lI(I1II1I1I1l).closest(".design-set-attribute-tit")[0]),I1II1I1I1l)if(l1lll111lI(I1II1I1I1l).hasClass(I111ll11II))l1lll111lI(I1II1I1I1l).removeClass(I111ll11II),l1lll111lI(I1II1I1I1l).closest(".design-set-content").find("."+I111ll11II).removeClass(I111ll11II);else{l1lll111lI(I1II1I1I1l).closest(".design-set-content").find("."+I111ll11II).removeClass(I111ll11II),l1lll111lI(I1II1I1I1l).addClass(I111ll11II);var l1l1l111II=l1lll111lI(I1II1I1I1l).parent();I1III111Il.currAccordingActiveId=l1l1l111II.attr("id")}})},findAccordingActiveCls:function(l111II111l,I1lll111ll){var I1ll1l1lIl=this,I1I1I111l1="";return I1ll1l1lIl.currAccordingActiveId==l111II111l?I1I1I111l1="attribute-tit-active":I1ll1l1lIl.currAccordingActiveId||I1lll111ll&&(I1I1I111l1="attribute-tit-active"),I1I1I111l1},renderPaperStyle:function(){var l111II11ll=this,I1III111lI=l1lll111lI(".ppt-paper-area");I1III111lI.removeClass("bg-repeat"),I1III111lI.removeClass("bg-center"),I1III111lI.removeClass("bg-cover");var I1II1I1IlI=I1III111lI.find("link[link-id]");I1II1I1IlI&&I1II1I1IlI.length?I1II1I1IlI.replaceWith('<link link-id="page-link"  rel="stylesheet" type="text/css" href="'+l111II11ll.findThemeUrl()+'" />'):I1III111lI.prepend('<link link-id="page-link"  rel="stylesheet" type="text/css" href="'+l111II11ll.findThemeUrl()+'" />'),I1III111lI.addClass("bg-"+l111II11ll.data.style.backgroundImageFillType);var l1I1I111ll=l111II11ll.findStyleString(l111II11ll.data.style,"common-style-tpl");I1III111lI.attr("style",l1I1I111ll),l1lll111lI(".ppt-paper-area-outer").css({width:l111II11ll.data.style.width+100+l111II11ll.data.style.cellType,height:l111II11ll.data.style.height+100+l111II11ll.data.style.cellType}),I1III111lI.css({width:l111II11ll.data.style.width+l111II11ll.data.style.cellType,height:l111II11ll.data.style.height+l111II11ll.data.style.cellType});var I11I1111Il=18+I1III111lI[0].offsetTop,I1lll1l1ll=18+l1lll111lI(".ppt-paper-area").offset().left-l1lll111lI(".design-middle").offset().left,l1III11Ill=I11I1111Il,I111111Il1=l1lll111lI(".design-middle");l1III11Ill-=I111111Il1[0].scrollTop,I1lll1l1ll-=I111111Il1[0].scrollLeft,l1lll111lI(".ruler-left").css({"background-position":"top "+l1III11Ill+"px left 0"}),l1lll111lI(".ruler-top").css({"background-position":"top 0 left "+I1lll1l1ll+"px"})},changeAllControls:function(l111II11ll,I1lll111lI){var l1ll1l1lII=this;l111II11ll=l111II11ll.replace("currentControl.","");for(var I1l1l1111l=l1ll1l1lII.data.controls||[],l11l1111l1=0,I1lll1l1I1=I1l1l1111l.length;l11l1111l1<I1lll1l1I1;l11l1111l1++)if(I1l1l1111l[l11l1111l1]&&"selectArea"!=I1l1l1111l[l11l1111l1].htmlType&&"tableLine"!=I1l1l1111l[l11l1111l1].htmlType)try{oui.JsonPathUtil.setObjByPath(l111II11ll,I1l1l1111l[l11l1111l1],I1lll111lI,!0),l1ll1l1lII.changedControlProp(I1l1l1111l[l11l1111l1],l111II11ll)}catch(l111ll11II){}},changed4otherCellType:function(I111ll11l1){var l1III1111I=this;try{var l1II1I1II1=l1lll111lI(".ppt-paper-area"),I1I1I111II=l1lll111lI(I111ll11l1.el).attr("bindProp"),l11I1111II=oui.JsonPathUtil.getJsonByPath(I1I1I111II,l1III1111I.data)||0;if("mm"==l1III1111I.data.style.cellType){var l1lll1l11l=I1I1I111II+"4mm",l1lll11l1l=l1III1111I.data.style.width/l1II1I1II1.width()*l11I1111II;oui.JsonPathUtil.setObjByPath(l1lll1l11l,l1III1111I.data,l1lll11l1l,!0)}}catch(l111II11ll){}},changed4propsRealTime:function(I111ll11I1,l1lll11111){var I1II1I1I1l=this,I1I1I111I1=I1II1I1I1l.data.currentControl;if(document.getElementById(I1I1I111I1.id)||(I1II1I1I1l.state="down2selectPage"),"init,down2selectPage".split(",").indexOf(I1II1I1I1l.state)>-1){if(I1II1I1I1l.renderPaperStyle(),I111ll11I1&&I111ll11I1.el&&(I11l11111l=l1lll111lI(I111ll11I1.el).attr("bindprop")||l1lll111lI(I111ll11I1.el).attr("invoke-prop")||"")&&I11l11111l.indexOf("currentControl")>=0){try{I1II1I1I1l.changeAllControls(I11l11111l,oui.JsonPathUtil.getJsonByPath(I11l11111l,I1II1I1I1l.data))}catch(l111ll11ll){}I1II1I1I1l.renderCenterAll()}I1II1I1I1l.data.currentControl==I1I1I111I1?l1lll11111&&l1lll11111():(I1II1I1I1l.data.tempData={},I1II1I1I1l.data.tempControl={})}else if(I1I1I111I1.id){var I11l11111l=l1lll111lI(I111ll11I1.el).attr("bindprop")||l1lll111lI(I111ll11I1.el).attr("invoke-prop")||"";I11l11111l&&I1II1I1I1l.changedControlProp(I1I1I111I1,I11l11111l);var I1III1I11I=document.getElementById(I1I1I111I1.id).getAttribute("drag-status");oui.clearByContainer("#"+I1I1I111I1.id),oui.clear4notUse();var l1lll11l1I=oui.getById("items").getHtmlByTplId("center-control-tpl",{item:I1I1I111I1});I1II1I1I1l.patchCurrControl(I1I1I111I1,l1lll11l1I),document.getElementById(I1I1I111I1.id).setAttribute("drag-status",I1III1I11I),oui.parse(),setTimeout(function(){I1II1I1I1l.data.currentControl==I1I1I111I1?(l1lll111lI("#"+I1I1I111I1.id).addClass("active"),l1lll11111&&l1lll11111(),I1II1I1I1l.showOperationArea(I1I1I111I1)):(I1II1I1I1l.data.tempData={},I1II1I1I1l.data.tempControl={})},30)}},changedControlProp:function(I111ll111I,I1lll1111l){var l1II1I1I1I=this;(I1lll1111l=I1lll1111l.replace("currentControl.",""))&&(0==I1lll1111l.indexOf("style.")?l1II1I1I1I.findControlStyle4Dom(I111ll111I,!!I111ll111I.parentId):0==I1lll1111l.indexOf("innerStyle.styleInnerOuter.")?l1II1I1I1I.findControlStyleInnerOuter4Dom(I111ll111I,!!I111ll111I.parentId):0==I1lll1111l.indexOf("innerStyle.styleTitle.")?l1II1I1I1I.findControlInnerStyleTitle4Dom(I111ll111I,!!I111ll111I.parentId):0==I1lll1111l.indexOf("innerStyle.styleFieldOuter.")?l1II1I1I1I.findStyleFieldOuter4Dom(I111ll111I,!!I111ll111I.parentId):0==I1lll1111l.indexOf("innerStyle.styleField.")&&l1II1I1I1I.findFieldStyle4Dom(I111ll111I,!!I111ll111I.parentId))},changed4props:function(I111ll111I,I1lll111l1){var l1II1I1III=this;l1II1I1III.data.currentControl;l1II1I1III.checkData(!0)&&((oui.browser.ie||oui.browser.isEdge)&&l1lll111lI(".fielderror").remove(),l1II1I1III.changed4propsRealTime(I111ll111I,I1lll111l1))},patchCurrControl:function(I111ll111I,I1III111I1){if(oui.browser.ie||oui.browser.isEdge)if(I111ll111I.htmlType==l1II1I1I1l.selectArea.name){document.getElementById(I111ll111I.id).outerHTML=l1lll111lI.trim(I1III111I1);l1ll1l1l1I=oui.getById("items").getHtmlByTplId("selectArea-box-tpl",{item:I111ll111I});document.getElementById(I111ll111I.id+"_box").outerHTML=l1lll111lI.trim(l1ll1l1l1I)}else document.getElementById(I111ll111I.id).outerHTML=l1lll111lI.trim(I1III111I1);else if(I111ll111I.htmlType==l1II1I1I1l.selectArea.name){oui.getById("absoluteProps").patchDom(document.getElementById(I111ll111I.id),l1lll111lI.trim(I1III111I1));var l1ll1l1l1I=oui.getById("items").getHtmlByTplId("selectArea-box-tpl",{item:I111ll111I});oui.getById("absoluteProps").patchDom(document.getElementById(I111ll111I.id+"_box"),l1lll111lI.trim(l1ll1l1l1I))}else oui.getById("absoluteProps").patchDom(document.getElementById(I111ll111I.id),l1lll111lI.trim(I1III111I1))},findBorderWidth:function(l111II11Il,l1III111I1){var I1II1I1Il1=this,l1l1l111I1=[I1II1I1Il1.hasBorderLeft(l111II11Il,l1III111I1),I1II1I1Il1.hasBorderTop(l111II11Il,l1III111I1),I1II1I1Il1.hasBorderRight(l111II11Il,l1III111I1),I1II1I1Il1.hasBorderBottom(l111II11Il,l1III111I1)];return l1l1l111I1.sort(),l1l1l111I1[l1l1l111I1.length-1]||0},findBorderRadius:function(l111ll111l,l1lll111ll){var l1II1I1I1I=l1lll111ll.replace("tempControl.","").replace("._borders","");return(oui.JsonPathUtil.getJsonByPath(l1II1I1I1I,l111ll111l)||{}).borderRadius||0},findBorderColor:function(I111II11l1,I1lll111lI){var I1II1I1III=I1lll111lI.replace("tempControl.","").replace("._borders",""),l1I1I11111=oui.JsonPathUtil.getJsonByPath(I1II1I1III,I111II11l1)||{},I11l1111lI=l1I1I11111.borderLeftColor||l1I1I11111.borderTopColor||l1I1I11111.borderRightColor||l1I1I11111.borderBottomColor;return I11l1111lI=I11l1111lI||"#e6e6e6"},changed4setBorderStyle:function(I111ll11ll){var I1lll111Il=this,l1ll1l1l1I=I1lll111Il.data.currentControl,l1l1l111II=l1lll111lI(I111ll11ll.el).attr("bindprop"),l11I1111l1=l1l1l111II.replace("._borderStyle","").replace("tempControl.",""),l1III1I111=oui.JsonPathUtil.getJsonByPath(l1l1l111II,I1lll111Il.data)||"solid",l1lll11l11=oui.JsonPathUtil.getJsonByPath(l11I1111l1,l1ll1l1l1I)||{};l1lll11l11.borderLeftStyle=l1III1I111,l1lll11l11.borderTopStyle=l1III1I111,l1lll11l11.borderRightStyle=l1III1I111,l1lll11l11.borderBottomStyle=l1III1I111,l1ll1l1l1I.id&&I1lll111Il.updateControlRect4Border(l1ll1l1l1I),"init,down2selectPage".split(",").indexOf(I1lll111Il.state)>-1?I1lll111Il.changed4props(I111ll11ll,function(){try{I1lll111Il.changeAllControls(l11I1111l1+".borderLeftStyle",l1III1I111),I1lll111Il.changeAllControls(l11I1111l1+".borderTopStyle",l1III1I111),I1lll111Il.changeAllControls(l11I1111l1+".borderRightStyle",l1III1I111),I1lll111Il.changeAllControls(l11I1111l1+".borderBottomStyle",l1III1I111),I1lll111Il.renderCenterAll()}catch(l111II11l1){}}):I1lll111Il.changed4props(I111ll11ll,function(){I1lll111Il.setCurrPropsData(l1ll1l1l1I,"center","down2selectField")})},findBorderStyle:function(I111ll11II,l1III111Il){var l1II1I1I1l=this,I1I1I111ll=l1III111Il.replace("tempControl.","").replace("._borders",""),I11I11111l=oui.JsonPathUtil.getJsonByPath(I1I1I111ll,I111ll11II)||{};return l1II1I1I1l.hasBorderLeft(I111ll11II,l1III111Il)?I11I11111l.borderLeftStyle||"solid":l1II1I1I1l.hasBorderTop(I111ll11II,l1III111Il)?I11I11111l.borderTopStyle||"solid":l1II1I1I1l.hasBorderRight(I111ll11II,l1III111Il)?I11I11111l.borderRightStyle||"solid":l1II1I1I1l.hasBorderBottom(I111ll11II,l1III111Il)?I11I11111l.borderBottomStyle||"solid":"solid"},changed4setBorderColor:function(l111II11I1){var l1III111I1=this,I1II1I1I1I=l1III111I1.data.currentControl,l1l1l1111I=l1lll111lI(l111II11I1.el).attr("invoke-prop"),l11l1111l1=l1l1l1111I.replace("._borderColor","").replace("tempControl.",""),I1III1I1II=oui.JsonPathUtil.getJsonByPath(l1l1l1111I,l1III111I1.data)||"",l1III11I1l=oui.JsonPathUtil.getJsonByPath(l11l1111l1,I1II1I1I1I)||{};l1III11I1l.borderLeftColor=I1III1I1II,l1III11I1l.borderTopColor=I1III1I1II,l1III11I1l.borderRightColor=I1III1I1II,l1III11I1l.borderBottomColor=I1III1I1II,I1II1I1I1I.id&&l1III111I1.updateControlRect4Border(I1II1I1I1I),"init,down2selectPage".split(",").indexOf(l1III111I1.state)>-1?l1III111I1.changed4propsRealTime(l111II11I1,function(){try{l1III111I1.changeAllControls(l11l1111l1+".borderLeftColor",I1III1I1II),l1III111I1.changeAllControls(l11l1111l1+".borderTopColor",I1III1I1II),l1III111I1.changeAllControls(l11l1111l1+".borderRightColor",I1III1I1II),l1III111I1.changeAllControls(l11l1111l1+".borderBottomColor",I1III1I1II),l1III111I1.renderCenterAll()}catch(I111II11l1){}}):l1III111I1.changed4propsRealTime(l111II11I1,function(){l1III111I1.setCurrPropsData(I1II1I1I1I,"center","down2selectField")})},changed4setBorderWidth:function(l111II11II){var I1III111Il=this,I1II1I1I11=I1III111Il.data.currentControl,I1I1I1111l=l1lll111lI(l111II11II.el).attr("bindprop"),l11I1111Il=I1I1I1111l.replace("._borderWidth","").replace("tempControl.",""),l1III1I111=oui.JsonPathUtil.getJsonByPath(I1I1I1111l,I1III111Il.data)||0,I1III11II1=oui.JsonPathUtil.getJsonByPath(l11I1111Il,I1II1I1I11);l1III1I111?(I1III11II1.borderLeftWidth&&(I1III11II1.borderLeftWidth=l1III1I111),I1III11II1.borderTopWidth&&(I1III11II1.borderTopWidth=l1III1I111),I1III11II1.borderRightWidth&&(I1III11II1.borderRightWidth=l1III1I111),I1III11II1.borderBottomWidth&&(I1III11II1.borderBottomWidth=l1III1I111)):(I1III11II1.borderLeftWidth&&(I1III11II1.borderLeftWidth=1),I1III11II1.borderTopWidth&&(I1III11II1.borderTopWidth=1),I1III11II1.borderRightWidth&&(I1III11II1.borderRightWidth=1),I1III11II1.borderBottomWidth&&(I1III11II1.borderBottomWidth=1)),I1II1I1I11.id&&I1III111Il.updateControlRect4Border(I1II1I1I11),"init,down2selectPage".split(",").indexOf(I1III111Il.state)>-1?I1III111Il.changed4propsRealTime(l111II11II,function(){try{I1III111Il.changeAllControls(l11I1111Il+".borderLeftWidth",I1III11II1.borderLeftWidth),I1III111Il.changeAllControls(l11I1111Il+".borderTopWidth",I1III11II1.borderTopWidth),I1III111Il.changeAllControls(l11I1111Il+".borderRightWidth",I1III11II1.borderRightWidth),I1III111Il.changeAllControls(l11I1111Il+".borderBottomWidth",I1III11II1.borderBottomWidth),I1III111Il.renderCenterAll()}catch(I111ll11I1){}}):I1III111Il.changed4propsRealTime(l111II11II,function(){})},changed4setBorders:function(I111II11Il){var l1lll11111=this,l1II1I1II1=l1lll11111.data.currentControl,I1I1I111l1=l1lll111lI(I111II11Il.el).attr("bindprop"),l11I1111I1=I1I1I111l1.replace("tempControl.","").replace("._borders",""),I1III1I1I1=I1I1I111l1.replace("._borders","._borderWidth"),I1III11Il1=oui.JsonPathUtil.getJsonByPath(l11I1111I1,l1II1I1II1)||{},l111111ll1=oui.JsonPathUtil.getJsonByPath(I1I1I111l1,l1lll11111.data)||"";"none"==l111111ll1&&(l111111ll1="");var l1l1llll1I={borderLeftWidth:I1III11Il1.borderLeftWidth,borderTopWidth:I1III11Il1.borderTopWidth,borderRightWidth:I1III11Il1.borderRightWidth,borderBottomWidth:I1III11Il1.borderBottomWidth};if(I1III11Il1.borderLeftWidth=0,I1III11Il1.borderTopWidth=0,I1III11Il1.borderRightWidth=0,I1III11Il1.borderBottomWidth=0,l111111ll1&&l111111ll1.length)for(var I11ll1llIl=0,l11l11llIl=(l111111ll1=l111111ll1.split(",")).length;I11ll1llIl<l11l11llIl;I11ll1llIl++){var l11IIIIII1=l111111ll1[I11ll1llIl];I1III11Il1[l11IIIIII1]=l1l1llll1I[l11IIIIII1]||l1lll11111.findBorderWidth(l1II1I1II1,I1I1I111l1)||1}else oui.JsonPathUtil.setObjByPath(I1III1I1I1,l1lll11111.data,1,!0);if(l1II1I1II1.id&&l1lll11111.updateControlRect4Border(l1II1I1II1),l1lll11111.changed4props(I111II11Il),"init,down2selectPage".split(",").indexOf(l1lll11111.state)>-1){if(I1I1I111l1.indexOf("tempControl")>=0)try{l1lll11111.changeAllControls(l11I1111I1+".borderLeftWidth",I1III11Il1.borderLeftWidth),l1lll11111.changeAllControls(l11I1111I1+".borderTopWidth",I1III11Il1.borderTopWidth),l1lll11111.changeAllControls(l11I1111I1+".borderRightWidth",I1III11Il1.borderRightWidth),l1lll11111.changeAllControls(l11I1111I1+".borderBottomWidth",I1III11Il1.borderBottomWidth),l1lll11111.renderCenterAll(),l1lll11111.setCurrPropsData4page("props","down2selectPage")}catch(I111II11I1){}}else l1lll11111.setCurrPropsData(l1II1I1II1,"center","down2selectField")},findSelectBox:function(){var l111ll11Il=this.data.controls||[];return oui.findOneFromArrayBy(l111ll11Il,function(I111II1111){if(I111II1111.htmlType==l1II1I1I1l.selectArea.name)return!0})},hasSelectBox:function(){var I111II11ll=!1;return this.findSelectBox()&&(I111II11ll=!0),I111II11ll},isSelectBox:function(I111ll11I1){var l1III111lI=!1;return I111ll11I1&&I111ll11I1.htmlType==l1II1I1I1l.selectArea.name&&(l1III111lI=!0),l1III111lI},removeSelectBox:function(){var I111II11ll=this.data.controls||[],I1III111l1=l1lll111lI(".ppt-paper-area");oui.removeFromArrayBy(I111II11ll||[],function(l111ll11I1){if(l111ll11I1.htmlType==l1II1I1I1l.selectArea.name)return I1III111l1.find("#"+l111ll11I1.id+",#"+l111ll11I1.id+"_box").remove(),!0})},hasBorder:function(l111ll11II,I1III1111l){var l1ll1l1llI=this,I1I1I111Il=!0;return l111ll11II&&l111ll11II.style?"number"==typeof(I1I1I111Il=l1ll1l1llI.hasBorderLeft(l111ll11II,I1III1111l)||l1ll1l1llI.hasBorderTop(l111ll11II,I1III1111l)||l1ll1l1llI.hasBorderRight(l111ll11II,I1III1111l)||l1ll1l1llI.hasBorderBottom(l111ll11II,I1III1111l))&&(I1I1I111Il=0!=I1I1I111Il):I1I1I111Il=!1,I1I1I111Il},hasBorderByProp:function(I111II111I,I1III111Il,l1ll1l1ll1){var I1I1I111II=this,I11l11111l=I1III111Il.replace("._borders","").replace("tempControl.",""),I1lll1l1I1=I1III111Il.replace("._borders","._borderWidth"),l1lll11llI=I111II111I&&oui.JsonPathUtil.getJsonByPath(I11l11111l,I111II111I),l111111II1=I111II111I&&l1lll11llI&&l1lll11llI[l1ll1l1ll1];return!l111111II1&&(oui.JsonPathUtil.getJsonByPath(I1III111Il,I1I1I111II.data)||"").indexOf(l1ll1l1ll1)>=0?l111111II1||oui.JsonPathUtil.getJsonByPath(I1lll1l1I1,I1I1I111II.data)||1:l111111II1},hasBorderLeft:function(I111ll11Il,I1lll111l1){return this.hasBorderByProp(I111ll11Il,I1lll111l1,"borderLeftWidth")},hasBorderTop:function(I111II111l,I1III111lI){return this.hasBorderByProp(I111II111l,I1III111lI,"borderTopWidth")},hasBorderRight:function(I111II11ll,I1III111lI){return this.hasBorderByProp(I111II11ll,I1III111lI,"borderRightWidth")},hasBorderBottom:function(I111II11I1,l1III111lI){return this.hasBorderByProp(I111II11I1,l1III111lI,"borderBottomWidth")},event2editTable:function(I111II111l){var I1III111I1=this;I111II111l.e&&I111II111l.e.target.releaseCapture&&I111II111l.e.target.releaseCapture();var l1ll1l1llI=l1lll111lI(I111II111l.el).closest(".control-pabs-component"),l1I1I111l1=l1ll1l1llI.attr("id");if(l1I1I111l1){var I11l111111=I1III111I1.getControlById(l1I1I111l1);I11l111111.style.isDragging4SelectArea?I11l111111.style.isDragging4SelectArea=!1:I11l111111.style.isDragging4SelectArea=!0,l1lll111lI(".active",".ppt-paper-area").removeClass("active"),l1ll1l1llI.addClass("active"),I11l111111.style.isDragging4SelectArea?(l1ll1l1llI.addClass("drag-select-area"),l1lll111lI(I111II111l.el).attr("title","编辑中"),I1III111I1.selectRect=null,I1III111I1.showOperationArea(I11l111111)):(l1ll1l1llI.removeClass("drag-select-area"),l1lll111lI(I111II111l.el).attr("title","编辑完成"),I1III111I1.hideOperationArea())}},findPageBgImg:function(){var I111ll1111=this;return I111ll1111.data&&I111ll1111.data.backgroundImage?"background-image:url("+I111ll1111.data.backgroundImage+")":""},findPageBgImgTpl:function(){return"{{if pageData.getDesigner()&&pageData.getDesigner().backgroundImage}}background-image:url({{=pageData.getDesigner().backgroundImage}}){{/if}}"},findFieldHtml:function(l111II1111,I1lll111ll){var l1II1I1Il1=this;return l111II1111?l1II1I1Il1.plugin.PageDesignControlAdapter.render(l111II1111,I1lll111ll)||"":""},event2removePaperBgImg:function(l111ll11Il){var I1lll11111=this;I1lll11111.data.backgroundImageId;I1lll11111.data.backgroundImageId="",I1lll11111.data.backgroundImageName="",I1lll11111.data.backgroundImage="",I1lll11111.renderPaperStyle(),(oui.browser.ie||oui.browser.isEdge)&&l1lll111lI(l111ll11Il.el).parent().find("input").val("")},event2cloneControl:function(I111ll111I){var I1lll11111=this;I111ll111I.e&&I111ll111I.e.target.releaseCapture&&I111ll111I.e.target.releaseCapture();var l1II1I1I11=l1lll111lI(I111ll111I.el).closest(".control-pabs-component").attr(I1lll11111.controlDomAttrPrefix+"id"),l1I1I111l1=I1lll11111.getControlById(l1II1I1I11);if(l1I1I111l1){var l11I1111I1=oui.parseJson(oui.parseString(l1I1I111l1));l11I1111I1.id=I1lll11111.newId(),l11I1111I1.bizId=I1lll11111.newId(),l11I1111I1.parentId="",l11I1111I1.detailId="";var I1lll1l1II=!0;l1lll111lI(I111ll111I.el).hasClass("design-copy-ctrl-right")?(l11I1111I1.style.left+=l11I1111I1.style.width,l11I1111I1.style.left-=l11I1111I1.style.borderLeftWidth):(l11I1111I1.style.top+=l11I1111I1.style.height,l11I1111I1.style.top-=l11I1111I1.style.borderTopWidth,I1lll1l1II=!1),I1lll11111.data.style.currControlZIndex++,l11I1111I1.style.zIndex=I1lll11111.data.style.currControlZIndex;var l1lll11lI1=[];if("tableLine"==l11I1111I1.htmlType){I1lll11111.selectRect=null;var l111111Ill=l11I1111I1.style.cellsMap||{};for(var l1l1llllll in l111111Ill){var l11II1IIII=l111111Ill[l1l1llllll];if(l11II1IIII&&l11II1IIII.controlId&&l11II1IIII.tableLineId){var I11l11ll1l=I1lll11111.getControlById(l11II1IIII.controlId);if(I11l11ll1l){var l11lllllIl=oui.parseJson(oui.parseString(I11l11ll1l));l11lllllIl.id=I1lll11111.newId(),l11lllllIl.bizId=I1lll11111.newId(),I1lll11111.data.controls.push(l11lllllIl),l11II1IIII.controlId=l11lllllIl.id,l11II1IIII.tableLineId=l11I1111I1.id,l11lllllIl.parentId=l11I1111I1.id,l11lllllIl.detailId&&(l11lllllIl.detailId=l11I1111I1.bizId),I1lll1l1II?(l11II1IIII.left+=l11I1111I1.style.width,l11II1IIII.left-=l11I1111I1.style.borderLeftWidth,l11II1IIII.right+=l11I1111I1.style.width,l11II1IIII.right-=l11I1111I1.style.borderLeftWidth):(l11II1IIII.top+=l11I1111I1.style.height,l11II1IIII.top-=l11I1111I1.style.borderTopWidth,l11II1IIII.bottom+=l11I1111I1.style.height,l11II1IIII.bottom-=l11I1111I1.style.borderTopWidth),I1lll11111.setRectInTableLineByColumnAndRow(l11I1111I1,l11II1IIII),l11lllllIl.style.rect=l11II1IIII,l11lllllIl.style.left=l11II1IIII.left,l11lllllIl.style.top=l11II1IIII.top,I1lll11111.data.style.currControlZIndex++,l11lllllIl.style.zIndex=I1lll11111.data.style.currControlZIndex;var I11I1IIIlI=oui.getById("items").getHtmlByTplId("item-tpl",{item:l11lllllIl});l1lll11lI1.push(I11I1IIIlI)}else I1lll11111.removeRectInTableLineByColumnAndRow(l11I1111I1,l11II1IIII.columnIndex,l11II1IIII.rowIndex)}}I1lll11111.refreshTableLineMergeCells(l11I1111I1)}else l11I1111I1&&l11I1111I1.style&&l11I1111I1.style.rect&&(l11I1111I1.style.left=parseInt(l11I1111I1.style.left),l11I1111I1.style.top=parseInt(l11I1111I1.style.top),l11I1111I1.style.width=parseInt(l11I1111I1.style.width),l11I1111I1.style.height=parseInt(l11I1111I1.style.height),l11I1111I1.style.rect=null,delete l11I1111I1.style.rect);var l1111IIIIl=-1;l1I1I111l1.parentId?oui.findOneFromArrayBy(I1lll11111.data.controls||[],function(I111II111l,l1III111II){if(I111II111l.id==l1I1I111l1.parentId)return l1111IIIIl=l1III111II,!0}):oui.findOneFromArrayBy(I1lll11111.data.controls||[],function(l111II11Il,I1lll1111I){if(l111II11Il.id==l1II1I1I11)return l1111IIIIl=I1lll1111I,!0}),I1lll11111.data.controls.splice(l1111IIIIl+1,0,l11I1111I1),I1lll11111.addTableLineControl(l11I1111I1);var l1II1I111l=oui.getById("items").getHtmlByTplId("item-tpl",{item:l11I1111I1}),l111llllI1=oui.getById("items").getEl();l1lll111lI(l111llllI1).find(".ppt-paper-area").append(l1II1I111l+l1lll11lI1.join("")),l1lll111lI(".active",".ppt-paper-area").removeClass("active"),l1lll111lI("#"+l11I1111I1.id).addClass("active"),I1lll11111.updateControlsByPageDesignType(l11I1111I1),"detail"==l11I1111I1.controlType?I1lll11111.renderCenterAll():oui.parse(),I1lll11111.showOperationArea(l11I1111I1),I1lll11111.setCurrPropsData(l11I1111I1,"center","cloneField")}},event2removeControl:function(I111ll111I){var l1III1111I=this,l1II1I1I11=l1lll111lI(I111ll111I.el).closest(".control-pabs-component").attr(l1III1111I.controlDomAttrPrefix+"id"),l1l1l11111=l1III1111I.getControlById(l1II1I1I11),I11I11111l=[];l1l1l11111&&I11I11111l.push(".control-pabs-disable[control-pabs-id="+l1l1l11111.id+"]");var l1lll1l1Il=l1lll111lI(".design-right :focus");l1lll1l1Il&&l1lll1l1Il.length&&l1lll1l1Il.blur(),setTimeout(function(){l1III1111I.removeControlById(l1II1I1I11),l1lll111lI("#"+l1II1I1I11,".ppt-paper-area").remove(),I11I11111l.length&&l1lll111lI(I11I11111l.join(","),".design-left").removeClass("control-pabs-disable"),l1III1111I.updateControlsByPageDesignType(),l1III1111I.hideOperationArea(),l1III1111I.renderCenterAll(),l1III1111I.setCurrPropsData4page()},50)},renderCenterAll:function(){var l111II11Il=this;l111II11Il.clearControlRefs(),oui.clearByContainer("#control_items"),oui.clear4notUse(),oui.getById("items").render(),oui.parse(),l111II11Il.$operation=null},setCurrPropsData4page:function(I111II11lI,l1lll111ll){var I1II1I1II1=this;I1II1I1II1.isRenderAll="props"==I111II11lI,I1II1I1II1._globalPageData||(I1II1I1II1._globalPageData={style:I1II1I1II1.data.innerStyle.style,innerStyle:{styleInnerOuter:I1II1I1II1.data.innerStyle.styleInnerOuter,styleTitle:I1II1I1II1.data.innerStyle.styleTitle,styleFieldOuter:I1II1I1II1.data.innerStyle.styleFieldOuter,styleField:I1II1I1II1.data.innerStyle.styleField}}),I1II1I1II1.setCurrPropsData(I1II1I1II1._globalPageData,I111II11lI||"center",l1lll111ll||"down2selectPage")},getCurrentBizConfig:function(){var I111ll1111=this,I1lll111ll=I111ll1111.data.currentControl||{};return this.currentBizConfig||(this.currentBizConfig={}),this.currentBizConfig.id=I1lll111ll.id,this.currentBizConfig.designFullName=I111ll1111.FullName,this.currentBizConfig},getPageBizConfig:function(){var I111ll11ll=this;return this.pageBizConfig||(this.pageBizConfig={}),this.pageBizConfig.designFullName=I111ll11ll.FullName,this.pageBizConfig},event2showCutImg:function(l111ll11ll){var l1III111Il=this,I1ll1l1ll1=l1lll111lI(".design-middle");oui.uploadURL=oui.uploadURL||l1III111Il.paramCfg.uploadUrl||oui.getTop().oui.uploadURL;var l1I1I1111l=l1lll111lI(l111ll11ll.el).attr("changeProp");oui.showCutImg({cropBoxResizable:!0,boxWidth:500,boxHeight:300,showPreview:!0,panelStyle:"width:"+I1ll1l1ll1.width()+"px;height:"+I1ll1l1ll1.height()+"px",confirm:function(I111ll1111,I1III11111,l1II1I1III){oui.uploadBase64(I111ll1111,function(I111II11ll){var l1lll111Il=I111II11ll.imgId,I1ll1l1l1I=l1II1I1III.attr("file").name,l1I1I111Il=I111II11ll.previewUrl;l1I1I1111l?(oui.JsonPathUtil.setObjByPath(l1I1I1111l+"Id",l1III111Il.data,l1lll111Il,!0),oui.JsonPathUtil.setObjByPath(l1I1I1111l+"Name",l1III111Il.data,I1ll1l1l1I,!0),oui.JsonPathUtil.setObjByPath(l1I1I1111l,l1III111Il.data,l1I1I111Il,!0),l1III111Il.changed4props({},function(){l1III111Il.setCurrPropsData(l1III111Il.data.currentControl,"center","down2selectField")})):(l1III111Il.data.backgroundImageId=l1lll111Il,l1III111Il.data.backgroundImageName=I1ll1l1l1I,l1III111Il.data.backgroundImage=l1I1I111Il,l1III111Il.renderPaperStyle())},l1II1I1III.attr("file").name)},cancel:function(){}})},event2selectBoxArea:function(I111ll111l){var I1III111lI=this;if(I1III111lI.hideOperationArea(),I1III111lI.hasSelectBox())I1III111lI.removeSelectBox(),l1lll111lI(I111ll111l.el).text("选取区域"),I1III111lI.setCurrPropsData4page();else{var I1II1I1I1I=l1lll111lI(".design-middle"),I1l1l111lI=l1lll111lI(".ppt-paper-area"),I11I1111l1=I1III111lI.newId(),l1lll1l1I1={};l1lll1l1I1.id=I11I1111l1,l1lll1l1I1.name="",l1lll1l1I1.htmlType=l1II1I1I1l.selectArea.name,l1lll1l1I1.controlType=l1II1I1I1l.selectArea.name,l1lll1l1I1.style={borderLeftWidth:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,opacity:1,borderLeftColor:"#e6e6e6",borderTopColor:"#e6e6e6",borderRightColor:"#e6e6e6",borderBottomColor:"#e6e6e6",borderLeftStyle:"solid",borderTopStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid"},l1lll1l1I1.style.width=360,l1lll1l1I1.style.height=270;var I1lll11lll=I1III111lI.data.style.width/I1l1l111lI.width()*l1lll1l1I1.style.width,I111111IlI=I1III111lI.data.style.height/I1l1l111lI.height()*l1lll1l1I1.style.height;l1lll1l1I1.style.width4mm=I1lll11lll,l1lll1l1I1.style.height4mm=I111111IlI;var I1l1llll1l=I1II1I1I1I[0].scrollLeft+(I1II1I1I1I.width()-l1lll1l1I1.style.width)/2-I1l1l111lI[0].offsetLeft,l11ll1ll1l=I1II1I1I1I[0].scrollTop+(I1II1I1I1I.height()-l1lll1l1I1.style.height)/2-I1l1l111lI[0].offsetTop;I1l1llll1l=parseInt(I1l1llll1l),l11ll1ll1l=parseInt(l11ll1ll1l),I1l1llll1l<0&&(I1l1llll1l=0),l11ll1ll1l<0&&(l11ll1ll1l=0),l1lll1l1I1.style.left=I1l1llll1l,l1lll1l1I1.style.top=l11ll1ll1l,I1III111lI.data.controls.push(l1lll1l1I1);var I11l11ll1I=oui.getById("items").getHtmlByTplId("item-tpl",{item:l1lll1l1I1}),l11IIIIIl1=oui.getById("items").getEl();l1lll111lI(l11IIIIIl1).find(".ppt-paper-area").append(I11l11ll1I),l1lll111lI(".active",".ppt-paper-area").removeClass("active"),l1lll111lI("#"+l1lll1l1I1.id).addClass("active"),l1lll111lI(I111ll111l.el).text("取消选取"),I1III111lI.showOperationArea(l1lll1l1I1),I1III111lI.setCurrPropsData(l1lll1l1I1,"center","down2selectField")}},event2preview:function(){var I111ll11II=this,I1lll111II=oui.getContextPath()+"res_engine/ppt_design/pc/ppt-runtime.html";I1lll111II=oui.addParams(I1lll111II,{contextPath:oui.getContextPath()});var I1II1I1I1l=oui.openWindow({url:I1lll111II,title:"预览"});oui.browser.ie||oui.browser.isEdge?window.designDataJson=oui.parseString(I111ll11II.getDesignData()):I1II1I1I1l.designDataJson=oui.parseString(I111ll11II.getDesignData())},event2runForm:function(){var I111II1111=this,l1lll111Il="";l1lll111Il=I111II1111.hasSelectBox()?I111II1111.findSelectAreaHtml():oui.getById("items").getEl().innerHTML,oui.openWindow({url:oui.getContextPath()+"res_engine/ppt_design/pc/ppt-preview.html",title:"预览"}).bodyHtml=l1lll111Il},checkSaved:function(I111II1111,l1III111II,l1ll1l1lII){return this.hasChange?(oui.getTop().oui.confirmDialog(l1ll1l1lII||"当前页面没保存",function(){I111II1111&&I111II1111()},function(){l1III111II&&l1III111II()}),!1):(I111II1111&&I111II1111(),!0)},event2loadFile:function(I111II11ll){var I1III111ll=this,l1II1I1I1I=I111II11ll.el.files;if(l1II1I1I1I&&l1II1I1I1I.length){var l1l1l111lI=l1II1I1I1I[0];if(I1III111ll.hasChange)return void oui.getTop().oui.alert("当前页面没保存，请导出备份后再导入");var I11l1111I1=new FileReader;I11l1111I1.readAsText(l1l1l111lI),I11l1111I1.onload=function(){var l111II11l1=I11l1111I1.result;l1lll111lI("#import-file").val("");var I1lll1111I=null;try{I1lll1111I=oui.parseJson(l111II11l1)}catch(l111II11I1){I1lll1111I={}}if(I1lll1111I.id){var l1ll1l1ll1=I1lll1111I;window.localStorage[l1ll1l1ll1.id]=oui.parseString(l1ll1l1ll1);var l1l1l111II={exp:new Date-1+2592e6};window.localStorage[l1ll1l1ll1.id+"_version"]=oui.parseString(l1l1l111II);var I11l1111lI=location.href;I11l1111lI=oui.setParam(I11l1111lI,"successTips","true"),I11l1111lI=oui.setParam(I11l1111lI,"message","导入成功"),I11l1111lI=oui.setParam(I11l1111lI,"id",l1ll1l1ll1.id),oui.go(I11l1111lI)}else oui.getTop().oui.alert("导入失败")}}},event2new:function(){this.checkSaved(function(){var l111II111l=location.href;l111II111l=oui.setParam(l111II111l,"successTips",""),l111II111l=oui.setParam(l111II111l,"message",""),l111II111l=oui.setParam(l111II111l,"id",""),oui.go(l111II111l)},function(){})},event2import:function(){l1lll111lI("#import-file").click()},event2export:function(){var l111II11Il=this.getDesignData();if(l111II11Il.id){var I1lll111I1=new Blob([oui.parseString(l111II11Il)],{type:"text/plain;charset=utf-8"});saveAs(I1lll111I1,l111II11Il.name+".json")}else oui.getTop().oui.alert("当前页面没有保存")},event2triggerPaperDown:function(I111II1111){l1lll111lI(".ppt-paper-area").trigger("mousedown")},down2selectPaperArea:function(l111II11l1){var l1III111I1=this;if(l1lll111lI(l111II11l1.e.target).is(".ppt-paper-area")){if(l1III111I1.currAccordingActiveId="",l1lll111lI(".active",".ppt-paper-area").removeClass("active"),l1lll111lI(l111II11l1.el).addClass("active"),l1III111I1.data.currentControl&&"tableLine"==l1III111I1.data.currentControl.htmlType&&l1III111I1.data.currentControl.style.isDragging4SelectArea){l1III111I1.data.currentControl.style.isDragging4SelectArea=!1;var l1ll1l1llI=l1lll111lI("#"+l1III111I1.data.currentControl.id,".ppt-paper-area");l1ll1l1llI.removeClass("drag-select-area"),l1ll1l1llI.find(".tableLine-edit-icon").attr("title","编辑完成"),l1III111I1.hideOperationArea()}l1III111I1.hideOperationArea(),l1III111I1.setCurrPropsData4page()}},findItems:function(){return this.data.controls||[]},findItems4list:function(){var l111II11lI=this;return oui.findManyFromArrayBy(l111II11lI.data.controls||[],function(l111ll11ll){if((l111ll11ll.formField||l111ll11ll.isFormField)&&!l111ll11ll.detailId)return!0})},findSelectAreaItems:function(){var l111ll11lI=this,I1III111Il=[];if(!l111ll11lI.hasSelectBox())return I1III111Il;for(var I1II1I1Ill=l111ll11lI.findSelectBox(),l1l1l111II=I1II1I1Ill.style.left+I1II1I1Ill.style.borderLeftWidth,l11I1111II=I1II1I1Ill.style.top+I1II1I1Ill.style.borderTopWidth,I1lll1l1Il=I1II1I1Ill.style.left+I1II1I1Ill.style.width+I1II1I1Ill.style.borderRightWidth,I1lll11l1I=I1II1I1Ill.style.top+I1II1I1Ill.style.height+I1II1I1Ill.style.borderBottomWidth,l111111l11=l111ll11lI.findItems(),I1l1lllllI=0,l11ll1ll11=l111111l11.length;I1l1lllllI<l11ll1ll11;I1l1lllllI++){var I11l11ll1l=l111111l11[I1l1lllllI];if(I11l11ll1l==I1II1I1Ill)(l111IIIII1=l1lll111lI.extend(!0,{},I11l11ll1l)).style.left-=l1l1l111II,l111IIIII1.style.top-=l11I1111II,I1III111Il.push(l111IIIII1);else{var I11llllllI=I11l11ll1l.style.left,l11I1IIIII=I11l11ll1l.style.top,I1111IIIll=I11l11ll1l.style.left+I11l11ll1l.style.width,I1ll1l11lI=I11l11ll1l.style.top+I11l11ll1l.style.height;if(I1111IIIll>l1l1l111II&&I1ll1l11lI>l11I1111II&&I11llllllI<I1lll1l1Il&&I1ll1l11lI>l11I1111II&&l11I1IIIII<I1lll11l1I){var l111IIIII1=l1lll111lI.extend(!0,{},I11l11ll1l);l111IIIII1.style.left-=l1l1l111II,l111IIIII1.style.top-=l11I1111II,I1III111Il.push(l111IIIII1)}}}return I1III111Il},findSelectAreaHtml:function(I111ll11l1){var l1lll111Il=this;return l1lll111Il.hasSelectBox()?(l1lll111Il._renderSelectAreaHtml||(l1lll111Il._renderSelectAreaHtml=template.compile(document.getElementById("items-select-tpl").innerHTML)),l1lll111Il._renderSelectAreaHtml({render4tpl:I111ll11l1})):""},findContentAreaHtml:function(l111ll111l){var l1III111Il=this;return l1III111Il._renderContentAreaHtml||(l1III111Il._renderContentAreaHtml=template.compile(document.getElementById("items-content-tpl").innerHTML)),l1III111Il._renderContentAreaHtml({render4tpl:l111ll111l})},getDesignData:function(){for(var l111II11Il={},l1lll111Il=this,l1II1I1I1I=l1lll111Il.pageKeys,l1I1I111I1=0,l11I1111II=l1II1I1I1I.length;l1I1I111I1<l11I1111II;l1I1I111I1++){var I1III1I1ll=l1II1I1I1I[l1I1I111I1];l111II11Il[I1III1I1ll]=l1lll111Il.data[I1III1I1ll]}return l111II11Il.content=l1lll111Il.findContentAreaHtml(!0),l111II11Il.selectContent=l1lll111Il.findSelectAreaHtml(!0),l111II11Il.listContent=l1lll111Il.findContent4list(!0),l111II11Il},findContent4list:function(I111ll111I){var I1lll111l1=this.plugin.PageDesignControlAdapter.renderPageList(I111ll111I);return I1lll111l1=l1lll111lI.trim(I1lll111l1)},event2save:function(){var l111ll111l=this,l1III111l1=l111ll111l.getDesignData();l111ll111l.paramCfg.page=l1III111l1,l111ll111l.updateParamCfgSource(l111ll111l.paramCfg);l111ll111l.plugin;l111ll111l.hasChange=!1,oui.getParam().pptId&&oui.postData(l111ll111l.updateProjectPortalUrl,{projectPortal:l1III111l1},function(I111ll11l1){oui.go4replace(location.href)},function(I111II11l1){},"保存中...")},savePageDesign:function(l111II11lI){var I1III111I1=this,I1II1I1I11=I1III111I1.getDesignData();I1III111I1.paramCfg.page=I1II1I1I11;oui.getParam();I1III111I1.updateParamCfgSource(I1III111I1.paramCfg),I1III111I1.hasChange=!1;var l1I1I1111I=oui.findOneFromArrayBy(I1III111I1.pageList||[],function(I111ll1111){if(I111ll1111.PageId==I1III111I1.pageId)return!0});l1I1I1111I.PageImgUrl&&l1I1I1111I.PageImgUrl.startsWith("data:image")?oui.ajaxPost(oui.pptAjaxConfig.updatePageImgUrl,{PageId:I1III111I1.pageId,TranslateId:I1III111I1.pptId,PageImgUrl:l1I1I1111I.PageImgUrl},function(I111ll111l){l1I1I1111I.PageImgUrl=I111ll111l.PageImgUrl,oui.ajaxPost(oui.pptAjaxConfig.savePageUrl,{PageId:I1III111I1.pageId,TranslateId:I1III111I1.pptId,PageName:l1I1I1111I.PageName,TemplateId:l1I1I1111I.TemplateId||"",PageImgUrl:I111ll111l.PageImgUrl||"",PageData:oui.parseString(I1II1I1I11)},function(l111ll111l){l111II11lI&&l111II11lI(l111ll111l,I1II1I1I11)})},function(I111ll111l){console.log("base64图片保存失败")}):oui.ajaxPost(oui.pptAjaxConfig.savePageUrl,{PageId:I1III111I1.pageId,TranslateId:I1III111I1.pptId,PageName:l1I1I1111I.PageName,TemplateId:l1I1I1111I.TemplateId||"",PageImgUrl:l1I1I1111I.PageImgUrl||"",PageData:oui.parseString(I1II1I1I11)},function(l111ll11lI){l111II11lI&&l111II11lI(l111ll11lI,I1II1I1I11)})},dataURItoBlob:function(I111ll11II){for(var I1III11111=window.atob(I111ll11II.split(",")[1]),l1ll1l1lI1=I111ll11II.split(",")[0].split(":")[1].split(";")[0],I1I1I111l1=new ArrayBuffer(I1III11111.length),l11I111111=new Uint8Array(I1I1I111l1),l1III1I11I=0;l1III1I11I<I1III11111.length;l1III1I11I++)l11I111111[l1III1I11I]=I1III11111.charCodeAt(l1III1I11I);return new Blob([I1I1I111l1],{type:l1ll1l1lI1})},printFormData:function(){var I111ll11lI=this,l1lll111l1=oui.getParam("dataIds"),I1II1I1I1I=oui.getParam("formId"),l1I1I1111I=oui.getContextPath()+"form/bizFormData.do?method=index4print";l1I1I1111I=oui.setParam(l1I1I1111I,"formId",I1II1I1I1I),l1I1I1111I=oui.setParam(l1I1I1111I,"dataIds",l1lll111l1);var I11I1111ll="",I1III1I1II=I111ll11lI.getDesignData(),I11I1111ll=I1III1I1II.selectContent||I1III1I1II.content;oui.postData(l1I1I1111I,{formId:I1II1I1I1I,dataIds:l1lll111l1,template:I11I1111ll},function(I111ll11I1){if(I111ll11I1.success){var I1III11111=oui.parseJson(I111ll11I1.msg).html;l111ll11lI.oui_url||(l111ll11lI.oui_url={print_preview:oui.getContextPath()+"common.do?method=print"});var l1II1I1I1I='<link href="'+oui.getContextPath()+'res_engine/ppt_design/pc/css/ppt-common.css" type="text/css" rel="stylesheet"/>';l1II1I1I1I+='<style type="text/css"> .ppt-paper-area {overflow:hidden;} .control-pabs{position:absolute;}</style>',l1II1I1I1I+=I1III11111,l1lll111lI.printContentInIFrame(l1II1I1I1I,{globalStyles:!0,mediaPrint:!1,stylesheet:null,noPrintSelector:".no-print",iframe:!0,append:null,prepend:null,manuallyCopyFormValues:!0,deferred:l1lll111lI.Deferred(),timeout:750,title:null,doctype:"<!doctype html>"})}else oui.getTop().oui.alert("数据转换成html失败")},function(l111ll11l1){oui.getTop().oui.alert("由于网络问题，打印模板提交失败")},"打印页面生成中...")},findCallbackByName:function(I111ll1111){var I1lll1111l=this,l1ll1l1ll1=(I1lll1111l.paramCfg.callbackMethods||{})[I111ll1111+"CallbackMethod"]||"",l1l1l111Il=I1lll1111l.plugin||{};return l1ll1l1ll1&&(l1ll1l1ll1=l1ll1l1ll1.indexOf(".")>-1?oui.JsonPathUtil.getJsonByPath(l1ll1l1ll1,window):l1l1l111Il[l1ll1l1ll1]),l1ll1l1ll1},event2print:function(I111ll11ll){var I1III111lI=this,l1II1I1II1=I1III111lI.getDesignData(),l1I1I111l1=I1III111lI.findCallbackByName("print"),l11l1111II=I1III111lI.plugin||{};if(l1I1I111l1){for(var I1III1I1II={},l1lll11lI1=l1II1I1II1.controls||[],l111111l1l=0,I1l1llll1I=l1lll11lI1.length;l111111l1l<I1l1llll1I;l111111l1l++)l1lll11lI1[l111111l1l].controlType&&(I1III1I1II[l1lll11lI1[l111111l1l].id]=l1lll11lI1[l111111l1l].otherAttrs||{});l1I1I111l1.call(l11l1111II,l1II1I1II1.otherAttrs||{},I1III1I1II,l1II1I1II1)}},event2printBatch:function(I111II111I){var l1ll1l1llI=this;l111ll11lI.oui_url||(l111ll11lI.oui_url={print_preview:oui.getContextPath()+"common.do?method=print"});var l1l1l1111I='<link href="'+oui.getContextPath()+'res_engine/ppt_design/pc/css/ppt-common.css" type="text/css" rel="stylesheet"/>';l1l1l1111I+='<style type="text/css"> .ppt-paper-area {overflow:hidden;} .control-pabs{position:absolute;}</style>';var I11I1111II="";I11I1111II=l1ll1l1llI.hasSelectBox()?l1ll1l1llI.findSelectAreaHtml():oui.getById("items").getEl().innerHTML;var l1lll1l11l="";l1lll1l11l+=l1l1l1111I;for(var I1lll11l11=0;I1lll11l11<5;I1lll11l11++)l1lll1l11l+=I11I1111II;l1lll111lI.printContentInIFrame(l1lll1l11l,{globalStyles:!0,mediaPrint:!1,stylesheet:null,noPrintSelector:".no-print",iframe:!0,append:null,prepend:null,manuallyCopyFormValues:!0,deferred:l1lll111lI.Deferred(),timeout:750,title:null,doctype:"<!doctype html>"})},initEnd:function(){this.inited=!0;var I111II111I=this;I111II111I.hasSelectBox()&&l1lll111lI("#btn-select-box").text("取消选取"),I111II111I.renderPaperStyle(),setTimeout(function(){I111II111I.setCurrPropsData4page("center","init");var l111ll1111=l1lll111lI(".ppt-paper-area"),I1III111I1=l111ll1111.width(),I1ll1l1l11=l111ll1111.height();I111II111I.data.style.width4px=I1III111I1,I111II111I.data.style.height4px=I1ll1l1l11,oui.require([oui.getContextPath()+"res_common/third/watch/watch.js"],function(){WatchJS.watch(I111II111I,"data",function(I111II11lI,I1lll1111l,I1ll1l1l1l,I1l1l111II){if(I111II111I.updateTimer)try{clearTimeout(I111II111I.updateTimer)}catch(I111ll11Il){}I111II111I.updateTimer=setTimeout(function(){try{I111II111I.update4watch&&I111II111I.update4watch(),I111II111I.updateTimer=null}catch(I111ll111l){}},1)})})},30)},getWidthPercent:function(l111ll111l){var l1lll11111=this;if(l1lll11111.data.style.width4px<l111ll111l)return"100%";var I1II1I1IIl=1e4*l111ll111l/l1lll11111.data.style.width4px;return I1II1I1IIl/=100,(I1II1I1IIl=I1II1I1IIl.toFixed(4))+"%"},getSrcAndLink:function(l111ll11I1,l1III111l1){return new Promise(function(l111ll11lI,I1lll111II){var I1II1I1Ill="intMaterialType="+l111ll11I1+"&num="+l1III111l1;top.dialog({id:"DialogFileManager",padding:0,title:"文件管理器",url:oui.getContextPath()+"Views/Dialog/DialogFileManager.aspx?"+I1II1I1Ill,onclose:function(){l111ll11lI(this.returnValue)}}).showModal()})},showFileDialog4local:function(l111II11l1){var l1lll1111I="file_local_select",l1II1I1II1=l1lll111lI("#"+l1lll1111I);l1II1I1II1&&l1II1I1II1.length&&l1II1I1II1.remove();var l1I1I11111=this;l1lll111lI("body").append("<input id="+l1lll1111I+' type="file" />'),l1lll111lI("#"+l1lll1111I).on("change",function(I111ll11l1){console.log("file  change",I111ll11l1);var I1III111l1=l1I1I11111.getChangeFiles(I111ll11l1);l111II11l1.callback&&l111II11l1.callback(I1III111l1),setTimeout(function(){l1lll111lI("#"+l1lll1111I).off("change"),l1lll111lI("#"+l1lll1111I).remove()},1e3)}),l1lll111lI("#"+l1lll1111I)[0].click()},getChangeFiles:function(I111II11l1){var l1III111II=I111II11l1.target.files||[],I1II1I1II1=[];return oui.eachArray(l1III111II,function(I111II11I1){I1II1I1II1.push({name:I111II11I1.name,size:I111II11I1.size,percentage:0,uid:"f_"+oui.getUUIDLong(),raw:I111II11I1})}),I1II1I1II1},showFileDialog:function(I111ll11l1){if(I111ll11l1.local)this.showFileDialog4local(I111ll11l1);else{var l1lll111Il=this;oui.require([oui.getContextPath()+"Views/productEdit/public/stylesheets/quill.css",oui.getContextPath()+"Views/productEdit/public/javascripts/quill.js",oui.getContextPath()+"Scripts/artdialog/ui-dialog.css",oui.getContextPath()+"Views/productEdit/public/javascripts/dialog-min.js",oui.getContextPath()+"Scripts/artdialog/dialog-plus-min.js",oui.getContextPath()+"Views/productEdit/public/javascripts/product.js",oui.getContextPath()+"Views/productEdit/public/javascripts/product_main.js",oui.getContextPath()+"Views/productEdit/public/javascripts/product_active.js",oui.getContextPath()+"Views/productEdit/public/javascripts/product_util.js"],function(){l1lll111Il.getSrcAndLink(I111ll11l1.fileType,I111ll11l1.num).then(function(I111II11lI){var I1lll111I1=l1lll111Il.transFiles(I111II11lI,I111ll11l1.fileTypes||[]);return I111ll11l1.callback&&I111ll11l1.callback(I1lll111I1),I111II11lI})})}},getFileTypeEnums:function(){return this._fileTypeEnums||(this._fileTypeEnums={video:{name:"video",value:1,transFile:function(I111ll11ll){return{fileType:this.value,coverImgUrl:I111ll11ll.CoverImgOssPath,url:I111ll11ll.FileOSSPath,resolution:I111ll11ll.Resolution,fileName:I111ll11ll.FileName,fileSize:I111ll11ll.FileSize,fileDuration:I111ll11ll.FileDuration}}},image:{name:"image",value:2,transFile:function(I111ll11Il){return{fileType:this.value,url:I111ll11Il.FileOSSPath,resolution:I111ll11Il.Resolution,fileName:I111ll11Il.FileName,fileSize:I111ll11Il.FileSize}}},music:{name:"music",value:3,transFile:function(I111II11I1){return{fileType:this.value,coverImgUrl:I111II11I1.CoverImgOssPath,url:I111II11I1.FileOSSPath,fileName:I111II11I1.FileName,fileSize:I111II11I1.FileSize,fileDuration:I111II11I1.FileDuration}}},doc:{name:"doc",value:4,transFile:function(I111II111l){var I1lll1111l=[];return I111II111l.FileImgList&&(I1lll1111l=I111II111l.FileImgList.split(",")),{fileType:this.value,coverImgUrl:I111II111l.CoverImgOssPath,url:I111II111l.FileOSSPath,fileName:I111II111l.FileName,fileSize:I111II111l.FileSize,fileImgList:I1lll1111l}}}}),this._fileTypeEnums},findFileTypeEnumByValue:function(l111II1111){var l1III1111I=this.getFileTypeEnums();for(var l1II1I1I1I in l1III1111I)if(l1III1111I[l1II1I1I1I]&&l1III1111I[l1II1I1I1I].value==l111II1111)return l1III1111I[l1II1I1I1I];return null},transFiles:function(l111II111l,l1III111l1){var l1II1I1I1I=this,l1I1I111lI=[];return oui.eachArray(l111II111l,function(l111II111I){var l1lll111lI=oui.parseJson(l111II111I.item),l1II1I1IlI=l1II1I1I1I.findFileTypeEnumByValue(l1lll111lI.MaterialType),I1l1l11111=null;l1II1I1IlI&&l1II1I1IlI.transFile&&(l1III111l1?l1III111l1.indexOf(l1II1I1IlI.name)>-1&&(I1l1l11111=l1II1I1IlI.transFile(l1lll111lI)):I1l1l11111=l1II1I1IlI.transFile(l1lll111lI)),I1l1l11111&&l1I1I111lI.push(I1l1l11111)}),l1I1I111lI}};l1lll11llI=oui.biz.Tool.crateOrUpdateClass(l1lll11llI)}(window,window.$$||window.$),function(l111ll11l1){var I1III111lI={config:{},keys:[],addConfig:function(l111ll11I1,l1lll11111){var l1II1I1IIl=this;if(l111ll11I1&&l111ll11I1.indexOf(",")>0)for(var l1I1I1111l=l111ll11I1.split(","),l11l111111=0,l1lll1l11l=l1I1I1111l.length;l11l111111<l1lll1l11l;l11l111111++)l1II1I1IIl.addConfig(l1I1I1111l[l11l111111],l1lll11111);else this.keys.indexOf(l111ll11I1)<0&&(this.keys.push(l111ll11I1),this.keyString=this.keys.join(",")),this.config[l111ll11I1]={key:l111ll11I1,validate:l1lll11111,check:function(l111II11l1){var I1III111lI=[];if(void 0!==l111II11l1){var l1ll1l1l1I=this.key,I1I1I111lI=oui.validate4message(l111II11l1,this.validate);I1I1I111lI.success||I1III111lI.push({key:l1ll1l1l1I,msg:I1I1I111lI.msg})}return I1III111lI}}},check:function(l111II11Il,I1lll111Il,l1ll1l1lll){l1ll1l1lll||(l1ll1l1lll="");var l1I1I1111I=this,l11I11111l=l1I1I1111I.config,I1lll1l111=[];for(var I1III11Ill in l111II11Il){var I111111I11=l111II11Il[I1III11Ill],l1I1IIIIlI=l1ll1l1lll;l1I1IIIIlI?l1I1IIIIlI+="."+I1III11Ill:l1I1IIIIlI=I1III11Ill;var I11ll1ll1I=l11I11111l[l1I1IIIIlI];if(I11ll1ll1I&&(I1lll1l111=I1lll1l111.concat(I11ll1ll1I.check(I111111I11)),I1lll111Il&&I1lll1l111&&I1lll1l111.length))return I1lll1l111;if(I111111I11&&"object"==typeof I111111I11)if(I111111I11 instanceof Array){if(l1I1I1111I.keyString.indexOf(l1I1IIIIlI+"[*]")<0)continue;for(var I11l11llII=0,l11lllllI1=I111111I11.length;I11l11llII<l11lllllI1;I11l11llII++)if(I1lll1l111=I1lll1l111.concat(l1I1I1111I.check(I111111I11[I11l11llII],I1lll111Il,l1I1IIIIlI+"[*]")),I1lll111Il&&I1lll1l111&&I1lll1l111.length)return I1lll1l111}else{if(I1lll1l111=I1lll1l111.concat(l1I1I1111I.check(I111111I11,I1lll111Il,l1I1IIIIlI)),I1lll111Il&&I1lll1l111&&I1lll1l111.length)return I1lll1l111;if(l1I1I1111I.keyString.indexOf(l1I1IIIIlI+"[*]")<0)continue;for(var l11l1llll1 in I111111I11)if(I1lll1l111=I1lll1l111.concat(l1I1I1111I.check(I111111I11[l11l1llll1],I1lll111Il,l1I1IIIIlI+"[*]")),I1lll111Il&&I1lll1l111&&I1lll1l111.length)return I1lll1l111}}return I1lll1l111},checkControl:function(I111ll111I,l1III111l1){return this.check(I111ll111I,l1III111l1,"controls[*]")},findCheckMessage:function(I111ll11Il,l1III111ll){var l1II1I1Ill=I111ll11Il,I1I1I111II=[],I11l1111l1=this.config[I111ll11Il],l1III1I1II=com.oui.absolute.AbsoluteDesign;return I11l1111l1&&(I111ll11Il.indexOf("controls[*]")>=0?l1III111ll&&l1III111ll.currentControl&&l1III111ll.controls.indexOf(l1III111ll.currentControl)>-1?(l1II1I1Ill=I111ll11Il.replace("controls[*].",""),I1I1I111II=I11l1111l1.check(oui.JsonPathUtil.getJsonByPath(l1II1I1Ill,l1III111ll.currentControl))):l1III111ll&&!oui.isEmptyObject(l1III111ll.currentControl)&&"draggingField"!=l1III1I1II.state&&(l1II1I1Ill=I111ll11Il.replace("controls[*].",""),I1I1I111II=I11l1111l1.check(oui.JsonPathUtil.getJsonByPath(l1II1I1Ill,l1III111ll.currentControl))):I1I1I111II=I11l1111l1.check(oui.JsonPathUtil.getJsonByPath(l1II1I1Ill,l1III111ll))),I1I1I111II&&I1I1I111II.length?I1I1I111II[0].msg||"":""}};I1III111lI.addConfig("name",{require:!0,require_error_msg:"表单标题必填",maxLength_error_msg:"表单标题字符数不能大于{{validateValue}}",maxLength:40}),I1III111lI.addConfig("description",{maxLength_error_msg:"表单描述字符数不能大于{{validateValue}}",maxLength:500}),I1III111lI.addConfig("style.bgImgName",{maxLength_error_msg:"表单背景图名称符数不能大于{{validateValue}}",maxLength:30}),I1III111lI.addConfig("style.bgImg",{}),I1III111lI.addConfig("style.bgImgFillType",{require:!0,require_error_msg:"表单背景图填充类型不能为空",maxLength_error_msg:"表单背景图填充类型字符数不能大于{{validateValue}}",maxLength:10}),I1III111lI.addConfig("style.backgroundColor",{maxLength_error_msg:"表单背景颜色字符数不能大于{{validateValue}}",maxLength:10}),I1III111lI.addConfig("style.width",{title:"表单宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:2e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:10}),I1III111lI.addConfig("style.height",{title:"表单高度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:2e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:10}),I1III111lI.addConfig("style.paperType",{title:"表单尺寸类型",require:!0,maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:10}),I1III111lI.addConfig("style.cellType",{title:"表单尺寸单位类型",require:!0,maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:5}),I1III111lI.addConfig("innerStyle.styleTitle",{}),I1III111lI.addConfig("innerStyle.styleFieldOuter",{}),I1III111lI.addConfig("innerStyle.styleField",{}),I1III111lI.addConfig("controls[*].id",{title:"控件Id",require:!0,maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:30}),I1III111lI.addConfig("controls[*].name",{title:"控件名称",maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:30}),I1III111lI.addConfig("controls[*].title",{title:"控件标题",maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:50}),I1III111lI.addConfig("controls[*].description",{title:"控件描述",maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:100}),I1III111lI.addConfig("controls[*].htmlType",{title:"控件类型",maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:20}),I1III111lI.addConfig("controls[*].controlType",{title:"控件业务类型",maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:30}),I1III111lI.addConfig("controls[*].fieldType",{title:"控件字段类型",maxLength_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxLength:20}),I1III111lI.addConfig("controls[*].showType",{title:"控件显示类型",require:!0,maxValue_error_msg:"{{title}}值不能大于{{validateValue}}",maxValue:20}),I1III111lI.addConfig("controls[*].formField",{title:"是否是表单字段",maxValue_error_msg:"{{title}}字符数不能大于{{validateValue}}",maxValue:10}),I1III111lI.addConfig("controls[*].style.left",{title:"控件距左",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:2e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:-2e4}),I1III111lI.addConfig("controls[*].style.top",{title:"控件距上",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:2e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:-2e4}),I1III111lI.addConfig("controls[*].style.width",{title:"控件宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:2e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:30}),I1III111lI.addConfig("controls[*].style.height",{title:"控件高度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:2e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:30}),I1III111lI.addConfig("controls[*].style.borderRadius,innerStyle.style.borderRadius",{title:"控件圆角设置",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:1e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].style.borderLeftWidth,innerStyle.style.borderLeftWidth",{title:"控件左边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].style.borderTopWidth,innerStyle.style.borderTopWidth",{title:"控件上边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].style.borderRightWidth,innerStyle.style.borderRightWidth",{title:"控件右边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].style.borderBottomWidth,innerStyle.style.borderRightWidth",{title:"控件下边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].style.borderLeftColor",{title:"控件左边框颜色",maxLength_error_msg:"边框颜色字符数不能大于{{validateValue}}",maxLength:10}),I1III111lI.addConfig("controls[*].style.borderTopColor",{title:"控件上边框颜色",maxLength_error_msg:"边框颜色字符数不能大于{{validateValue}}",maxLength:10}),I1III111lI.addConfig("controls[*].style.borderRightColor",{title:"控件右边框颜色",maxLength_error_msg:"边框颜色字符数不能大于{{validateValue}}",maxLength:10}),I1III111lI.addConfig("controls[*].style.borderBottomColor",{title:"控件下边框颜色",maxLength_error_msg:"边框颜色字符数不能大于{{validateValue}}",maxLength:10}),I1III111lI.addConfig("controls[*].innerStyle.styleFieldOuter",{}),I1III111lI.addConfig("controls[*].innerStyle.styleField",{}),I1III111lI.addConfig("controls[*].innerStyle.styleField.borderRadius,innerStyle.styleField.borderRadius",{title:"控件值圆角设置",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:1e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].innerStyle.styleTitle.fontSize,innerStyle.styleTitle.fontSize",{title:"标题字体大小",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:99,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:12}),I1III111lI.addConfig("controls[*].innerStyle.styleField.fontSize,innerStyle.styleField.fontSize",{title:"控件值字体大小",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:99,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:12}),I1III111lI.addConfig("controls[*].innerStyle.styleField.borderLeftWidth,innerStyle.styleField.borderLeftWidth",{title:"控件左边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].innerStyle.styleField.borderTopWidth,innerStyle.styleField.borderTopWidth",{title:"控件上边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].innerStyle.styleField.borderRightWidth,innerStyle.styleField.borderRightWidth",{title:"控件右边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].innerStyle.styleField.borderBottomWidth,innerStyle.styleField.borderBottomWidth",{title:"控件下边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("controls[*].otherAttrs",{}),I1III111lI.addConfig("otherAttrs",{}),I1III111lI.addConfig("innerStyle.style.borderRadius",{title:"控件圆角设置",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:1e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("innerStyle.styleField.borderRadius",{title:"控件值圆角设置",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:1e4,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:0}),I1III111lI.addConfig("tempControl.style._borderWidth",{title:"控件边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:1}),I1III111lI.addConfig("tempControl.innerStyle.styleField._borderWidth",{title:"控件值边框宽度",maxValue_error_msg:"{{title}}不能大于{{validateValue}}",maxValue:20,minValue_error_msg:"{{title}}不能小于{{validateValue}}",minValue:1}),com.oui.absolute.AbsoluteDesign.Validator=I1III111lI}(window),com.oui.absolute.AbsoluteDesign.defaultControls4Normal=[{htmlType:"read",controlType:"label",showType:0,formField:!1,name:"插入文本",description:"插入文本",fieldType:"string",innerStyle:{styleTitle:{textAlign:"center"}},style:{width:110,height:60,layoutType:"onlyTitle"}},{htmlType:"containerBox",controlType:"containerBox",showType:0,formField:!1,name:"插入容器盒子",description:"插入容器盒子",fieldType:"string",style:{width:110,height:600,borderLeftWidth:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,lineHeight:1,columnSize:1,rowSize:0,columnLines:com.oui.absolute.AbsoluteDesign.createTableColumnLines({style:{width:110,height:600,lineHeight:1,lineColor:"#e6e6e6",columnSize:1,rowSize:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopWidth:0}})}},{htmlType:"button",controlType:"button",showType:0,formField:!1,name:"按钮",description:"按钮",innerStyle:{styleFieldOuter:{textAlign:"center"}},style:{width:110,height:60,layoutType:"hideTitle"}},{htmlType:"page",controlType:"page",showType:0,formField:!1,name:"页面占位",description:"页面占位",innerStyle:{styleFieldOuter:{textAlign:"center"}},otherAttrs:{isShowBorder:!0},style:{width:110,height:60,layoutType:"hideTitle"}},{htmlType:"read",controlType:"image",showType:0,formField:!1,name:"查看图片",fieldType:"string",style:{width:300,height:300,layoutType:"hideTitle"}},{htmlType:"read",controlType:"qrcode",showType:0,formField:!1,name:"二维码",fieldType:"string",style:{width:300,height:300,layoutType:"hideTitle"}},{htmlType:"read",controlType:"barcode",showType:0,formField:!1,name:"条形码",fieldType:"string",style:{width:110,height:150,layoutType:"hideTitle"}},{htmlType:"container",controlType:"tabs",showType:1,formField:!1,name:"多页签",style:{width:110,height:210,layoutType:"hideTitle"},innerStyle:{styleInnerOuter:{verticalAlign:"top"}},otherAttrs:{data:[{id:oui.getUUIDLong(),value:oui.getUUIDLong(),display:"页签0",contentType:"none",pageId:"",url:"",content:""},{id:oui.getUUIDLong(),value:oui.getUUIDLong(),contentType:"none",display:"页签1",pageId:"",url:"",content:""}]}},{htmlType:"customTable",controlType:"table",showType:0,formField:!1,name:"自定义列表",style:{width:110,height:210,layoutType:"hideTitle"},innerStyle:{styleInnerOuter:{verticalAlign:"top"}},otherAttrs:{data:[]}},{htmlType:"tableLine",controlType:"tableLine",showType:0,formField:!1,name:"插入表格",fieldType:"string",style:{width:110,height:600,borderLeftWidth:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,lineHeight:1,columnSize:4,rowSize:3,columnLines:com.oui.absolute.AbsoluteDesign.createTableColumnLines({style:{width:110,height:600,lineHeight:1,lineColor:"#e6e6e6",columnSize:4,rowSize:3,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopWidth:0}}),rowLines:com.oui.absolute.AbsoluteDesign.createTableRowLines({style:{width:110,height:600,lineHeight:1,lineColor:"#e6e6e6",columnSize:4,rowSize:3,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopWidth:0}})}},{htmlType:"tableLine",controlType:"detail",showType:0,formField:!1,name:"插入表格",fieldType:"string",otherAttrs:{buttons:[{round:!1,plain:!0,display:"添加",buttonShowType:"default",disabled:!1,id:oui.getUUIDLong(),circle:!1,buttonLayout:"leftIcon",value:oui.getUUIDLong(),contentType:"page",events:{click:{params:[],startCode:"",bodyCode:"var detail = this.getDetail();//获取明细表\n//var pageData= detail.getPageData();//页面对象\ndetail.event2add(); //默认添加方法,当然这里可以自定义添加事件\n",endCode:"",returnType:"string"}}},{plain:!0,display:"删除",buttonShowType:"danger",disabled:!1,id:oui.getUUIDLong(),buttonLayout:"onlyText",value:oui.getUUIDLong(),contentType:"page",buttonSize:"medium",events:{click:{params:[],startCode:"",bodyCode:"var detail = this.getDetail(); //获取明细表对象\n//var pageData = detail.getPageData();//获取页面对象\ndetail.event2remove();//默认的删除事件，当然这里可以自定义扩展删除行逻辑\n",endCode:"",returnType:"string"}}}],rowButtons:[{plain:!0,display:"编辑",buttonShowType:"default",id:oui.getUUIDLong(),buttonLayout:"onlyText",value:oui.getUUIDLong(),contentType:"page",events:{click:{params:[],startCode:"",bodyCode:"var detail = this.getDetail();//获取当前明细表\n//var pageData = detail.getPageData();//页面对象\n//var mainData = pageData.mainData;//主表数据\nvar rowIndex = this.rowIndex; //当前编辑行\ndetail.event2editRow(rowIndex);//编辑行",endCode:"",returnType:"string"}},round:!1,buttonSize:"small"}],editingButtons:[{plain:!0,display:"确定",buttonShowType:"default",id:oui.getUUIDLong(),buttonLayout:"onlyText",value:oui.getUUIDLong(),contentType:"page",events:{click:{params:[],startCode:"",bodyCode:"var detail = this.getDetail();//获取当前明细表\n//var pageData = detail.getPageData();//页面对象\n//var mainData = pageData.mainData;//主表数据\nvar rowIndex = this.rowIndex; //当前编辑行\ndetail.event2saveRow(rowIndex);//保存行",endCode:"",returnType:"string"}},round:!1,buttonSize:"small"}]},style:{width:600,height:120,borderLeftWidth:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,lineHeight:1,columnSize:3,rowSize:2,columnLines:com.oui.absolute.AbsoluteDesign.createTableColumnLines({style:{width:600,height:120,lineHeight:1,lineColor:"#e6e6e6",columnSize:3,rowSize:2,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopWidth:0}}),rowLines:com.oui.absolute.AbsoluteDesign.createTableRowLines({style:{width:600,height:120,lineHeight:1,lineColor:"#e6e6e6",columnSize:3,rowSize:2,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopWidth:0}})}}],com.oui.absolute.AbsoluteDesign.defaultControls=[{htmlType:"button",controlType:"button",showType:0,formField:!1,name:"按钮"},{htmlType:"tableLine",controlType:"tableLine",showType:0,formField:!1,name:"插入格子"},{htmlType:"tableLine",controlType:"detail",showType:0,formField:!1,name:"插入数据格子"},{htmlType:"customTable",controlType:"table",showType:0,formField:!1,name:"自定义列表"},{htmlType:"container",controlType:"tabs",showType:0,formField:!1,name:"多页签"},{htmlType:"textInput",controlType:"textfield",showType:0,formField:!0,name:"单行输入框",fieldType:"string",style:{width:110,height:60}},{htmlType:"textInput",controlType:"textarea",showType:0,formField:!0,name:"多行输入框",fieldType:"string",style:{width:110,height:80}},{htmlType:"textInput",controlType:"number",showType:0,formField:!0,name:"数字输入框",fieldType:"number",style:{width:110,height:60}},{htmlType:"textInput",controlType:"cellphone",showType:0,formField:!0,name:"手机",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"condition",showType:3,name:"条件组件",formField:!1,style:{width:110,height:210,layoutType:"hideTitle"},innerStyle:{styleInnerOuter:{verticalAlign:"top"}},otherAttrs:{fields:[],conditions:[]}},{htmlType:"selectInput",controlType:"singleselect",showType:0,formField:!0,name:"下拉框",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"datepicker",showType:0,formField:!0,name:"日期",fieldType:"date",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"datetime",showType:0,formField:!0,name:"日期时间",fieldType:"datetime",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"timepicker",formField:!0,showType:0,name:"时间",fieldType:"time",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"uploadimage",showType:0,formField:!0,name:"上传图片",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"attachment",showType:0,formField:!0,name:"附件",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"address",showType:0,formField:!0,name:"省市区",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"outercontrol",showType:0,formField:!0,name:"外部控件",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"lbs",showType:0,formField:!0,name:"地理位置",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"selectperson",showType:0,formField:!0,name:"选人",fieldType:"string",style:{width:110,height:60}},{htmlType:"selectInput",controlType:"selectdept",showType:0,formField:!0,name:"选部门",fieldType:"string",style:{width:110,height:60}},{htmlType:"repeatSelect",controlType:"radio",showType:0,formField:!0,name:"单选",fieldType:"string",style:{width:110,height:60}},{htmlType:"repeatSelect",controlType:"multiselect",showType:0,formField:!0,name:"多选",fieldType:"string",style:{width:110,height:60}},{htmlType:"repeatSelect",controlType:"switch",showType:0,formField:!0,name:"开关",fieldType:"boolean",style:{width:110,height:60}},{htmlType:"repeatSelect",controlType:"score",showType:0,formField:!0,name:"评分",fieldType:"string",style:{width:110,height:60}},{htmlType:"repeatSelect",controlType:"imagesingle",showType:0,formField:!0,name:"图片单选",fieldType:"string",style:{width:110,height:60}},{htmlType:"repeatSelect",controlType:"imagemulti",showType:0,formField:!0,name:"图片多选",fieldType:"string",style:{width:110,height:60}},{htmlType:"read",controlType:"image",showType:0,formField:!1,name:"查看图片"},{htmlType:"read",controlType:"text",showType:0,formField:!1,name:"文本",innerStyle:{styleField:{fontFamily:"Microsoft YaHei",fontSize:14}}},{htmlType:"read",controlType:"qrcode",showType:0,formField:!1,name:"二维码"},{htmlType:"read",controlType:"barcode",showType:0,formField:!1,name:"条形码"},{htmlType:"read",controlType:"hidden",showType:0,formField:!0,name:"隐藏框",fieldType:"string",style:{width:110,height:60}},{htmlType:"read",controlType:"seperateline",showType:0,formField:!1,name:"分割线",style:{width:110,height:60}},{htmlType:"read",controlType:"label",showType:0,formField:!1,name:"文字说明",style:{width:110,height:60}},{htmlType:"read",controlType:"imagegroup",showType:0,formField:!1,name:"图片组",style:{width:400,height:300}},{htmlType:"read",controlType:"serialnumber",showType:0,formField:!0,name:"流水号",fieldType:"string",style:{width:110,height:60}},{htmlType:"other",controlType:"textbutton",showType:0,formField:!1,name:"文本按钮",fieldType:"string",style:{width:110,height:60}}];